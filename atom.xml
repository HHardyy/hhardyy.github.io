<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>小方块 - hhardyy.com</title>
  
  <subtitle>复杂的坑+归其原理+了解实现规则===解决？解决成功：加油解决成功;</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2020-01-30T12:54:01.954Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>BingZhenhuang</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>实时更新：新型肺炎疫情最新动态</title>
    <link href="http://yoursite.com/2020/01/30/%E5%AE%9E%E6%97%B6%E6%9B%B4%E6%96%B0%EF%BC%9A%E6%96%B0%E5%9E%8B%E8%82%BA%E7%82%8E%E7%96%AB%E6%83%85%E6%9C%80%E6%96%B0%E5%8A%A8%E6%80%81/"/>
    <id>http://yoursite.com/2020/01/30/实时更新：新型肺炎疫情最新动态/</id>
    <published>2020-01-30T12:13:02.000Z</published>
    <updated>2020-01-30T12:54:01.954Z</updated>
    
    <content type="html"><![CDATA[<p>疫情严峻，请您尽量不要聚会，避免出入公共场所<br><a id="more"></a></p><iframe width="100%" height="650px" overflow:hidden="" frameborder="no" border="0" marginwidth="0" marginheight="0" allowtransparency="true" src="https://news.qq.com/zt2020/page/feiyan.htm"></iframe><p><a href="https://news.qq.com/zt2020/page/feiyan.htm" target="_blank" rel="external">实时地址：https://news.qq.com/zt2020/page/feiyan.htm</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;疫情严峻，请您尽量不要聚会，避免出入公共场所&lt;br&gt;
    
    </summary>
    
    
      <category term="新型肺炎疫情最新动态" scheme="http://yoursite.com/tags/%E6%96%B0%E5%9E%8B%E8%82%BA%E7%82%8E%E7%96%AB%E6%83%85%E6%9C%80%E6%96%B0%E5%8A%A8%E6%80%81/"/>
    
  </entry>
  
  <entry>
    <title>Stimulsoft in web</title>
    <link href="http://yoursite.com/2020/01/08/%E5%B8%A6%E4%BD%A0%E5%85%A5%E9%97%A8Stimulsoft%E6%8A%A5%E8%A1%A8/"/>
    <id>http://yoursite.com/2020/01/08/带你入门Stimulsoft报表/</id>
    <published>2020-01-07T16:11:47.000Z</published>
    <updated>2020-01-22T06:40:02.414Z</updated>
    
    <content type="html"><![CDATA[<p>我们在开发一些web应用或者后台管理系统的时候，可能会遇到做报表的需求，同时支持在线设计。</p><p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=426341675&auto=0&height=66"></iframe><br><a id="more"></a></p><blockquote><p>Stimulsoft是什么？         为您的应用程序添加高性能报表和分析功能！（Stimulsoft的官网是这么介绍的）</p></blockquote><p>直接上手，我这里是用cli create了一个绿色纯天然无污染的vue demo，当然h5,react,ng以及…所有web应用中的用法应该都是大同小异</p><h3 id="加载资源"><a href="#加载资源" class="headerlink" title="加载资源"></a>加载资源</h3><p>通常来说，我们在web中使用外部资源，或者第三方工具库的时候都要先加载资源，所以先把Stimulsoft需要的资源先引入(这几个类库资源还是比较大，为了避免加载时间可以选择cdn加速，或者按需，或者你希望的姿势进行加载，只要顺序在使用里面对象属性之前即可)<br>这里是直接在public目录下新建的2个资源文件夹<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/stimulsoft/1.png" alt="资源结构" title="">                </div>                <div class="image-caption">资源结构</div>            </figure><br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- css资源 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"./reportcss/stimulsoft.designer.office2013.whiteblue.css"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"./reportcss/stimulsoft.viewer.office2013.whiteblue.css"</span>/&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- js资源 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./reportjs/stimulsoft.reports.pack.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./reportjs/stimulsoft.reports.maps.pack.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./reportjs/stimulsoft.viewer.pack.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./reportjs/stimulsoft.designer.pack.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p><h3 id="基础配置"><a href="#基础配置" class="headerlink" title="基础配置"></a>基础配置</h3><p>设置key，如果拿到授权之后就可以有key，有了key使用报表就没有默认水印<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Stimulsoft.Base.StiLicense.key = <span class="string">'获取授权的key'</span></div></pre></td></tr></table></figure></p><p>设置报表的语言，语言包在<a href="">这个demo的public文件夹下的localization</a><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Stimulsoft.Base.Localization.StiLocalization.setLocalizationFile(<span class="string">'./localization/zh-CHS.xml'</span>, <span class="literal">true</span>)</div></pre></td></tr></table></figure></p><h3 id="viewer配置"><a href="#viewer配置" class="headerlink" title="viewer配置"></a>viewer配置</h3><p>页面上写一个容器，也就是报表的容器,创建完容器之后再写下面的js<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"viewer"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p><p>实例化报表的可选项，比如工具栏toobar，工具栏上需要有什么，比如我需要显示设计按钮，可以在这个页面点开设计页<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">//实例化报表的可选项</span></div><div class="line"> <span class="keyword">const</span> options = <span class="keyword">new</span> Stimulsoft.Viewer.StiViewerOptions()</div><div class="line"> <span class="comment">//显示设计按钮，设置false或者不写则隐藏</span></div><div class="line"> options.toolbar.showDesignButton = <span class="literal">true</span></div><div class="line"></div><div class="line"> <span class="comment">//demo里面的options配置</span></div><div class="line">options.appearance.scrollbarsMode = <span class="literal">false</span></div><div class="line">options.toolbar.showDesignButton = <span class="literal">true</span></div><div class="line">options.toolbar.printDestination = Stimulsoft.Viewer.StiPrintDestination.Direct</div><div class="line">options.appearance.htmlRenderMode = Stimulsoft.Report.Export.StiHtmlExportMode.Table</div></pre></td></tr></table></figure></p><p><a href="https://admin.stimulsoft.com/documentation/classreference-js/classes/stimulsoft.viewer.stivieweroptions.html" target="_blank" rel="external">关于options的配置说明在这里，根据需要配就好了</a></p><h4 id="使用报表模板"><a href="#使用报表模板" class="headerlink" title="使用报表模板"></a>使用报表模板</h4><blockquote><p>就是打开这个页面的时候，如果想加载已经有的报表模板，直接可以加载进来，因为同样的报表模板可以应用在不同的场景;</p></blockquote><p>实例化一个预览对象viewer，将上面创建的可选项对象options传入预览的报表,然后实例化一个空报表对象，用这个空报表对象去加载引入的报表模板（报表模板实际是一个可以序列化的json对象，但是默认是.mrt文件。所以可以选择loadFile,也可以load，具体取决于你自己的保存格式，后面会介绍如何生成这个模板json，可以直接发给后端帮你保存，我是把它裁剪成json代码段然后保存成一个json文件，每个json文件对应一个模板）<a href="https://admin.stimulsoft.com/documentation/classreference-js/classes/stimulsoft.report.stireport.html" target="_blank" rel="external">说明可以看这里</a><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> viewer = <span class="keyword">new</span> Stimulsoft.Viewer.StiViewer(options, <span class="string">'StiViewer'</span>, <span class="literal">false</span>)</div><div class="line"><span class="keyword">let</span> report = <span class="keyword">new</span> Stimulsoft.Report.StiReport()</div><div class="line">report.load(<span class="string">'json格式的代码'</span>)    <span class="comment">//举例这段json直接从后端接口返回，直接给这里赋值即可</span></div></pre></td></tr></table></figure></p><h4 id="加载数据源"><a href="#加载数据源" class="headerlink" title="加载数据源"></a>加载数据源</h4><blockquote><p>加载数据源的目的是为了在设计报表的时候可以通过赋值的数据源拖拽设计想要的报表格式,如果数据源不同，模板上的动态数据将展示不出来;</p></blockquote><p>实例化一个数据源，然后往里面传入数据，数据结构可以根据需要自定义,<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> data = &#123;</div><div class="line">name:<span class="string">'小方块'</span>,</div><div class="line">age:<span class="number">18</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> strDataSorce = <span class="built_in">JSON</span>.stringify(data)</div><div class="line"><span class="keyword">let</span> dataSet = <span class="keyword">new</span> Stimulsoft.System.Data.DataSet(<span class="string">'hardy'</span>)    <span class="comment">//数据源名称</span></div><div class="line">dataSet.readJson(strDataSorce)</div></pre></td></tr></table></figure></p><blockquote><p>注册数据源</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">report.regData(<span class="string">'hardy'</span>, <span class="string">'hardy'</span>, dataSet)</div></pre></td></tr></table></figure><blockquote><p>刷新数据源字典</p></blockquote><p>刷新之后才能在数据源的菜单看到新数据<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">report.dictionary.synchronize()  </div><div class="line"><span class="string">`</span></div></pre></td></tr></table></figure></p><blockquote><p>创建完毕之后把它渲染到一个dom就好了</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">viewer.report = report</div><div class="line">viewer.renderHtml(<span class="string">'viewer'</span>)</div></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/stimulsoft/viewer.png" alt="运行效果" title="">                </div>                <div class="image-caption">运行效果</div>            </figure><p>viewer上面有很多toobar相对应的事件处理函数，具体<a href="https://admin.stimulsoft.com/documentation/classreference-js/classes/stimulsoft.viewer.stiviewer.html" target="_blank" rel="external">可以看这里</a>，然后找到自己需要的。<br>刚才在上面开启了设计按钮，那么点击设计按钮的时候会触发viewer上面的onDesignReport方法，如果不需要直接开启设计功能则把options.toolbar.showDesignButton = true去掉或者改成=false，如果需要这个功能就再创建一个容器用来渲染设计功能的界面。就像这样<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 进入设计面板</span></div><div class="line">viewer.onDesignReport = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</div><div class="line"><span class="keyword">if</span> (designer == <span class="literal">null</span>) &#123;                 <span class="comment">//这里可以声明一个设计和预览两个方法都能访问到的desight初始化null值，避免对象重复实例化</span></div><div class="line">    _createDesightModel(e.report)       <span class="comment">//_createDesightModel和单独做设计功能一样，只是渲染的容器改成相对应的容器就好了        </span></div><div class="line">&#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><h3 id="desight配置"><a href="#desight配置" class="headerlink" title="desight配置"></a>desight配置</h3><p>创建一个容器<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"desight"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure></p><h4 id="实例化一个报表对象"><a href="#实例化一个报表对象" class="headerlink" title="实例化一个报表对象"></a>实例化一个报表对象</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> report = <span class="keyword">new</span> Stimulsoft.Report.StiReport()</div></pre></td></tr></table></figure><h4 id="加载模板"><a href="#加载模板" class="headerlink" title="加载模板"></a>加载模板</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">report.load(<span class="string">'你的jsonfile模板'</span>)</div></pre></td></tr></table></figure><h4 id="加载数据源-为了在设计的时候可以拖拽数据源到相应的比如二维码，条码，产品码等或者组合成快递面单上面，直接设计成一个模板，供多处使用"><a href="#加载数据源-为了在设计的时候可以拖拽数据源到相应的比如二维码，条码，产品码等或者组合成快递面单上面，直接设计成一个模板，供多处使用" class="headerlink" title="加载数据源,为了在设计的时候可以拖拽数据源到相应的比如二维码，条码，产品码等或者组合成快递面单上面，直接设计成一个模板，供多处使用"></a>加载数据源,为了在设计的时候可以拖拽数据源到相应的比如二维码，条码，产品码等或者组合成快递面单上面，直接设计成一个模板，供多处使用</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> data = &#123;</div><div class="line">name:<span class="string">'小方块'</span>,</div><div class="line">age:<span class="number">18</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> strDataSorce = <span class="built_in">JSON</span>.stringify(data)                      <span class="comment">//实例化一个数据源</span></div><div class="line"><span class="keyword">var</span> dataSet = <span class="keyword">new</span> Stimulsoft.System.Data.DataSet(<span class="string">'hardy'</span>)    <span class="comment">//设置数据源</span></div><div class="line">dataSet.readJson(strDataSorce)                               <span class="comment">//给数据源赋值</span></div><div class="line">report.regData(<span class="string">'hardy'</span>, <span class="string">'hardy'</span>, dataSet)                    <span class="comment">//注册数据源</span></div><div class="line">report.dictionary.synchronize()                              <span class="comment">//更新字典</span></div></pre></td></tr></table></figure><h4 id="设计模板相关配置"><a href="#设计模板相关配置" class="headerlink" title="设计模板相关配置"></a>设计模板相关配置</h4><p>实例化可选项，关于设计模板的可选项可以在<a href="https://admin.stimulsoft.com/documentation/classreference-js/classes/stimulsoft.designer.stidesigneroptions.html" target="_blank" rel="external">这里查看</a><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> options = <span class="keyword">new</span> Stimulsoft.Designer.StiDesignerOptions()</div><div class="line"></div><div class="line"><span class="comment">//我的demo中配置</span></div><div class="line">options.appearance.fullScreenMode = <span class="literal">true</span>      <span class="comment">//是否全屏</span></div><div class="line">options.toolbar.showFileMenuExit = <span class="literal">true</span>       <span class="comment">//显示文件菜单的退出</span></div><div class="line">options.toolbar.showFileMenuClose = <span class="literal">false</span>     <span class="comment">//不显示关闭按钮</span></div><div class="line">options.toolbar.showFileMenuSaveAs = <span class="literal">true</span>     <span class="comment">//文件菜单显示另存为</span></div></pre></td></tr></table></figure></p><p>实例化一个设计模版对象，将配置的可选项传入<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> designer = <span class="keyword">new</span> Stimulsoft.Designer.StiDesigner(options, <span class="string">'StiDesigner'</span>, <span class="literal">false</span>)</div></pre></td></tr></table></figure></p><h4 id="保存和另存为"><a href="#保存和另存为" class="headerlink" title="保存和另存为"></a>保存和另存为</h4><blockquote><p>设计和预览不同，设计之后你可能需要保存，或者另存为新的文件 </p></blockquote><p>designer原型上自带了很多操作函数，具体可以<a href="https://admin.stimulsoft.com/documentation/classreference-js/classes/stimulsoft.designer.stidesigner.html" target="_blank" rel="external">查看这里</a>,通过designer直接调用即可，比如保存和另存为<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//保存     点文件菜单的保存触发</span></div><div class="line">designer.onSaveReport = <span class="function"><span class="keyword">function</span> (<span class="params">args</span>) </span>&#123;</div><div class="line">    <span class="keyword">let</span> jsonReport = args.report.saveToJsonString()     <span class="comment">//拿到当前设计的这个模板的jsonfile</span></div><div class="line">    <span class="comment">//拿到之后你可以自定义要怎么做,可以发送到后端去保存</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//另存为    点文件菜单的另存为触发,同时触发一个可以重命名文件进行下载的窗口</span></div><div class="line">designer.onSaveAsReport = <span class="function"><span class="keyword">function</span>(<span class="params">args</span>)</span>&#123;</div><div class="line"><span class="keyword">let</span> jsonReport = args.report.saveToJsonString()     <span class="comment">//拿到当前设计的这个模板的jsonfile</span></div><div class="line"><span class="comment">//和保存一样可以做喜欢做的事</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//退出       点文件菜单的退出触发</span></div><div class="line">designer.onExit = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">   <span class="comment">//做喜欢的事</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>渲染报表<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">designer.report = report</div><div class="line">designer.renderHtml(<span class="string">'desight'</span>)</div></pre></td></tr></table></figure></p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/stimulsoft/desight1.png" alt="运行效果1" title="">                </div>                <div class="image-caption">运行效果1</div>            </figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/stimulsoft/desight2.png" alt="运行效果2" title="">                </div>                <div class="image-caption">运行效果2</div>            </figure><p>如果要将jsonfile下载至本地的话，可以使用这样的downloadJjsonFile方法,downloadJjsonFile(要下载的代码片段，下载的文件命名，下载的文件类别),这个方法需要依赖一个a标签，写在页面上哪里都行，只是要使用它的download方法</p><blockquote><p>这里的type指的是Content-Type,根据这个可以规定下载的文件类型,例如下载json,type就是‘application/json’,<a href="https://www.runoob.com/http/http-content-type.html" target="_blank" rel="external">Content-Type对照表：</a></p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> downloadJjsonFile = <span class="function">(<span class="params">ctx,name,type</span>) =&gt;</span> &#123;</div><div class="line"><span class="keyword">let</span> _a = <span class="built_in">document</span>.querySelector(<span class="string">'#a'</span>);</div><div class="line"><span class="keyword">let</span> _file = <span class="keyword">new</span> Blob([ctx],&#123; type &#125;);</div><div class="line">_a.href = URL.createObjectURL(file);</div><div class="line">_a.download = name;</div><div class="line">_a.dispatchEvent(<span class="keyword">new</span> MouseEvent(<span class="string">'click'</span>, &#123;<span class="string">'bubbles'</span>: <span class="literal">false</span>, <span class="string">'cancelable'</span>: <span class="literal">true</span>&#125;));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/** html */</span></div><div class="line">&lt;a id=<span class="string">"a"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></div><div class="line"></div><div class="line"><span class="comment">/** 触发这个方法，传入参数就可以将代码片段下载成一个文件了 */</span></div><div class="line">&lt;button οnclick=<span class="string">"downloadJjsonFile('hwllo word', 'downloadJjsonFile.json', 'application/json')"</span>&gt;Test Download&lt;<span class="regexp">/button&gt;</span></div></pre></td></tr></table></figure><p><a href="https://github.com/HHardyy/Stimulsoft-in-web" target="_blank" rel="external">写这篇文章的时候简单写的demo：https://github.com/HHardyy/Stimulsoft-in-web</a></p><p>2020第一篇，最近比较忙，框架升级，轮子维护&amp;&amp;开发，最近在搞web异常监控，就是针对web做的代码监控，回头看看能不能写一个，2019年比较幸运，入职6个月试用期，然后1个月提前转正，然后感谢大家把优秀员工的名额给了我，然后19年学的东西全在码云的提交记录了，等有时间再整理一下，20年给自己定了新的flag，继续奔跑吧年轻人！！！睡是什么，我不知道！！！！。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;我们在开发一些web应用或者后台管理系统的时候，可能会遇到做报表的需求，同时支持在线设计。&lt;/p&gt;
&lt;p&gt;&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;//music.163.com/outchain/player?type=2&amp;id=426341675&amp;auto=0&amp;height=66&quot;&gt;&lt;/iframe&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="Stimulsoft" scheme="http://yoursite.com/tags/Stimulsoft/"/>
    
      <category term="office" scheme="http://yoursite.com/tags/office/"/>
    
      <category term="报表" scheme="http://yoursite.com/tags/%E6%8A%A5%E8%A1%A8/"/>
    
      <category term="web" scheme="http://yoursite.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>eslint规范代码</title>
    <link href="http://yoursite.com/2019/11/30/eslint%E8%A7%84%E8%8C%83%E4%BB%A3%E7%A0%81/"/>
    <id>http://yoursite.com/2019/11/30/eslint规范代码/</id>
    <published>2019-11-30T03:30:47.000Z</published>
    <updated>2020-01-13T15:17:38.295Z</updated>
    
    <content type="html"><![CDATA[<p>是该给选手们订一套代码规范套餐了。。。</p><p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1371939273&auto=0&height=66"></iframe><br><a id="more"></a></p><p>在团队开发中，每个人的想法不一样，代码规范就不一样，每个人自由发挥的后果就是这个项目越来越走向重构，后面接手的人甚至无从下手。我自己也比较喜欢业务与plugins分开，plugins里面必须0业务。。。。。。跑偏了。。</p><h3 id="局部安装-应用到当前项目"><a href="#局部安装-应用到当前项目" class="headerlink" title="局部安装(应用到当前项目)"></a>局部安装(应用到当前项目)</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install eslint --save-dev</div></pre></td></tr></table></figure><h3 id="全局安装（应用到所有项目）"><a href="#全局安装（应用到所有项目）" class="headerlink" title="全局安装（应用到所有项目）"></a>全局安装（应用到所有项目）</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g eslint</div></pre></td></tr></table></figure><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><p>使用 .eslintrc文件<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">eslint --init</div></pre></td></tr></table></figure></p><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>举例使用ele团队的规范<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install --save-dev eslint-config-elemefe eslint</div></pre></td></tr></table></figure></p><p>然后在.eslintrc中加上<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line"><span class="string">"extends"</span>: <span class="string">"elemefe"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p><a href="https://www.npmjs.com/package/eslint-config-elemefe" target="_blank" rel="external">饿了么团队的eslint规范</a></p><h3 id="IDE-配置"><a href="#IDE-配置" class="headerlink" title="IDE 配置"></a>IDE 配置</h3><p>使用facebook的都在用的默认编辑器vscode，然后安装ESLint插件（在商店搜索安装即可），也可以装上根据eslint自动格式化的插件vetur，prettier等，然后在settings.json用户配置中自由设置（下面是我自己的）<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"vetur.format.defaultFormatter.js"</span>: <span class="string">"prettier-eslint"</span>,</div><div class="line">  <span class="string">"vetur.format.defaultFormatter.html"</span>: <span class="string">"js-beautify-html"</span>,</div><div class="line">  <span class="string">"vetur.format.defaultFormatterOptions"</span>: &#123;</div><div class="line">    <span class="string">"wrap_attributes"</span>: <span class="string">"force-aligned"</span></div><div class="line">  &#125;,</div><div class="line">  <span class="string">"editor.detectIndentation"</span>: <span class="literal">true</span>,   <span class="comment">// vscode默认启用了根据文件类型自动设置tabsize的选项</span></div><div class="line">  <span class="string">"editor.tabSize"</span>: <span class="number">2</span>,  <span class="comment">// 重新设定tabsize</span></div><div class="line">  <span class="comment">// "editor.formatOnSave": true,  // 保存时自动格式化 --vscode编辑器自带自动格式化会与设置的eslint规范有所冲突导致eslint报错</span></div><div class="line">  <span class="string">"eslint.autoFixOnSave"</span>: <span class="literal">true</span>, <span class="comment">//保存时使用eslint规范自动格式化</span></div><div class="line">  <span class="string">"workbench.iconTheme"</span>: <span class="string">"vscode-great-icons"</span>,</div><div class="line">  <span class="string">"eslint.enable"</span>: <span class="literal">true</span>,     <span class="comment">//true打开eslint语法检查，false关闭</span></div><div class="line">  <span class="string">"eslint.validate"</span>: [       <span class="comment">//eslint支持项自定义</span></div><div class="line">    <span class="string">"javascript"</span>,</div><div class="line">    <span class="string">"javascriptreact"</span>,</div><div class="line">    &#123;</div><div class="line">      <span class="string">"language"</span>: <span class="string">"html"</span>,</div><div class="line">      <span class="string">"autoFix"</span>: <span class="literal">true</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      <span class="string">"language"</span>: <span class="string">"vue"</span>,</div><div class="line">      <span class="string">"autoFix"</span>: <span class="literal">true</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      <span class="string">"language"</span>: <span class="string">"react"</span>,</div><div class="line">      <span class="string">"autoFix"</span>: <span class="literal">true</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">      <span class="string">"language"</span>: <span class="string">"webpack"</span>,</div><div class="line">      <span class="string">"autoFix"</span>: <span class="literal">true</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">       <span class="string">"language"</span>: <span class="string">"typescript"</span>,</div><div class="line">       <span class="string">"autoFix"</span>: <span class="literal">true</span></div><div class="line">    &#125;</div><div class="line">    ....</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>配好之后就能感受到写代码实时红线提示，当然再狠一点可以做一下git提交的验证，eslint检查不通过不允许提交,eslint的玩法有超多种，比较急一会要去接手一下一个离职选手的锅，先简单记录一下~，</p><h3 id="错误级别"><a href="#错误级别" class="headerlink" title="错误级别"></a>错误级别</h3><p>“off” or 0 - 关闭(禁用)规则<br>“warn” or 1 - 将规则视为一个警告（并不会导致检查不通过）<br>“error” or 2 - 将规则视为一个错误 (退出码为1，检查不通过) </p><h3 id="常用规则"><a href="#常用规则" class="headerlink" title="常用规则"></a>常用规则</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div></pre></td><td class="code"><pre><div class="line">Possible Errors 可能的错误或逻辑错误 </div><div class="line">no-cond-assign 禁止条件表达式中出现模棱两可的赋值操作符 </div><div class="line">no-<span class="built_in">console</span> 禁用<span class="built_in">console</span> </div><div class="line">no-constant-condition 禁止在条件中使用常量表达式 </div><div class="line">no-<span class="keyword">debugger</span> 禁用 <span class="keyword">debugger</span> </div><div class="line">no-dupe-args 禁止 <span class="function"><span class="keyword">function</span> 定义中出现重名参数 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">dupe</span>-<span class="title">keys</span> 禁止对象字面量中出现重复的 <span class="title">key</span> </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">duplicate</span>-<span class="title">case</span> 禁止出现重复的 <span class="title">case</span> 标签 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">empty</span> 禁止出现空语句块 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">ex</span>-<span class="title">assign</span> 禁止对 <span class="title">catch</span> 子句的参数重新赋值 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">extra</span>-<span class="title">boolean</span>-<span class="title">cast</span> 禁止不必要的布尔转换 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">extra</span>-<span class="title">parens</span> 禁止不必要的括号 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">extra</span>-<span class="title">semi</span> 禁止不必要的分号 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">func</span>-<span class="title">assign</span> 禁止对 <span class="title">function</span> 声明重新赋值 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">inner</span>-<span class="title">declarations</span> 禁止在嵌套的块中出现变量声明或 <span class="title">function</span> 声明 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">irregular</span>-<span class="title">whitespace</span> 禁止在字符串和注释之外不规则的空白 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">obj</span>-<span class="title">calls</span> 禁止把全局对象作为函数调用 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">sparse</span>-<span class="title">arrays</span> 禁用稀疏数组 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">prototype</span>-<span class="title">builtins</span> 禁止直接使用<span class="title">Object</span>.<span class="title">prototypes</span> 的内置属性 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">unexpected</span>-<span class="title">multiline</span> 禁止出现令人困惑的多行表达式 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">unreachable</span> 禁止在<span class="title">return</span>、<span class="title">throw</span>、<span class="title">continue</span> 和 <span class="title">break</span>语句之后出现不可达代码 </span></div><div class="line"><span class="function"><span class="title">use</span>-<span class="title">isnan</span> 要求使用 <span class="title">isNaN</span>(<span class="params"></span>) 检查 <span class="title">NaN</span> </span></div><div class="line"><span class="function"><span class="title">valid</span>-<span class="title">typeof</span> 强制 <span class="title">typeof</span> 表达式与有效的字符串进行比较 </span></div><div class="line"><span class="function">—– —– </span></div><div class="line"><span class="function"><span class="title">Best</span> <span class="title">Practices</span> 最佳实践 </span></div><div class="line"><span class="function"><span class="title">array</span>-<span class="title">callback</span>-<span class="title">return</span> 强制数组方法的回调函数中有 <span class="title">return</span> 语句 </span></div><div class="line"><span class="function"><span class="title">block</span>-<span class="title">scoped</span>-<span class="title">var</span> 强制把变量的使用限制在其定义的作用域范围内 </span></div><div class="line"><span class="function"><span class="title">complexity</span> 指定程序中允许的最大环路复杂度 </span></div><div class="line"><span class="function"><span class="title">consistent</span>-<span class="title">return</span> 要求 <span class="title">return</span> 语句要么总是指定返回的值，要么不指定 </span></div><div class="line"><span class="function"><span class="title">curly</span> 强制所有控制语句使用一致的括号风格 </span></div><div class="line"><span class="function"><span class="title">default</span>-<span class="title">case</span> 要求 <span class="title">switch</span> 语句中有 <span class="title">default</span> 分支 </span></div><div class="line"><span class="function"><span class="title">dot</span>-<span class="title">location</span> 强制在点号之前和之后一致的换行 </span></div><div class="line"><span class="function"><span class="title">dot</span>-<span class="title">notation</span> 强制在任何允许的时候使用点号 </span></div><div class="line"><span class="function"><span class="title">eqeqeq</span> 要求使用 === 和 !== </span></div><div class="line"><span class="function"><span class="title">guard</span>-<span class="title">for</span>-<span class="title">in</span> 要求 <span class="title">for</span>-<span class="title">in</span> 循环中有一个 <span class="title">if</span> 语句 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">alert</span> 禁用 <span class="title">alert</span>、<span class="title">confirm</span> 和 <span class="title">prompt</span> </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">case</span>-<span class="title">declarations</span> 不允许在 <span class="title">case</span> 子句中使用词法声明 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">else</span>-<span class="title">return</span> 禁止 <span class="title">if</span> 语句中有 <span class="title">return</span> 之后有 <span class="title">else</span> </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">empty</span>-<span class="title">function</span> 禁止出现空函数 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">eq</span>-<span class="title">null</span> 禁止在没有类型检查操作符的情况下与 <span class="title">null</span> 进行比较 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">eval</span> 禁用 <span class="title">eval</span>(<span class="params"></span>) </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">extra</span>-<span class="title">bind</span> 禁止不必要的 .<span class="title">bind</span>(<span class="params"></span>) 调用 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">fallthrough</span> 禁止 <span class="title">case</span> 语句落空 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">floating</span>-<span class="title">decimal</span> 禁止数字字面量中使用前导和末尾小数点 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">implicit</span>-<span class="title">coercion</span> 禁止使用短符号进行类型转换 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">implicit</span>-<span class="title">globals</span> 禁止在全局范围内使用 <span class="title">var</span> 和命名的 <span class="title">function</span> 声明 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">invalid</span>-<span class="title">this</span>: 禁止 <span class="title">this</span> 关键字出现在类和类对象之外 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">lone</span>-<span class="title">blocks</span> 禁用不必要的嵌套块 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">loop</span>-<span class="title">func</span> 禁止在循环中出现 <span class="title">function</span> 声明和表达式 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">magic</span>-<span class="title">numbers</span> 禁用魔术数字 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">multi</span>-<span class="title">spaces</span> 禁止使用多个空格 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">multi</span>-<span class="title">str</span> 禁止使用多行字符串 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">new</span> 禁止在非赋值或条件语句中使用 <span class="title">new</span> 操作符 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">new</span>-<span class="title">func</span> 禁止对 <span class="title">Function</span> 对象使用 <span class="title">new</span> 操作符 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">new</span>-<span class="title">wrappers</span> 禁止对 <span class="title">String</span>，<span class="title">Number</span> 和 <span class="title">Boolean</span> 使用 <span class="title">new</span> 操作符 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">param</span>-<span class="title">reassign</span> 不允许对 <span class="title">function</span> 的参数进行重新赋值 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">redeclare</span> 禁止使用 <span class="title">var</span> 多次声明同一变量 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">return</span>-<span class="title">assign</span> 禁止在 <span class="title">return</span> 语句中使用赋值语句 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">script</span>-<span class="title">url</span> 禁止使用 <span class="title">javascript</span>: <span class="title">url</span> </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">self</span>-<span class="title">assign</span> 禁止自我赋值 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">self</span>-<span class="title">compare</span> 禁止自身比较 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">sequences</span> 禁用逗号操作符 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">unmodified</span>-<span class="title">loop</span>-<span class="title">condition</span> 禁用一成不变的循环条件 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">unused</span>-<span class="title">expressions</span> 禁止出现未使用过的表达式 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">useless</span>-<span class="title">call</span> 禁止不必要的 .<span class="title">call</span>(<span class="params"></span>) 和 .<span class="title">apply</span>(<span class="params"></span>) </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">useless</span>-<span class="title">concat</span> 禁止不必要的字符串字面量或模板字面量的连接 </span></div><div class="line"><span class="function"><span class="title">vars</span>-<span class="title">on</span>-<span class="title">top</span> 要求所有的 <span class="title">var</span> 声明出现在它们所在的作用域顶部 </span></div><div class="line"><span class="function">—– —– </span></div><div class="line"><span class="function"><span class="title">Strict</span> <span class="title">Mode</span> 使用严格模式和严格模式指 </span></div><div class="line"><span class="function"><span class="title">strict</span> 要求或禁止使用严格模式指令 </span></div><div class="line"><span class="function">—– —– </span></div><div class="line"><span class="function"><span class="title">Variables</span> 变量声明 </span></div><div class="line"><span class="function"><span class="title">init</span>-<span class="title">declarations</span> 要求或禁止 <span class="title">var</span> 声明中的初始化 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">catch</span>-<span class="title">shadow</span> 不允许 <span class="title">catch</span> 子句的参数与外层作用域中的变量同名 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">restricted</span>-<span class="title">globals</span> 禁用特定的全局变量 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">shadow</span> 禁止 <span class="title">var</span> 声明 与外层作用域的变量同名 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">undef</span> 禁用未声明的变量，除非它们在 /<span class="title">global</span> / 注释中被提到 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">undef</span>-<span class="title">init</span> 禁止将变量初始化为 <span class="title">undefined</span> </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">unused</span>-<span class="title">vars</span> 禁止出现未使用过的变量 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">use</span>-<span class="title">before</span>-<span class="title">define</span> 不允许在变量定义之前使用它们 </span></div><div class="line"><span class="function">—– —– </span></div><div class="line"><span class="function"><span class="title">Nodejs</span> <span class="title">and</span> <span class="title">CommonJS</span> <span class="title">Node</span>.<span class="title">js</span>,<span class="title">CommonJS</span> </span></div><div class="line"><span class="function"><span class="title">global</span>-<span class="title">require</span> 要求 <span class="title">require</span>(<span class="params"></span>) 出现在顶层模块作用域中 </span></div><div class="line"><span class="function"><span class="title">handle</span>-<span class="title">callback</span>-<span class="title">err</span> 要求回调函数中有容错处理 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">mixed</span>-<span class="title">requires</span> 禁止混合常规 <span class="title">var</span> 声明和 <span class="title">require</span> 调用 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">new</span>-<span class="title">require</span> 禁止调用 <span class="title">require</span> 时使用 <span class="title">new</span> 操作符 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">path</span>-<span class="title">concat</span> 禁止对 <span class="title">dirname</span> 和 <span class="title">filename</span>进行字符串连接 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">restricted</span>-<span class="title">modules</span> 禁用指定的通过 <span class="title">require</span> 加载的模块 </span></div><div class="line"><span class="function">—– —– </span></div><div class="line"><span class="function"><span class="title">Stylistic</span> <span class="title">Issues</span> 风格指南 </span></div><div class="line"><span class="function"><span class="title">array</span>-<span class="title">bracket</span>-<span class="title">spacing</span> 强制数组方括号中使用一致的空格 </span></div><div class="line"><span class="function"><span class="title">block</span>-<span class="title">spacing</span> 强制在单行代码块中使用一致的空格 </span></div><div class="line"><span class="function"><span class="title">brace</span>-<span class="title">style</span> 强制在代码块中使用一致的大括号风格 </span></div><div class="line"><span class="function"><span class="title">camelcase</span> 强制使用骆驼拼写法命名约定 </span></div><div class="line"><span class="function"><span class="title">comma</span>-<span class="title">spacing</span> 强制在逗号前后使用一致的空格 </span></div><div class="line"><span class="function"><span class="title">comma</span>-<span class="title">style</span> 强制使用一致的逗号风格 </span></div><div class="line"><span class="function"><span class="title">computed</span>-<span class="title">property</span>-<span class="title">spacing</span> 强制在计算的属性的方括号中使用一致的空格 </span></div><div class="line"><span class="function"><span class="title">eol</span>-<span class="title">last</span> 强制文件末尾至少保留一行空行 </span></div><div class="line"><span class="function"><span class="title">func</span>-<span class="title">names</span> 强制使用命名的 <span class="title">function</span> 表达式 </span></div><div class="line"><span class="function"><span class="title">func</span>-<span class="title">style</span> 强制一致地使用函数声明或函数表达式 </span></div><div class="line"><span class="function"><span class="title">indent</span> 强制使用一致的缩进 </span></div><div class="line"><span class="function"><span class="title">jsx</span>-<span class="title">quotes</span> 强制在 <span class="title">JSX</span> 属性中一致地使用双引号或单引号 </span></div><div class="line"><span class="function"><span class="title">key</span>-<span class="title">spacing</span> 强制在对象字面量的属性中键和值之间使用一致的间距 </span></div><div class="line"><span class="function"><span class="title">keyword</span>-<span class="title">spacing</span> 强制在关键字前后使用一致的空格 </span></div><div class="line"><span class="function"><span class="title">linebreak</span>-<span class="title">style</span> 强制使用一致的换行风格 </span></div><div class="line"><span class="function"><span class="title">lines</span>-<span class="title">around</span>-<span class="title">comment</span> 要求在注释周围有空行 </span></div><div class="line"><span class="function"><span class="title">max</span>-<span class="title">depth</span> 强制可嵌套的块的最大深度 </span></div><div class="line"><span class="function"><span class="title">max</span>-<span class="title">len</span> 强制一行的最大长度 </span></div><div class="line"><span class="function"><span class="title">max</span>-<span class="title">lines</span> 强制最大行数 </span></div><div class="line"><span class="function"><span class="title">max</span>-<span class="title">nested</span>-<span class="title">callbacks</span> 强制回调函数最大嵌套深度 </span></div><div class="line"><span class="function"><span class="title">max</span>-<span class="title">params</span> 强制 <span class="title">function</span> 定义中最多允许的参数数量 </span></div><div class="line"><span class="function"><span class="title">max</span>-<span class="title">statements</span> 强制 <span class="title">function</span> 块最多允许的的语句数量 </span></div><div class="line"><span class="function"><span class="title">max</span>-<span class="title">statements</span>-<span class="title">per</span>-<span class="title">line</span> 强制每一行中所允许的最大语句数量 </span></div><div class="line"><span class="function"><span class="title">new</span>-<span class="title">cap</span> 要求构造函数首字母大写 </span></div><div class="line"><span class="function"><span class="title">new</span>-<span class="title">parens</span> 要求调用无参构造函数时有圆括号 </span></div><div class="line"><span class="function"><span class="title">newline</span>-<span class="title">after</span>-<span class="title">var</span> 要求或禁止 <span class="title">var</span> 声明语句后有一行空行 </span></div><div class="line"><span class="function"><span class="title">newline</span>-<span class="title">before</span>-<span class="title">return</span> 要求 <span class="title">return</span> 语句之前有一空行 </span></div><div class="line"><span class="function"><span class="title">newline</span>-<span class="title">per</span>-<span class="title">chained</span>-<span class="title">call</span> 要求方法链中每个调用都有一个换行符 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">array</span>-<span class="title">constructor</span> 禁止使用 <span class="title">Array</span> 构造函数 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">continue</span> 禁用 <span class="title">continue</span> 语句 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">inline</span>-<span class="title">comments</span> 禁止在代码行后使用内联注释 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">lonely</span>-<span class="title">if</span> 禁止 <span class="title">if</span> 作为唯一的语句出现在 <span class="title">else</span> 语句中 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">mixed</span>-<span class="title">spaces</span>-<span class="title">and</span>-<span class="title">tabs</span> 不允许空格和 <span class="title">tab</span> 混合缩进 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">multiple</span>-<span class="title">empty</span>-<span class="title">lines</span> 不允许多个空行 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">negated</span>-<span class="title">condition</span> 不允许否定的表达式 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">plusplus</span> 禁止使用一元操作符 ++ 和 – </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">spaced</span>-<span class="title">func</span> 禁止 <span class="title">function</span> 标识符和括号之间出现空格 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">ternary</span> 不允许使用三元操作符 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">trailing</span>-<span class="title">spaces</span> 禁用行尾空格 </span></div><div class="line"><span class="function"><span class="title">no</span>-<span class="title">whitespace</span>-<span class="title">before</span>-<span class="title">property</span> 禁止属性前有空白 </span></div><div class="line"><span class="function"><span class="title">object</span>-<span class="title">curly</span>-<span class="title">newline</span> 强制花括号内换行符的一致性 </span></div><div class="line"><span class="function"><span class="title">object</span>-<span class="title">curly</span>-<span class="title">spacing</span> 强制在花括号中使用一致的空格 </span></div><div class="line"><span class="function"><span class="title">object</span>-<span class="title">property</span>-<span class="title">newline</span> 强制将对象的属性放在不同的行上 </span></div><div class="line"><span class="function"><span class="title">one</span>-<span class="title">var</span> 强制函数中的变量要么一起声明要么分开声明 </span></div><div class="line"><span class="function"><span class="title">one</span>-<span class="title">var</span>-<span class="title">declaration</span>-<span class="title">per</span>-<span class="title">line</span> 要求或禁止在 <span class="title">var</span> 声明周围换行 </span></div><div class="line"><span class="function"><span class="title">operator</span>-<span class="title">assignment</span> 要求或禁止在可能的情况下要求使用简化的赋值操作符 </span></div><div class="line"><span class="function"><span class="title">operator</span>-<span class="title">linebreak</span> 强制操作符使用一致的换行符 </span></div><div class="line"><span class="function"><span class="title">quote</span>-<span class="title">props</span> 要求对象字面量属性名称用引号括起来 </span></div><div class="line"><span class="function"><span class="title">quotes</span> 强制使用一致的反勾号、双引号或单引号 </span></div><div class="line"><span class="function"><span class="title">require</span>-<span class="title">jsdoc</span> 要求使用 <span class="title">JSDoc</span> 注释 </span></div><div class="line"><span class="function"><span class="title">semi</span> 要求或禁止使用分号而不是 <span class="title">ASI</span> </span></div><div class="line"><span class="function"><span class="title">semi</span>-<span class="title">spacing</span> 强制分号之前和之后使用一致的空格 </span></div><div class="line"><span class="function"><span class="title">sort</span>-<span class="title">vars</span> 要求同一个声明块中的变量按顺序排列 </span></div><div class="line"><span class="function"><span class="title">space</span>-<span class="title">before</span>-<span class="title">blocks</span> 强制在块之前使用一致的空格 </span></div><div class="line"><span class="function"><span class="title">space</span>-<span class="title">before</span>-<span class="title">function</span>-<span class="title">paren</span> 强制在 <span class="title">function</span>的左括号之前使用一致的空格 </span></div><div class="line"><span class="function"><span class="title">space</span>-<span class="title">in</span>-<span class="title">parens</span> 强制在圆括号内使用一致的空格 </span></div><div class="line"><span class="function"><span class="title">space</span>-<span class="title">infix</span>-<span class="title">ops</span> 要求操作符周围有空格 </span></div><div class="line"><span class="function"><span class="title">space</span>-<span class="title">unary</span>-<span class="title">ops</span> 强制在一元操作符前后使用一致的空格 </span></div><div class="line"><span class="function"><span class="title">spaced</span>-<span class="title">comment</span> 强制在注释中 // 或 /* 使用一致的空格</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;是该给选手们订一套代码规范套餐了。。。&lt;/p&gt;
&lt;p&gt;&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;//music.163.com/outchain/player?type=2&amp;id=1371939273&amp;auto=0&amp;height=66&quot;&gt;&lt;/iframe&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="eslint" scheme="http://yoursite.com/tags/eslint/"/>
    
      <category term="代码规范" scheme="http://yoursite.com/tags/%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83/"/>
    
  </entry>
  
  <entry>
    <title>vue3基本玩法</title>
    <link href="http://yoursite.com/2019/11/16/vue3%E5%9F%BA%E6%9C%AC%E7%8E%A9%E6%B3%95/"/>
    <id>http://yoursite.com/2019/11/16/vue3基本玩法/</id>
    <published>2019-11-16T07:40:56.000Z</published>
    <updated>2020-01-13T15:24:53.185Z</updated>
    
    <content type="html"><![CDATA[<p>尤大大在5号凌晨公布了尚处于Pre-Alpha状态的Vue3源码。</p><p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1399664349&auto=0&height=66"></iframe><br><a id="more"></a></p><p>Vue3主要的架构改进、优化和新功能均已完成，剩下的主要任务是完成一些Vue2现有功能的移植。稳定版的具体发布时间尚未提及，不过根据Vue在GitHub repo公开展示的Roadmap，后面应该还会发布Alpha（计划于 Q4 发布）、Beta等版本，所以至少要等到2020年才有可能发布3.0稳定版。</p><p>尤雨溪在去年发表的”Vue 3.0 Updates”主题演讲中曾强调过 Vue3包含的五个关键变化：<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/vue3/update.png" alt="update" title="">                </div>                <div class="image-caption">update</div>            </figure> </p><p><a href="https://github.com/vuejs/composition-api" target="_blank" rel="external">vue-function-api: https://github.com/vuejs/composition-api</a><br><a href="https://github.com/vuejs/composition-api" target="_blank" rel="external">composition-api: https://github.com/vuejs/composition-api</a><br><a href="https://github.com/vuejs/vue-next" target="_blank" rel="external">vue-next: https://github.com/vuejs/vue-next</a></p><p>vue3相对于之前的版本在目录结构上有很大的改变，主要的代码都在packages中<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/vue3/file.png" alt="" update""="" title="">                </div>                <div class="image-caption">"update"</div>            </figure> </p><h2 id="packages目录结构"><a href="#packages目录结构" class="headerlink" title="packages目录结构"></a>packages目录结构</h2><p>1、compiler-core：核心编译器<br>2、compiler-dom：基于compiler-core封装对于浏览器的编译<br>3、reactivity：响应式<br>4、runtime-core:运行时的核心<br>5、runtime-dom:基于runtime-core编译浏览器支持<br>6、runtime-test:测试<br>7、vue：整合compiler和runtime</p><p>vue3和vue2最大的改变就是数据响应的改变<br>2.0的核心是Object.defineProperty<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/vue3/objectdefine.png" alt="" object.defineproperty""="" title="">                </div>                <div class="image-caption">"Object.defineProperty"</div>            </figure><br>3.0使用了proxy代理的模式<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/vue3/proxy.png" alt="" proxy""="" title="">                </div>                <div class="image-caption">"proxy"</div>            </figure><br>3.0的响应式和2.0的区别<br>2.0会默认递归，2.0数组改变length无效，2.0对象不存在的属性不拦截</p><h3 id="尝试一个3-0"><a href="#尝试一个3-0" class="headerlink" title="尝试一个3.0"></a>尝试一个3.0</h3><p>运行npm run dev，之后在vue目录下生成一个dist目录，里头有个vue.global.js，这个js就是3.0预览版的源代码<br>接着不用cli尝试一个3.0的程序<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/vue3/3.0html.png" alt="" vue.global.js""="" title="">                </div>                <div class="image-caption">"src vue.global.js"</div>            </figure></p><h2 id="3-0-API"><a href="#3-0-API" class="headerlink" title="3.0 API"></a>3.0 API</h2><h3 id="cli下使用3-0"><a href="#cli下使用3-0" class="headerlink" title="cli下使用3.0"></a>cli下使用3.0</h3><p>先装一下新版本的cli<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">npm install -g @vue/cli</div><div class="line"># OR</div><div class="line">yarn global add @vue/cli</div></pre></td></tr></table></figure></p><p>然后装一下composition-api(新的特性大都在这个包里面)<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">npm install @vue/composition-api --save</div><div class="line"># OR</div><div class="line">yarn add @vue/composition-api</div></pre></td></tr></table></figure></p><p>装完composition-api之后要像使用vuex或者vue-router一样Vue.use一下<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></div><div class="line"><span class="keyword">import</span> VueCompositionApi <span class="keyword">from</span> <span class="string">'@vue/composition-api'</span></div><div class="line"></div><div class="line">Vue.use(VueCompositionApi)</div></pre></td></tr></table></figure></p><h3 id="setup"><a href="#setup" class="headerlink" title="setup"></a>setup</h3><p>vue3中专门为组件提供的新属性，Composition API的统一入口。setup函数会在beforeCreate 之后、created之前执行，不过在3.0中没有beforeCreate和created了</p><h3 id="props"><a href="#props" class="headerlink" title="props"></a>props</h3><p>定义当前组件允许外界传递过来的参数名称：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//home.vue</span></div><div class="line">&lt;HelloWorld msg=<span class="string">"Welcome to Your Vue.js App"</span>/&gt;</div><div class="line"></div><div class="line"><span class="comment">//helloword.vue</span></div><div class="line">&lt;template&gt;</div><div class="line">  &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"hello"</span>&gt;<span class="keyword">this</span> is hello&lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">&lt;/</span>template&gt;</div><div class="line"></div><div class="line">&lt;script&gt;</div><div class="line"><span class="keyword">import</span> &#123;&#125; <span class="keyword">from</span> <span class="string">"@vue/composition-api"</span>;</div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  setup(props, context) &#123;</div><div class="line">    <span class="built_in">console</span>.log(props.msg); </div><div class="line">  &#125;,</div><div class="line">  props: &#123;</div><div class="line">    msg: <span class="built_in">String</span></div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line">&lt;<span class="regexp">/script&gt;</span></div></pre></td></tr></table></figure></p><h3 id="context"><a href="#context" class="headerlink" title="context"></a>context</h3><p>setup函数的第二个形参是一个上下文对象，这个对象相当于2.0时候的this，2.0中通过this.xxx拿到的东西，在3.0中通过context拿，而this是undefined,也就是说setup中无法访问this<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/vue3/setup.png" alt="" setup""="" title="">                </div>                <div class="image-caption">"setup"</div>            </figure><br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/vue3/setupconso.png" alt="" console""="" title="">                </div>                <div class="image-caption">"console"</div>            </figure></p><h3 id="reactive"><a href="#reactive" class="headerlink" title="reactive"></a>reactive</h3><p>reactive() 函数接收一个普通对象，返回一个响应式的数据对象。<br>等价于vue2.x中的Vue.observable()函数,用来创建响应式对象,像上面写的<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; reactive &#125; <span class="keyword">from</span> <span class="string">'@vue/composition-api'</span></div><div class="line"><span class="keyword">const</span> state = reactive(&#123; <span class="attr">name</span>:<span class="string">'hardy'</span> &#125;)     <span class="comment">//类似于data返回一个响应式对象</span></div></pre></td></tr></table></figure></p><p>要在template中使用的话要在setup函数中return<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">setup()&#123;</div><div class="line">    <span class="keyword">const</span> state = reactive(&#123; <span class="attr">name</span>:<span class="string">'hardy'</span> &#125;)     <span class="comment">//类似于data返回一个响应式对象</span></div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        state</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&lt;template&gt;</div><div class="line">   &lt;div&gt;&#123;&#123;name&#125;&#125;&lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">&lt;/</span>template&gt;</div></pre></td></tr></table></figure></p><h2 id="ref"><a href="#ref" class="headerlink" title="ref"></a>ref</h2><p>ref()函数用来根据给定的值创建一个响应式的数据对象，ref()函数调用的返回值是一个对象，这个对象上只包含一个.value属性,当把ref()创建出来的响应式数据对象，挂载到reactive()上时，会自动把响应式数据对象展开为原始的值，不需通过.value 就可以直接被访问</p><p>注意：新的 ref 会覆盖旧的 ref</p><h2 id="isRef"><a href="#isRef" class="headerlink" title="isRef"></a>isRef</h2><p>isRef()用来判断某个值是否为ref()创建出来的对象；<br>应用场景：当需要展开某个可能为ref()创建出来的值的时候</p><h2 id="toRefs"><a href="#toRefs" class="headerlink" title="toRefs"></a>toRefs</h2><p>toRefs()函数可以将reactive()创建出来的响应式对象，转换为普通的对象，只不过，这个对象上的每个属性节点，都是ref()类型的响应式数据</p><h2 id="computed"><a href="#computed" class="headerlink" title="computed"></a>computed</h2><p>computed() 用来创建计算属性，computed()函数的返回值是一个ref的实例</p><h3 id="只读"><a href="#只读" class="headerlink" title="只读"></a>只读</h3><p>在调用computed()函数期间，传入一个function函数，可以得到一个只读的计算属性<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> newName = computed(<span class="function"><span class="params">()</span>=&gt;</span>name=<span class="string">'小方块'</span>)</div></pre></td></tr></table></figure></p><h3 id="可读可写"><a href="#可读可写" class="headerlink" title="可读可写"></a>可读可写</h3><p>在调用 computed() 函数期间，传入一个包含 get 和 set 函数的对象，可以得到一个可读可写的计算属性<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> newName = computed(&#123;</div><div class="line">get:<span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;,</div><div class="line">set:<span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p><h2 id="watch"><a href="#watch" class="headerlink" title="watch"></a>watch</h2><p>watch() 函数用来监视某些数据项的变化，从而触发某些特定的操作</p><h3 id="监听reactive类型的数据源"><a href="#监听reactive类型的数据源" class="headerlink" title="监听reactive类型的数据源"></a>监听reactive类型的数据源</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 定义数据源</span></div><div class="line"><span class="keyword">const</span> state = reactive(&#123; <span class="attr">count</span>: <span class="number">0</span> &#125;)</div><div class="line"><span class="comment">// 监视 state.count 这个数据节点的变化</span></div><div class="line">watch(</div><div class="line">  () =&gt; state.count,</div><div class="line">  (count, prevCount) =&gt; &#123;</div><div class="line">    <span class="comment">/* ... */</span></div><div class="line">  &#125;</div><div class="line">)</div></pre></td></tr></table></figure><h3 id="监视-ref-类型的数据源"><a href="#监视-ref-类型的数据源" class="headerlink" title="监视 ref 类型的数据源"></a>监视 ref 类型的数据源</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 定义数据源</span></div><div class="line"><span class="keyword">const</span> count = ref(<span class="number">0</span>)</div><div class="line"><span class="comment">// 指定要监视的数据源</span></div><div class="line">watch(count, (count, prevCount) =&gt; &#123;</div><div class="line">  <span class="comment">/* ... */</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure><h3 id="监视多个数据源"><a href="#监视多个数据源" class="headerlink" title="监视多个数据源"></a>监视多个数据源</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> state = reactive(&#123; <span class="attr">count</span>: <span class="number">0</span>, <span class="attr">name</span>: <span class="string">'zs'</span> &#125;)</div><div class="line"></div><div class="line">watch(</div><div class="line">  [<span class="function"><span class="params">()</span> =&gt;</span> state.count, () =&gt; state.name], <span class="comment">// Object.values(toRefs(state)),</span></div><div class="line">  ([count, name], [prevCount, prevName]) =&gt; &#123;</div><div class="line">    <span class="built_in">console</span>.log(count) <span class="comment">// 新的 count 值</span></div><div class="line">    <span class="built_in">console</span>.log(name) <span class="comment">// 新的 name 值</span></div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'------------'</span>)</div><div class="line">    <span class="built_in">console</span>.log(prevCount) <span class="comment">// 旧的 count 值</span></div><div class="line">    <span class="built_in">console</span>.log(prevName) <span class="comment">// 新的 name 值</span></div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">    lazy: <span class="literal">true</span> <span class="comment">// 在 watch 被创建的时候，不执行回调函数中的代码</span></div><div class="line">  &#125;</div><div class="line">)</div><div class="line"></div><div class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  state.count++</div><div class="line">  state.name = <span class="string">'ls'</span></div><div class="line">&#125;, <span class="number">1000</span>)</div></pre></td></tr></table></figure><h3 id="监视多个ref类型的数据源"><a href="#监视多个ref类型的数据源" class="headerlink" title="监视多个ref类型的数据源"></a>监视多个ref类型的数据源</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> count = ref(<span class="number">0</span>)</div><div class="line"><span class="keyword">const</span> name = ref(<span class="string">'zs'</span>)</div><div class="line"></div><div class="line">watch(</div><div class="line">  [count, name], <span class="comment">// 需要被监视的多个 ref 数据源</span></div><div class="line">  ([count, name], [prevCount, prevName]) =&gt; &#123;</div><div class="line">    <span class="built_in">console</span>.log(count)</div><div class="line">    <span class="built_in">console</span>.log(name)</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'-------------'</span>)</div><div class="line">    <span class="built_in">console</span>.log(prevCount)</div><div class="line">    <span class="built_in">console</span>.log(prevName)</div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">    lazy: <span class="literal">true</span></div><div class="line">  &#125;</div><div class="line">)</div><div class="line"></div><div class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  count.value++</div><div class="line">  name.value = <span class="string">'xiaomaolv'</span></div><div class="line">&#125;, <span class="number">1000</span>)</div></pre></td></tr></table></figure><h3 id="清除监视"><a href="#清除监视" class="headerlink" title="清除监视"></a>清除监视</h3><p>在 setup() 函数内创建的 watch 监视，会在当前组件被销毁的时候自动停止。如果想要明确地停止某个监视，可以调用 watch() 函数的返回值即可<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 创建监视，并得到 停止函数</span></div><div class="line"><span class="keyword">const</span> stop = watch(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="comment">/* ... */</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// 调用停止函数，清除对应的监视</span></div><div class="line">stop()</div></pre></td></tr></table></figure></p><h3 id="在-watch-中清除无效的异步任务"><a href="#在-watch-中清除无效的异步任务" class="headerlink" title="在 watch 中清除无效的异步任务"></a>在 watch 中清除无效的异步任务</h3><p>有时候，当被 watch 监视的值发生变化时，或 watch 本身被 stop 之后，我们期望能够清除那些无效的异步任务，此时，watch 回调函数中提供了一个 cleanup registrator function 来执行清除的工作。这个清除函数会在如下情况下被调用：</p><blockquote><p>watch 被重复执行了<br>watch 被强制 stop 了</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">&lt;input type=<span class="string">"text"</span> v-model=<span class="string">"keywords"</span> /&gt;</div><div class="line"></div><div class="line"><span class="comment">// 定义响应式数据 keywords</span></div><div class="line"><span class="keyword">const</span> keywords = ref(<span class="string">''</span>)</div><div class="line"></div><div class="line"><span class="comment">// 异步任务：打印用户输入的关键词</span></div><div class="line"><span class="keyword">const</span> asyncPrint = <span class="function"><span class="params">val</span> =&gt;</span> &#123;</div><div class="line">  <span class="comment">// 延时 1 秒后打印</span></div><div class="line">  <span class="keyword">return</span> setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(val)</div><div class="line">  &#125;, <span class="number">1000</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 定义 watch 监听</span></div><div class="line">watch(</div><div class="line">  keywords,</div><div class="line">  (keywords, prevKeywords, onCleanup) =&gt; &#123;</div><div class="line">    <span class="comment">// 执行异步任务，并得到关闭异步任务的 timerId</span></div><div class="line">    <span class="keyword">const</span> timerId = asyncPrint(keywords)</div><div class="line"></div><div class="line">    <span class="comment">// 如果 watch 监听被重复执行了，则会先清除上次未完成的异步任务</span></div><div class="line">    onCleanup(<span class="function"><span class="params">()</span> =&gt;</span> clearTimeout(timerId))</div><div class="line">  &#125;,</div><div class="line">  <span class="comment">// watch 刚被创建的时候不执行</span></div><div class="line">  &#123; <span class="attr">lazy</span>: <span class="literal">true</span> &#125;</div><div class="line">)</div><div class="line"></div><div class="line"><span class="comment">// 把 template 中需要的数据 return 出去</span></div><div class="line"><span class="keyword">return</span> &#123;</div><div class="line">  keywords</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="LifeCycle-Hooks"><a href="#LifeCycle-Hooks" class="headerlink" title="LifeCycle Hooks"></a>LifeCycle Hooks</h2><p>新版的生命周期函数，可以按需导入到组件中，且只能在 setup() 函数中使用<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; onMounted, onUpdated, onUnmounted &#125; <span class="keyword">from</span> <span class="string">'@vue/composition-api'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> MyComponent = &#123;</div><div class="line">  setup() &#123;</div><div class="line">    onMounted(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      <span class="built_in">console</span>.log(<span class="string">'mounted!'</span>)</div><div class="line">    &#125;)</div><div class="line">    onUpdated(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      <span class="built_in">console</span>.log(<span class="string">'updated!'</span>)</div><div class="line">    &#125;)</div><div class="line">    onUnmounted(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      <span class="built_in">console</span>.log(<span class="string">'unmounted!'</span>)</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>vue 2.x 的生命周期函数与新版 Composition API 之间的映射关系:</p><blockquote><p>❌ beforeCreate -&gt; use setup()<br>❌ created -&gt; use setup()<br>beforeMount -&gt; onBeforeMount<br>mounted -&gt; onMounted<br>beforeUpdate -&gt; onBeforeUpdate<br>updated -&gt; onUpdated<br>beforeDestroy -&gt; onBeforeUnmount<br>destroyed -&gt; onUnmounted<br>errorCaptured -&gt; onErrorCaptured</p></blockquote><h2 id="provide-amp-inject"><a href="#provide-amp-inject" class="headerlink" title="provide &amp; inject"></a>provide &amp; inject</h2><p>provide() 和 inject() 可以实现嵌套组件之间的数据传递。这两个函数只能在 setup() 函数中使用。父级组件中使用 provide() 函数向下传递数据；子级组件中使用 inject() 获取上层传递过来的数据。</p><p>provide和react的provide很像，在react中需要全局共享数据，使用redux，单一数据源，传入<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;Provider store=&#123;store&#125;&gt;</div><div class="line">    &lt;Component1 /&gt;</div><div class="line">    &lt;Component2 /&gt;</div><div class="line">&lt;<span class="regexp">/Provider&gt;</span></div></pre></td></tr></table></figure></p><h3 id="共享普通数据"><a href="#共享普通数据" class="headerlink" title="共享普通数据"></a>共享普通数据</h3><p>根组件<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">&lt;template&gt;</div><div class="line">  &lt;div id=<span class="string">"app"</span>&gt;</div><div class="line">    &lt;h1&gt;App 根组件&lt;<span class="regexp">/h1&gt;</span></div><div class="line"><span class="regexp">    &lt;hr /</span>&gt;</div><div class="line">    &lt;LevelOne /&gt;</div><div class="line">  &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">&lt;/</span>template&gt;</div><div class="line"></div><div class="line">&lt;script&gt;</div><div class="line"><span class="keyword">import</span> LevelOne <span class="keyword">from</span> <span class="string">'./components/LevelOne'</span></div><div class="line"><span class="comment">// 1. 按需导入 provide</span></div><div class="line"><span class="keyword">import</span> &#123; provide &#125; <span class="keyword">from</span> <span class="string">'@vue/composition-api'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  name: <span class="string">'app'</span>,</div><div class="line">  setup() &#123;</div><div class="line">    <span class="comment">// 2. App 根组件作为父级组件，通过 provide 函数向子级组件共享数据（不限层级）</span></div><div class="line">    <span class="comment">//    provide('要共享的数据名称', 被共享的数据)</span></div><div class="line">    provide(<span class="string">'globalColor'</span>, <span class="string">'red'</span>)</div><div class="line">  &#125;,</div><div class="line">  components: &#123;</div><div class="line">    LevelOne</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">&lt;<span class="regexp">/script&gt;</span></div></pre></td></tr></table></figure></p><p>子组件1<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">&lt;template&gt;</div><div class="line">  &lt;div&gt;</div><div class="line">    &lt;!-- <span class="number">4.</span> 通过属性绑定，为标签设置字体颜色 --&gt;</div><div class="line">    &lt;h3 :style=<span class="string">"&#123;color: themeColor&#125;"</span>&gt;Level One&lt;<span class="regexp">/h3&gt;</span></div><div class="line"><span class="regexp">    &lt;hr /</span>&gt;</div><div class="line">    &lt;LevelTwo /&gt;</div><div class="line">  &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">&lt;/</span>template&gt;</div><div class="line"></div><div class="line">&lt;script&gt;</div><div class="line"><span class="keyword">import</span> LevelTwo <span class="keyword">from</span> <span class="string">'./LevelTwo'</span></div><div class="line"><span class="comment">// 1. 按需导入 inject</span></div><div class="line"><span class="keyword">import</span> &#123; inject &#125; <span class="keyword">from</span> <span class="string">'@vue/composition-api'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  setup() &#123;</div><div class="line">    <span class="comment">// 2. 调用 inject 函数时，通过指定的数据名称，获取到父级共享的数据</span></div><div class="line">    <span class="keyword">const</span> themeColor = inject(<span class="string">'globalColor'</span>)</div><div class="line"></div><div class="line">    <span class="comment">// 3. 把接收到的共享数据 return 给 Template 使用</span></div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      themeColor</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  components: &#123;</div><div class="line">    LevelTwo</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">&lt;<span class="regexp">/script&gt;</span></div></pre></td></tr></table></figure></p><p>子组件2<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">&lt;template&gt;</div><div class="line">  &lt;div&gt;</div><div class="line">    &lt;!-- <span class="number">4.</span> 通过属性绑定，为标签设置字体颜色 --&gt;</div><div class="line">    &lt;h5 :style=<span class="string">"&#123;color: themeColor&#125;"</span>&gt;Level Two&lt;<span class="regexp">/h5&gt;</span></div><div class="line"><span class="regexp">  &lt;/</span>div&gt;</div><div class="line">&lt;<span class="regexp">/template&gt;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">&lt;script&gt;</span></div><div class="line"><span class="regexp">/</span><span class="regexp">/ 1. 按需导入 inject</span></div><div class="line"><span class="regexp">import &#123; inject &#125; from '@vue/</span>composition-api<span class="string">'</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">export default &#123;</span></div><div class="line"><span class="string">  setup() &#123;</span></div><div class="line"><span class="string">    // 2. 调用 inject 函数时，通过指定的数据名称，获取到父级共享的数据</span></div><div class="line"><span class="string">    const themeColor = inject('</span>globalColor<span class="string">')</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">    // 3. 把接收到的共享数据 return 给 Template 使用</span></div><div class="line"><span class="string">    return &#123;</span></div><div class="line"><span class="string">      themeColor</span></div><div class="line"><span class="string">    &#125;</span></div><div class="line"><span class="string">  &#125;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string">&lt;/script&gt;</span></div></pre></td></tr></table></figure></p><h3 id="共享ref响应数据"><a href="#共享ref响应数据" class="headerlink" title="共享ref响应数据"></a>共享ref响应数据</h3><p>如下代码实现了点按钮切换主题颜色的功能，主要修改了根组件中的代码，子组件1和子组件2中的代码不受任何改变：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">&lt;template&gt;</div><div class="line">  &lt;div id=<span class="string">"app"</span>&gt;</div><div class="line">    &lt;h1&gt;App 根组件&lt;<span class="regexp">/h1&gt;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">    &lt;!-- 点击 App.vue 中的按钮，切换子组件中文字的颜色 --&gt;</span></div><div class="line"><span class="regexp">    &lt;button @click="themeColor='red'"&gt;红色&lt;/</span>button&gt;</div><div class="line">    &lt;button @click=<span class="string">"themeColor='blue'"</span>&gt;蓝色&lt;<span class="regexp">/button&gt;</span></div><div class="line"><span class="regexp">    &lt;button @click="themeColor='orange'"&gt;橘黄色&lt;/</span>button&gt;</div><div class="line"></div><div class="line">    &lt;hr /&gt;</div><div class="line">    &lt;LevelOne /&gt;</div><div class="line">  &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">&lt;/</span>template&gt;</div><div class="line"></div><div class="line">&lt;script&gt;</div><div class="line"><span class="keyword">import</span> LevelOne <span class="keyword">from</span> <span class="string">'./components/LevelOne'</span></div><div class="line"><span class="keyword">import</span> &#123; provide, ref &#125; <span class="keyword">from</span> <span class="string">'@vue/composition-api'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  name: <span class="string">'app'</span>,</div><div class="line">  setup() &#123;</div><div class="line">    <span class="comment">// 定义 ref 响应式数据</span></div><div class="line">    <span class="keyword">const</span> themeColor = ref(<span class="string">'red'</span>)</div><div class="line"></div><div class="line">    <span class="comment">// 把 ref 数据通过 provide 提供的子组件使用</span></div><div class="line">    provide(<span class="string">'globalColor'</span>, themeColor)</div><div class="line"></div><div class="line">    <span class="comment">// setup 中 return 数据供当前组件的 Template 使用</span></div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      themeColor</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  components: &#123;</div><div class="line">    LevelOne</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">&lt;<span class="regexp">/script&gt;</span></div></pre></td></tr></table></figure></p><h2 id="template-refs"><a href="#template-refs" class="headerlink" title="template refs"></a>template refs</h2><p>通过 ref() 可以引用页面上的元素或组件。</p><h3 id="元素的引用"><a href="#元素的引用" class="headerlink" title="元素的引用"></a>元素的引用</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">&lt;template&gt;</div><div class="line">  &lt;div&gt;</div><div class="line">    &lt;h3 ref=<span class="string">"h3Ref"</span>&gt;TemplateRefOne&lt;<span class="regexp">/h3&gt;</span></div><div class="line"><span class="regexp">  &lt;/</span>div&gt;</div><div class="line">&lt;<span class="regexp">/template&gt;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">&lt;script&gt;</span></div><div class="line"><span class="regexp">import &#123; ref, onMounted &#125; from '@vue/</span>composition-api<span class="string">'</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">export default &#123;</span></div><div class="line"><span class="string">  setup() &#123;</span></div><div class="line"><span class="string">    // 创建一个 DOM 引用</span></div><div class="line"><span class="string">    const h3Ref = ref(null)</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">    // 在 DOM 首次加载完毕之后，才能获取到元素的引用</span></div><div class="line"><span class="string">    onMounted(() =&gt; &#123;</span></div><div class="line"><span class="string">      // 为 dom 元素设置字体颜色</span></div><div class="line"><span class="string">      // h3Ref.value 是原生DOM对象</span></div><div class="line"><span class="string">      h3Ref.value.style.color = '</span>red<span class="string">'</span></div><div class="line"><span class="string">    &#125;)</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">    // 把创建的引用 return 出去</span></div><div class="line"><span class="string">    return &#123;</span></div><div class="line"><span class="string">      h3Ref</span></div><div class="line"><span class="string">    &#125;</span></div><div class="line"><span class="string">  &#125;</span></div><div class="line"><span class="string">&#125;</span></div><div class="line"><span class="string">&lt;/script&gt;</span></div></pre></td></tr></table></figure><p>组件1<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">&lt;template&gt;</div><div class="line">  &lt;div&gt;</div><div class="line">    &lt;h3&gt;TemplateRefOne&lt;<span class="regexp">/h3&gt;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">    &lt;!-- 4. 点击按钮展示子组件的 count 值 --&gt;</span></div><div class="line"><span class="regexp">    &lt;button @click="showNumber"&gt;获取TemplateRefTwo中的count值&lt;/</span>button&gt;</div><div class="line"></div><div class="line">    &lt;hr /&gt;</div><div class="line">    &lt;!-- <span class="number">3.</span> 为组件添加 ref 引用 --&gt;</div><div class="line">    &lt;TemplateRefTwo ref=<span class="string">"comRef"</span> /&gt;</div><div class="line">  &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">&lt;/</span>template&gt;</div><div class="line"></div><div class="line">&lt;script&gt;</div><div class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">'@vue/composition-api'</span></div><div class="line"><span class="keyword">import</span> TemplateRefTwo <span class="keyword">from</span> <span class="string">'./TemplateRefTwo'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  setup() &#123;</div><div class="line">    <span class="comment">// 1. 创建一个组件的 ref 引用</span></div><div class="line">    <span class="keyword">const</span> comRef = ref(<span class="literal">null</span>)</div><div class="line"></div><div class="line">    <span class="comment">// 5. 展示子组件中 count 的值</span></div><div class="line">    <span class="keyword">const</span> showNumber = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      <span class="built_in">console</span>.log(comRef.value.count)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// 2. 把创建的引用 return 出去</span></div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      comRef,</div><div class="line">      showNumber</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  components: &#123;</div><div class="line">    TemplateRefTwo</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">&lt;<span class="regexp">/script&gt;</span></div></pre></td></tr></table></figure></p><p>组件2<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">&lt;template&gt;</div><div class="line">  &lt;div&gt;</div><div class="line">    &lt;h5&gt;TemplateRefTwo --- &#123;&#123;count&#125;&#125;&lt;<span class="regexp">/h5&gt;</span></div><div class="line"><span class="regexp">    &lt;!-- 3. 点击按钮，让 count 值自增 +1 --&gt;</span></div><div class="line"><span class="regexp">    &lt;button @click="count+=1"&gt;+1&lt;/</span>button&gt;</div><div class="line">  &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">&lt;/</span>template&gt;</div><div class="line"></div><div class="line">&lt;script&gt;</div><div class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">'@vue/composition-api'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  setup() &#123;</div><div class="line">    <span class="comment">// 1. 定义响应式的数据</span></div><div class="line">    <span class="keyword">const</span> count = ref(<span class="number">0</span>)</div><div class="line"></div><div class="line">    <span class="comment">// 2. 把响应式数据 return 给 Template 使用</span></div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      count</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">&lt;<span class="regexp">/script&gt;</span></div></pre></td></tr></table></figure></p><h2 id="createComponent"><a href="#createComponent" class="headerlink" title="createComponent"></a>createComponent</h2><blockquote><p>这个函数不是必须的，除非你想要完美结合 TypeScript 提供的类型推断来进行项目的开发。</p></blockquote><p>这个函数仅仅提供了类型推断，方便在结合 TypeScript 书写代码时，能为 setup() 中的 props 提供完整的类型推断。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; createComponent &#125; <span class="keyword">from</span> <span class="string">'vue'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> createComponent(&#123;</div><div class="line">  props: &#123;</div><div class="line">    foo: <span class="built_in">String</span></div><div class="line">  &#125;,</div><div class="line">  setup(props) &#123;</div><div class="line">    props.foo <span class="comment">// &lt;- type: string</span></div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;尤大大在5号凌晨公布了尚处于Pre-Alpha状态的Vue3源码。&lt;/p&gt;
&lt;p&gt;&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;//music.163.com/outchain/player?type=2&amp;id=1399664349&amp;auto=0&amp;height=66&quot;&gt;&lt;/iframe&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="vue3" scheme="http://yoursite.com/tags/vue3/"/>
    
      <category term="vue-next" scheme="http://yoursite.com/tags/vue-next/"/>
    
      <category term="vue-function-api" scheme="http://yoursite.com/tags/vue-function-api/"/>
    
      <category term="vue-compisition-api" scheme="http://yoursite.com/tags/vue-compisition-api/"/>
    
  </entry>
  
  <entry>
    <title>如何简单粗暴生成条码和二维码</title>
    <link href="http://yoursite.com/2019/11/08/%E5%A6%82%E4%BD%95%E7%AE%80%E5%8D%95%E7%B2%97%E6%9A%B4%E7%94%9F%E6%88%90%E6%9D%A1%E7%A0%81%E5%92%8C%E4%BA%8C%E7%BB%B4%E7%A0%81/"/>
    <id>http://yoursite.com/2019/11/08/如何简单粗暴生成条码和二维码/</id>
    <published>2019-11-08T15:11:58.000Z</published>
    <updated>2020-01-13T15:36:51.875Z</updated>
    
    <content type="html"><![CDATA[<p>有一种情况，你的商品需要带上条形码，就像你在超市买可乐会扫一下，或者带个二维码。</p><p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=453498650&auto=0&height=66"></iframe><br><a id="more"></a></p><p>今天团队里的一个前端同学遇到了一个问题，就是需要根据接口拿到的数据，生成条形码并且可以点击打印出来（不是console.log的这个打印，是打印条形码的打印机打印出的纸质条码）,因为应用环境是vue，所以举例用vue，因为项目的代码不能外泄，这里用npm包简单写2个一般开发够用的栗子</p><h3 id="条形码"><a href="#条形码" class="headerlink" title="条形码"></a>条形码</h3><p>条形码的长相很普通，比如一般买的书后面带的那个，长相就像这样<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/barqrcode/barcode.png" alt="“barcode”" title="">                </div>                <div class="image-caption">“barcode”</div>            </figure><br>实现起来非常简单，安装and使用<br>一、安装<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install --save jsbarcode</div></pre></td></tr></table></figure></p><p>二、使用<br>vue环境<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">ref</span>=<span class="string">"barcode"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></div><div class="line"><span class="javascript"><span class="keyword">import</span> JSbarcode <span class="keyword">from</span> <span class="string">'jsbarcode'</span></span></div><div class="line"><span class="javascript">  <span class="keyword">export</span> <span class="keyword">default</span>&#123;</span></div><div class="line"><span class="undefined">    mounted() &#123;</span></div><div class="line"><span class="javascript">      <span class="keyword">this</span>._initJsBarcode();</span></div><div class="line"><span class="undefined">    &#125;,</span></div><div class="line"><span class="undefined">   methods: &#123;</span></div><div class="line"><span class="undefined">      _initJsBarcode() &#123;</span></div><div class="line"><span class="javascript">        <span class="keyword">let</span> dom = <span class="keyword">this</span>.$refs.barcode;</span></div><div class="line"><span class="javascript">        <span class="keyword">let</span> options = &#123;</span></div><div class="line"><span class="javascript">          width: <span class="number">2</span>,                   <span class="comment">//较细处条形码的宽度</span></span></div><div class="line"><span class="javascript">          height: <span class="number">100</span>,                <span class="comment">//条形码的宽度，无高度直接设置项，由位数决定</span></span></div><div class="line"><span class="undefined">          quite: 10,</span></div><div class="line"><span class="javascript">          format: <span class="string">"CODE128"</span>,</span></div><div class="line"><span class="javascript">          displayValue: <span class="literal">true</span>,         <span class="comment">//是否在条码下方显示文字</span></span></div><div class="line"><span class="javascript">          font:<span class="string">"monospace"</span>,   </span></div><div class="line"><span class="javascript">          textAlign:<span class="string">"center"</span>,          <span class="comment">//对齐</span></span></div><div class="line"><span class="javascript">          fontSize: <span class="number">12</span>,                <span class="comment">//字体大小</span></span></div><div class="line"><span class="javascript">          backgroundColor:<span class="string">""</span>,         <span class="comment">//条码背景色</span></span></div><div class="line"><span class="javascript">          lineColor:<span class="string">"#000"</span>            <span class="comment">//条码颜色</span></span></div><div class="line"><span class="undefined">          ....</span></div><div class="line"><span class="undefined">        &#125;;</span></div><div class="line"><span class="javascript">        <span class="keyword">let</span> _jsbarcode = JsBarcode(dom, <span class="string">"my name is hardy"</span>, options);</span></div><div class="line"><span class="undefined">      &#125;</span></div><div class="line"><span class="undefined">    &#125;</span></div><div class="line"><span class="undefined">  &#125;</span></div><div class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p><p>react 环境<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> JsBarcode  <span class="keyword">from</span> <span class="string">'jsbarcode'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Barcode</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(props) &#123;</div><div class="line">    <span class="keyword">super</span>(props);</div><div class="line">  &#125;</div><div class="line">  componentDidMount() &#123;</div><div class="line">      <span class="keyword">this</span>._initJsBarcode();</div><div class="line">  &#125;</div><div class="line">  _initJsBarcode()&#123;</div><div class="line">    <span class="keyword">let</span> _jsbarcode = JsBarcode(<span class="keyword">this</span>.barcode, <span class="string">"my name is hardy"</span>, &#123;</div><div class="line">      width: <span class="number">2</span>,                   <span class="comment">//较细处条形码的宽度</span></div><div class="line">      height: <span class="number">100</span>,                <span class="comment">//条形码的宽度，无高度直接设置项，由位数决定</span></div><div class="line">      quite: <span class="number">10</span>,</div><div class="line">      format: <span class="string">"CODE128"</span>,</div><div class="line">      displayValue: <span class="literal">true</span>,         <span class="comment">//是否在条码下方显示文字</span></div><div class="line">      font:<span class="string">"monospace"</span>,   </div><div class="line">      textAlign:<span class="string">"center"</span>,          <span class="comment">//对齐</span></div><div class="line">      fontSize: <span class="number">12</span>,                <span class="comment">//字体大小</span></div><div class="line">      backgroundColor:<span class="string">""</span>,         <span class="comment">//条码背景色</span></div><div class="line">      lineColor:<span class="string">"#000"</span>            <span class="comment">//条码颜色</span></div><div class="line">      ....</div><div class="line">    &#125;);</div><div class="line">  &#125;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> (</div><div class="line">      &lt;div className=<span class="string">"barcode-container"</span>&gt;</div><div class="line">        &lt;svg</div><div class="line">          ref=&#123;(ref) =&gt; &#123;</div><div class="line">            <span class="keyword">this</span>.barcode = ref;</div><div class="line">          &#125;&#125;</div><div class="line">       /&gt;</div><div class="line">      &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">    );</span></div><div class="line"><span class="regexp">  &#125;</span></div><div class="line"><span class="regexp">&#125;</span></div><div class="line"><span class="regexp">export default Barcode;</span></div></pre></td></tr></table></figure></p><p>html 环境<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"> <span class="tag">&lt;<span class="name">head</span>&gt;</span> </div><div class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span> </div><div class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"js/jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"js/JsBarcode.all.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> </div><div class="line"> <span class="tag">&lt;/<span class="name">head</span>&gt;</span> </div><div class="line"> <span class="tag">&lt;<span class="name">body</span>&gt;</span> </div><div class="line">  <span class="tag">&lt;<span class="name">svg</span> <span class="attr">id</span>=<span class="string">"svgbarcode"</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span> </div><div class="line">  <span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">"canvascode"</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span> </div><div class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">id</span>=<span class="string">"imgcode"</span> /&gt;</span> </div><div class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined">  </span></div><div class="line"><span class="javascript">        $(<span class="string">"#svgbarcode"</span>).JsBarcode(<span class="string">'显示文案'</span>);</span></div><div class="line"><span class="undefined"></span></div><div class="line"><span class="javascript">        $(<span class="string">"#canvascode"</span>).JsBarcode(<span class="string">'显示文案'</span>);</span></div><div class="line"><span class="undefined">  </span></div><div class="line"><span class="javascript">        $(<span class="string">"#imgcode"</span>).JsBarcode(<span class="string">"显示文案"</span>);</span></div><div class="line"><span class="undefined">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> </div><div class="line"> <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p><p>这是github上它的配置参数<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/barqrcode/barcodeoptions.png" alt="配置参数''" title="">                </div>                <div class="image-caption">配置参数''</div>            </figure><br><a href="https://github.com/lindell/JsBarcode" target="_blank" rel="external">github地址</a></p><h3 id="二维码"><a href="#二维码" class="headerlink" title="二维码"></a>二维码</h3><p>二维码和条码的实现方式一样，只不过二维码用的npm包是qrcodejs2<br>同样的步骤<br>一、安装<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install --save qrcodejs2</div></pre></td></tr></table></figure></p><p>二、使用<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">&lt;template&gt;</div><div class="line">    &lt;div ref=<span class="string">"qrcode"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></div><div class="line">&lt;<span class="regexp">/template&gt;</span></div><div class="line"><span class="regexp"></span></div><div class="line"><span class="regexp">&lt;script&gt;</span></div><div class="line"><span class="regexp">import QRCode from 'qrcodejs2'</span></div><div class="line"><span class="regexp">  export default&#123;</span></div><div class="line"><span class="regexp">    mounted() &#123;</span></div><div class="line"><span class="regexp">      this._qrcode();</span></div><div class="line"><span class="regexp">    &#125;,</span></div><div class="line"><span class="regexp">   methods: &#123;</span></div><div class="line"><span class="regexp">      _qrcode()&#123;</span></div><div class="line"><span class="regexp">        let _qrcode = new QRCode(this.$refs.qrcode, &#123;</span></div><div class="line"><span class="regexp">        width: 132,</span></div><div class="line"><span class="regexp">        height: 132,</span></div><div class="line"><span class="regexp">        text: 'my name is hardy',</span></div><div class="line"><span class="regexp">        colorDark : "#000",</span></div><div class="line"><span class="regexp">        colorLight : "#fff",</span></div><div class="line"><span class="regexp">      &#125;)</span></div><div class="line"><span class="regexp">      &#125;</span></div><div class="line"><span class="regexp">    &#125;</span></div><div class="line"><span class="regexp">  &#125;</span></div><div class="line"><span class="regexp">&lt;/</span>script&gt;</div></pre></td></tr></table></figure></p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/barqrcode/qrcode.png" alt="生成效果''" title="">                </div>                <div class="image-caption">生成效果''</div>            </figure><p>生成二维码也可以使用QRCode.js<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&lt;div id=<span class="string">"qrcode"</span>&gt;&lt;/div&gt;</div><div class="line"></div><div class="line">var qrcode = new QRCode(<span class="string">"test"</span>, &#123;</div><div class="line">    text: <span class="string">"https://hhardyy.com/"</span>,    // 设置要生成二维码的链接</div><div class="line">    width: 128,</div><div class="line">    height: 128,</div><div class="line">    colorDark : <span class="string">"#000000"</span>,</div><div class="line">    colorLight : <span class="string">"#ffffff"</span>,</div><div class="line">    correctLevel : QRCode.CorrectLevel.H</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p><p><a href="https://github.com/davidshimjs/qrcodejs" target="_blank" rel="external">github地址</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;有一种情况，你的商品需要带上条形码，就像你在超市买可乐会扫一下，或者带个二维码。&lt;/p&gt;
&lt;p&gt;&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;//music.163.com/outchain/player?type=2&amp;id=453498650&amp;auto=0&amp;height=66&quot;&gt;&lt;/iframe&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="react" scheme="http://yoursite.com/tags/react/"/>
    
      <category term="vue" scheme="http://yoursite.com/tags/vue/"/>
    
      <category term="二维码" scheme="http://yoursite.com/tags/%E4%BA%8C%E7%BB%B4%E7%A0%81/"/>
    
      <category term="条形码" scheme="http://yoursite.com/tags/%E6%9D%A1%E5%BD%A2%E7%A0%81/"/>
    
      <category term="html" scheme="http://yoursite.com/tags/html/"/>
    
  </entry>
  
  <entry>
    <title>webpack4.x</title>
    <link href="http://yoursite.com/2019/09/30/webpack4-x/"/>
    <id>http://yoursite.com/2019/09/30/webpack4-x/</id>
    <published>2019-09-30T14:37:59.000Z</published>
    <updated>2020-01-13T15:27:58.144Z</updated>
    
    <content type="html"><![CDATA[<p>webpack4.x =&gt; vue.config.js但是 !== vue.config.js</p><p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1369794434&auto=0&height=66"></iframe><br><a id="more"></a></p><p>为什么要用webpack，你用的脚手架大部分都是基于这个东西，而这个东西基于nodejs，而nodejs依赖v8引擎，而v8引擎就是v8引擎。</p><blockquote><p>webpack4.x从安装开始</p></blockquote><h3 id="install"><a href="#install" class="headerlink" title="install"></a>install</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install webpack -webpack-cli -D</div></pre></td></tr></table></figure><p>解释：为什么webpack和webpack-cli需要分开安装，在webpack3中，webpack本身和它的CLI以前都是在同一个包中，但在第4版中已经将两者分开来更好地管理它们。webpack建议装在局部环境，虽然装在全局比较方便，但是当多个项目使用的webpack版本不一样的时候就会出现问题，即使把每个项目的webpack版本都改成一样的，又会导致原本的项目出问题，所以还是建议安装在局部环境，每个项目有独立的webpack。</p><h3 id="mode"><a href="#mode" class="headerlink" title="mode"></a>mode</h3><p>production：生产模式，线上的环境<br>development：开发模式，开发环境</p><h3 id="sourcemap"><a href="#sourcemap" class="headerlink" title="sourcemap"></a>sourcemap</h3><p><a href="https://www.webpackjs.com/configuration/devtool/" target="_blank" rel="external">官网介绍</a><br>mode  development  ‘cheap-module-eval-souce-map’    提示比较强，打包速度比较快<br>mode production  ‘cheap-module-souce-map’</p><h3 id="entry"><a href="#entry" class="headerlink" title="entry"></a>entry</h3><p>入口：每个 HTML 页面都有一个入口起点。单页应用(SPA)：一个入口起点，多页应用(MPA)：多个入口起点。<br>单个文件打包：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">entry:<span class="string">"index.js"</span></div></pre></td></tr></table></figure></p><p>多个文件打包成多个：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">entry:&#123;</div><div class="line">   one:<span class="string">'index1.js'</span>,</div><div class="line">   two:<span class="string">'index2.js'</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>多个文件打包成单个：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">entry: &#123;</div><div class="line">  main:[<span class="string">"index1.js"</span>,<span class="string">"index2.js"</span>]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>动态入口：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">entry: <span class="function"><span class="params">()</span> =&gt;</span> <span class="string">'index.js'</span></div></pre></td></tr></table></figure></p><p>多个动态入口：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">entry: <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> resolve([<span class="string">'index1.js'</span>, <span class="string">'index2.js'</span>]))</div></pre></td></tr></table></figure></p><h4 id="output"><a href="#output" class="headerlink" title="output"></a>output</h4><p>出口：output 位于对象最顶级键(key)，包括了一组选项，指示 webpack 如何去输出、以及在哪里输出你的「bundle、asset 和其他你所打包或使用 webpack 载入的任何内容」。output需要依赖node的path模块来指定当前项目的根目录。<br>单页面应用的输出：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">output:&#123;</div><div class="line">path:path.resolve(__dirname,<span class="string">'dist'</span>),   <span class="comment">//输出目录</span></div><div class="line">filename:<span class="string">'bundle'</span>  <span class="comment">//输出文件名</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>多页面输出：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">output:&#123;</div><div class="line"> filename: <span class="string">'[name].bundle.js'</span>,</div><div class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>[name]是根据入口entry设置的变量来输出对应的文件名<br>配置项大概这么多：<br>filename，输出的文件名，可以自定义一些名称规则<br>path，配置输出文件存放在本地的目录<br>publicPath，配置CDN的路径<br>chunkFilename ，处理异步加载时的命名规则<br>hash、chunkhash和contenthash三者的区别<br>hash是项目级别的，每次构建得出的hash都是相同的，这可能不利于文件的缓存<br>chunkhash是文件级别的，值是变动修改的文件的chunkhash值<br>contenthash是文件级别的，在拆分css文件时记得使用处理css的缓存</p><h3 id="module"><a href="#module" class="headerlink" title="module"></a>module</h3><p>模块：决定了如何处理项目中的不同类型的模块。防止 webpack 解析那些任何与给定正则表达式相匹配的文件。忽略的文件中不应该含有 import, require, define 的调用，或任何其他导入机制。忽略大型的 library 可以提高构建性能。这个参数还是有挺多的，可以去官网看<br>比如在安装完webpack之后项目目录中肯定多了一个叫node_modules的文件夹，里头有很多模块是不需要打包的，同时要识别jsx文件<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">rules: [&#123;</div><div class="line">   test: <span class="regexp">/\.tsx?$/</span>,</div><div class="line">   use: <span class="string">'ts-loader'</span>,</div><div class="line">   exclude: <span class="regexp">/node_modules/</span></div><div class="line">&#125;]</div></pre></td></tr></table></figure></p><h3 id="plugins"><a href="#plugins" class="headerlink" title="plugins"></a>plugins</h3><p>插件：plugins 选项用于以各种方式自定义 webpack 构建过程。webpack 附带了各种内置插件，可以通过 webpack.[plugin-name] 访问这些插件。请查看这个页面获取插件列表和对应文档，但请注意这只是其中一部分，社区中还有许多插件。比如我们做脚手架一定会用到的<a href="https://github.com/jantimon/html-webpack-plugin" target="_blank" rel="external">html-webpack-plugin</a>,可以去看一下它的Options，就可以根据业务来做脚手架了，使用也简单，install之后引入之后<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">plugins: [</div><div class="line">  <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</div><div class="line">    ...options</div><div class="line">  &#125;)</div><div class="line">]</div></pre></td></tr></table></figure></p><h3 id="devServer"><a href="#devServer" class="headerlink" title="devServer"></a>devServer</h3><p>开发环境下的一个内置小型本地服务器: 基于nodejs实现的服务器，你也可以自己写一个，就像这样<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</div><div class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)</div><div class="line"><span class="keyword">const</span> webpackDevMiddleware = <span class="built_in">require</span>(<span class="string">'webpack-dev-middleware'</span>)</div><div class="line"><span class="keyword">const</span> config = <span class="built_in">require</span>(<span class="string">'./webpack.config.js'</span>)</div><div class="line"><span class="keyword">const</span> conplier = webpack(config)</div><div class="line"></div><div class="line"><span class="keyword">const</span> app = express()</div><div class="line">app.use(webpackDevMiddleware(conplier,&#123;&#125;))</div><div class="line">app.listen(<span class="number">9090</span>,()=&gt;&#123;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'at 9090'</span>)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p><p>devServer是用来提高开发效率的，它提供了一些配置项，可以用于改变devServer的默认行为，要配置devServer，除了可以在配置文件里通过devServer传入参数，还可以通过命令行传入参数。</p><p>⚠️注意！！！只有在通过devServer启动webpack时，配置文件里的devServer才会生效，因为这些参数所对应的功能都是devServer提供的，webpack本身并不认识devServer的配置项。</p><h4 id="hot"><a href="#hot" class="headerlink" title="hot"></a>hot</h4><p>hot配置是否启用模块的热替换功能，开启之后代码变动会自动刷新页面，做到实时热更新<br>两种配置方法：<br>1、webpack.config.js里头的devServer设置hot为true或者false,需要引入一个热更新插件<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">plugins: [</div><div class="line">     <span class="keyword">new</span> webpack.HotModuleReplacementPlugin(), </div><div class="line">],</div></pre></td></tr></table></figure></p><p>2、命令行，在package.json中的script中，比如原本用来启动本地项目的命令后面加上–hot<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">"start"</span>: <span class="string">"NODE_ENV=development  webpack-dev-server --config  webpack.develop.config.js"</span></div></pre></td></tr></table></figure></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">"start"</span>: <span class="string">"NODE_ENV=development  webpack-dev-server --config  webpack.develop.config.js --hot"</span></div></pre></td></tr></table></figure><h4 id="host"><a href="#host" class="headerlink" title="host"></a>host</h4><p>devServer服务监听的地址，如果想让局域网内的其他用户访问本项目，可以将host配置为本机的IP，通过命令行 –host 0.0.0.0也可以</p><h4 id="port"><a href="#port" class="headerlink" title="port"></a>port</h4><p>端口：如8080,9090</p><h4 id="open"><a href="#open" class="headerlink" title="open"></a>open</h4><p>是否打开默认浏览器，如果配置了open，在run start之后会打开默认浏览器，也可以在命令行  –open</p><h4 id="contentBase"><a href="#contentBase" class="headerlink" title="contentBase"></a>contentBase</h4><p>配置devServer，Http服务器的文件根目录</p><h4 id="proxy配置代理，处理本地跨域，"><a href="#proxy配置代理，处理本地跨域，" class="headerlink" title="proxy配置代理，处理本地跨域，"></a>proxy配置代理，处理本地跨域，</h4><h4 id="pathRewrite"><a href="#pathRewrite" class="headerlink" title="pathRewrite"></a>pathRewrite</h4><p>这个的应用场景是，比如项目里面写了个a.json，突然接口有问题需要换到测试接口b.json，就用这个代理<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">devServer: &#123;</div><div class="line">contentBase: <span class="string">'./dist'</span>,</div><div class="line">open: <span class="literal">true</span>,</div><div class="line">port: <span class="number">8090</span>,</div><div class="line">hot: <span class="literal">true</span>,</div><div class="line">historyApiFallback: <span class="literal">true</span>,</div><div class="line">proxy: &#123;</div><div class="line"><span class="string">'/react/api'</span>: &#123;</div><div class="line">target: <span class="string">'http://hhardyy.com'</span>,</div><div class="line">pathRewrite: &#123;</div><div class="line"><span class="string">'a.json'</span>: <span class="string">'b.json'</span></div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;,</div></pre></td></tr></table></figure></p><p>devServer.historyApiFallback，   解决单页面应用无法跳转的问题，比如Route 的path=/list ,localhost:8080/list打不开</p><h3 id="HotModuleReplacementPlugin"><a href="#HotModuleReplacementPlugin" class="headerlink" title="HotModuleReplacementPlugin"></a>HotModuleReplacementPlugin</h3><p>这个插件css修改了也不会重新渲染刷新整个页面，只是把css即时修改<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> webpack= <span class="built_in">require</span>(<span class="string">'webpack'</span>)</div><div class="line">plugins:[</div><div class="line">    <span class="keyword">new</span> webpack.HotModuleReplacementPlugin()</div><div class="line">]</div></pre></td></tr></table></figure></p><h3 id="两种配置bable的方案"><a href="#两种配置bable的方案" class="headerlink" title="两种配置bable的方案"></a>两种配置bable的方案</h3><h4 id="一"><a href="#一" class="headerlink" title="一"></a>一</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">test: <span class="regexp">/\.js$/</span>,</div><div class="line">exclude: <span class="regexp">/node_modules/</span>,</div><div class="line">loader: <span class="string">'babel-loader'</span>,</div><div class="line">options: &#123;</div><div class="line">presets: [[</div><div class="line"><span class="string">'@babel/preset-env'</span>,         <span class="comment">//需要在index.js中去import "@babel/polyfill";</span></div><div class="line">&#123;</div><div class="line"> targets: &#123;</div><div class="line">        edge: <span class="string">"17"</span>,</div><div class="line">        firefox: <span class="string">"60"</span>,</div><div class="line">        chrome: <span class="string">"67"</span>,</div><div class="line">       safari: <span class="string">"11.1"</span>,</div><div class="line">     &#125;,</div><div class="line"> useBuiltIns: <span class="string">'usage'</span>                     <span class="comment">//配置了这个的话，代码里面不用单独引入babel-polifill，它已经自动安装了</span></div><div class="line"> &#125;</div><div class="line">    ]]</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="二"><a href="#二" class="headerlink" title="二"></a>二</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="string">"plugins"</span>: [</div><div class="line">    [</div><div class="line">      <span class="string">"@babel/plugin-transform-runtime"</span>,</div><div class="line">      &#123;</div><div class="line">        <span class="string">"absoluteRuntime"</span>: <span class="literal">false</span>,</div><div class="line">        <span class="string">"corejs"</span>: <span class="literal">false</span>,</div><div class="line">        <span class="string">"helpers"</span>: <span class="literal">true</span>,</div><div class="line">        <span class="string">"regenerator"</span>: <span class="literal">true</span>,</div><div class="line">        <span class="string">"useESModules"</span>: <span class="literal">false</span></div><div class="line">      &#125;</div><div class="line">    ]</div><div class="line">  ]</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="three-shaking"><a href="#three-shaking" class="headerlink" title="three shaking"></a>three shaking</h3><p>顾名思义是摇树的意思：将一些模块中引入不用的方法摇掉，只支持import使用，因为import的底层是静态引入的方式，commonjs是动态引入的方式，开发环境（mode:development）使用three shaking要加上<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">optimization:&#123;</div><div class="line">    usedExports: <span class="literal">true</span>     <span class="comment">//哪些模块被使用了再做打包 </span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>package.json加上<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">"sideEffects"</span>:<span class="literal">false</span></div></pre></td></tr></table></figure></p><p>假如在某个js文件内import “@babel/polly-fill”,那three<br>shaking发现它没有导出模块，在打包的时候会被忽略掉，但是需要使用里头的东西，为了避免打包错误，需要添加这个配置<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">"sideEffects"</span>:[<span class="string">"@babel/polly-fill"</span>]</div></pre></td></tr></table></figure></p><p>false的意思是对所有的模块都进行three shaking，没有特殊处理的模块.一般如果在模块中导入了css文件，three shaking会去检测有没有模块导出，所以一般sideEffects会配置[“*.css”]</p><p>在开发环境下three shaking不会去删除没有用到的模块，因为在开发环境需要调试，如果打包上线的话three shaking其实自动就配置好了，甚至都不需要写three shaking配置。</p><h3 id="HMR模块热替换"><a href="#HMR模块热替换" class="headerlink" title="HMR模块热替换"></a>HMR模块热替换</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> webpack.HotModuleReplacementPlugin()   <span class="comment">//启用 webpack 内置的 HMR插件</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="built_in">module</span>.hot) &#123;</div><div class="line">    <span class="built_in">module</span>.hot.accept(<span class="string">'./print.js'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">//告诉 webpack 接受热替换的模块</span></div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'Accepting the updated printMe module!'</span>);</div><div class="line">        printMe();</div><div class="line">    &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="性能优化"><a href="#性能优化" class="headerlink" title="性能优化"></a>性能优化</h3><h4 id="code-splitting"><a href="#code-splitting" class="headerlink" title="code splitting"></a>code splitting</h4><p>代码分割<br>同步代码：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">optimization: &#123;</div><div class="line">   splitChunks: &#123;</div><div class="line">       chunks: <span class="string">'all'</span></div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>异步代码：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install --save-dev @babel/plugin-syntax-dynamic-<span class="keyword">import</span></div></pre></td></tr></table></figure></p><p>.babelrc<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">plugins:[<span class="string">"dynamic-import-webpack"</span>]</div></pre></td></tr></table></figure></p><p>index.js<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getComponent</span>(<span class="params"></span>) </span>&#123;</div><div class="line"><span class="keyword">return</span> <span class="keyword">import</span>(<span class="comment">/*webpackChunkName:"lodash"*/</span><span class="string">'lodash'</span>).then((&#123;</div><div class="line"><span class="keyword">default</span>: _</div><div class="line">&#125;) =&gt; &#123;</div><div class="line"><span class="keyword">let</span> element = <span class="built_in">document</span>.createElement(<span class="string">'div'</span>)</div><div class="line">element.innerHTML = _.join([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>], <span class="string">'***'</span>)</div><div class="line"><span class="keyword">return</span> element</div><div class="line">&#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line">getComponent().then(<span class="function"><span class="params">element</span> =&gt;</span> &#123;</div><div class="line"><span class="built_in">document</span>.body.appendChild(element)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p><h4 id="webapck分析工具"><a href="#webapck分析工具" class="headerlink" title="webapck分析工具"></a>webapck分析工具</h4><p><a href="github.com/webpack/analyse">git仓库</a><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">--profile --json &gt; stats.json     <span class="comment">//把打包过程的一些解释放到一个json文件里</span></div></pre></td></tr></table></figure></p><p>打包分析： <a href="https://webpack.js.org/guides/code-splitting/#bundle-analysis" target="_blank" rel="external">https://webpack.js.org/guides/code-splitting/#bundle-analysis</a></p><h4 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h4><p>在首屏主要代码加载完毕然后释放出网络之后再去加载模态框等其他代码用Prefetching  /  Preloading modules，<br>前端性能优化的时候，缓存其实不是最主要的点，而最主要的点应该是放到代码覆盖率上</p><h4 id="css代码分割"><a href="#css代码分割" class="headerlink" title="css代码分割"></a>css代码分割</h4><p><a href="https://webpack.js.org/plugins/mini-css-extract-plugin/#root" target="_blank" rel="external">可以看一下这里</a><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">output: &#123;</div><div class="line">filename: <span class="string">'[name].js'</span>,</div><div class="line">chunkFilename: <span class="string">'[name].chunk.js'</span>,        <span class="comment">//加上这个，然后用上下面的插件</span></div><div class="line">path: path.resolve(__dirname, <span class="string">'../dist'</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line">plugins  : MiniCssExtractPlugin</div></pre></td></tr></table></figure></p><p>例如在index.js里面import 1.css和import 2.css,跑起来的时候就会将1.css和2.css合并到main.css里面，<br>只能用在生产环境，因为不支持HMR，用在开发环境的话会影响开发效率。</p><h4 id="css代码压缩"><a href="#css代码压缩" class="headerlink" title="css代码压缩"></a>css代码压缩</h4><p>用optimize-css-assets-webpack-plugin这个插件<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install optimize-css-assets-webpack-plugin -D</div></pre></td></tr></table></figure></p><p>使用方法：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> OptimizeCSSAssetsPlugin = <span class="built_in">require</span>(<span class="string">'optimize-css-assets-webpack-plugin'</span>);</div><div class="line">optimization: &#123;</div><div class="line">minimizer: [<span class="keyword">new</span> OptimizeCSSAssetsPlugin(&#123;&#125;)],</div><div class="line">&#125;,</div></pre></td></tr></table></figure></p><p>假如要把index.js和index1.js和indexn.js中引用的css文件单独分割到styles文件里面<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">optimization:&#123;</div><div class="line">    splitChunks: &#123;</div><div class="line">cacheGroups: &#123;</div><div class="line">  styles: &#123;</div><div class="line">name: <span class="string">'styles'</span>,</div><div class="line">test: <span class="regexp">/\.css$/</span>,</div><div class="line">chunks: <span class="string">'all'</span>,</div><div class="line">enforce: <span class="literal">true</span>,      <span class="comment">//忽略掉所有默认配置</span></div><div class="line">  &#125;,</div><div class="line">&#125;,</div><div class="line">  &#125;,</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>performance:false    //不让提示性能上的问题</p><h4 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h4><p>每次webpack打包的文件放到服务器，第二次请求服务器会默认请求缓存<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">output: &#123;</div><div class="line">filename: <span class="string">'[name].[contenthash].js'</span>,</div><div class="line">chunkFilename: <span class="string">'[name].[contenthash].js'</span>,</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>这么配置之后如果源代码没有改变，那么打包生成的cantenthash永远不变，根据content产生的hash字符串,老版本webpack如果发现没改变代码但是打包的hash值不一样，这时候需要做额外配置<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">optimization: &#123;</div><div class="line">runtimeChunk: &#123;</div><div class="line">name: <span class="string">'runtime'</span></div><div class="line">&#125;,</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>在用webpack打包的时候，main.js放的是业务逻辑，vendors放的是用的库，比如jquery，然后main.js和vendors其实是有关联的，处理这些关联的内置代码是manifest,默认存在两个文件里面，它在每次打包的时候在旧版有差异，正是这些差异导致在打包的时候虽然没有改动源代码，但是两个文件里面的manifest实际上已经跟着变了。</p><h3 id="shimming的作用"><a href="#shimming的作用" class="headerlink" title="shimming的作用"></a>shimming的作用</h3><p>比如在index.js文件里<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> $ <span class="keyword">from</span> <span class="string">'jquery'</span></div><div class="line"><span class="keyword">import</span> &#123; ui &#125; <span class="keyword">from</span> <span class="string">'jquery.ui.js'</span></div></pre></td></tr></table></figure></p><p>其中jquery.ui.js<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">ui</span>(<span class="params"></span>)</span>&#123;</div><div class="line">   $(<span class="string">'body'</span>).css(<span class="string">'background'</span>,<span class="string">'red'</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>打包之后会报错说$未定义，因为每个模块只能使用模块内部的代码,那如果有一个库，又想用又不能修改内部的代码，就可以利用webpack自带的api<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> webpack <span class="keyword">from</span> <span class="string">'webpack'</span></div><div class="line">plugins:[</div><div class="line">    <span class="keyword">new</span> webpack.ProviderPlugin(&#123;</div><div class="line">        $:jquery</div><div class="line">    &#125;)</div><div class="line">]</div></pre></td></tr></table></figure></p><p>意思就是模块内发现使用$的时候，就自动引入jquery</p><h3 id="模块this"><a href="#模块this" class="headerlink" title="模块this"></a>模块this</h3><p>如果想让加载的模块this指向window而不是自己（默认指向自己）<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install imports-loader --save-dev</div></pre></td></tr></table></figure></p><p>然后再在test 的.js文件使用loader<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">test:<span class="regexp">/\.js$/</span>,</div><div class="line">exclude:<span class="regexp">/node_modules/</span>,</div><div class="line">use:[</div><div class="line">    &#123;</div><div class="line">       loader:<span class="string">'babel-loader'</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">       loader:<span class="string">'imports-loader?this=&gt;window'</span></div><div class="line">    &#125;</div><div class="line">]</div></pre></td></tr></table></figure></p><h3 id="全局变量"><a href="#全局变量" class="headerlink" title="全局变量"></a>全局变量</h3><p>如何在webpack打包的过程中使用全局变量<br>分两个环境<br>webpack.prod.js  ＆＆　webpack.dev.js  &amp;&amp; webpack.comm.js(公共配置)<br>1、module.exports = prodConfig<br>2、module.exports = devConfig<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> merge = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>)</div><div class="line"><span class="keyword">let</span> commConfig = &#123;</div><div class="line">   ...公共webpack配置</div><div class="line">&#125;</div><div class="line"><span class="built_in">module</span>.exports = <span class="function">(<span class="params">env</span>)=&gt;</span>&#123;</div><div class="line">   <span class="keyword">if</span>( env &amp;&amp; env.production === <span class="string">'hardy'</span> )&#123;</div><div class="line">       <span class="keyword">return</span> merge(commConfig, prodConfig)</div><div class="line">   &#125;<span class="keyword">else</span>&#123;</div><div class="line">       <span class="keyword">return</span> merge(commConfig, devConfig)</div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>env是package.json传入的全局变量，例如package.json里头的打包命令设置为<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">"dev"</span>:<span class="string">"webpack-dev-server --config ./build/webpack.comm.js"</span></div><div class="line"><span class="string">"build"</span> : <span class="string">"webpack --env.production==='hardy' --config ./build/webpack.comm.js"</span></div></pre></td></tr></table></figure></p><h3 id="如何开发一个库"><a href="#如何开发一个库" class="headerlink" title="如何开发一个库"></a>如何开发一个库</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">output: &#123;</div><div class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>),</div><div class="line">    filename: <span class="string">'library.js'</span>,</div><div class="line">    library:<span class="string">'library'</span>,</div><div class="line">    libraryTarget: <span class="string">'umd'</span>   </div><div class="line">&#125;</div></pre></td></tr></table></figure><p>libraryTarget: ‘umd’   =&gt;<br>import library from ‘library.js’   ES6<br>const library = require(‘library’)  Common<br>require([‘library’,function()])   AMD<br> library:’library’ =&gt;支持script引入方式  意思就是打包生成的js文件挂载到页面的全局变量中然后直接library.调用里头的方法</p><h3 id="externals"><a href="#externals" class="headerlink" title="externals"></a>externals</h3><p>可以是字符串，数组，对象<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">externals: [<span class="string">'lodash'</span>]</div></pre></td></tr></table></figure></p><p>防止用户在import 再打包的时候项目中有两个lodash，不过打包之后没有lodash，需要自己引入<br>,就是当lodash被commonjs的方式引入的时候，名字必须是lodash，也就是const lodash = require(‘lodash’),而不能写成const _ = require(‘lodash’)<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">externals: &#123;</div><div class="line">    lodash: &#123;</div><div class="line">        commonjs:<span class="string">'lodash'</span></div><div class="line">    &#125;</div><div class="line">&#125;,</div></pre></td></tr></table></figure></p><p>root的作用是当以script src的方式引入的时候页面上必须注册一个名为_的全局变量<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">externals: &#123;</div><div class="line">    lodash: &#123;</div><div class="line">        root: <span class="string">'_'</span>,      </div><div class="line">        commonjs: <span class="string">'lodash'</span></div><div class="line">    &#125;</div><div class="line">&#125;,</div></pre></td></tr></table></figure></p><h3 id="PWA"><a href="#PWA" class="headerlink" title="PWA"></a>PWA</h3><p>Progressive Web Application    ===    PWA  =&gt;遇到断网的情况下依然可以访问,用户体验更好<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install workbox-webpack-plugin --save-dev</div></pre></td></tr></table></figure></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> workboxWebpackPlugin = <span class="built_in">require</span>(<span class="string">'"workbox-webpack-plugin"'</span>)</div><div class="line"></div><div class="line"><span class="keyword">new</span> workboxWebpackPlugin.GenerateSW(&#123;</div><div class="line">clientsClaim: <span class="literal">true</span>,</div><div class="line">skipWaiting: <span class="literal">true</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure><h3 id="ts打包配置"><a href="#ts打包配置" class="headerlink" title="ts打包配置"></a>ts打包配置</h3><p>打包ts文件的时候，需要在项目根目录下创建一个名为tsconfig.json的文件<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install @types/lodash --save-dev</div></pre></td></tr></table></figure></p><h3 id="eslint"><a href="#eslint" class="headerlink" title="eslint"></a>eslint</h3><p><a href="https://eslint.org/" target="_blank" rel="external">eslint</a><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm install eslint --save-dev</div><div class="line">npx eslint --init</div></pre></td></tr></table></figure></p><p>检测src下面的代码符不符合规范要求<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npx eslint src</div></pre></td></tr></table></figure></p><p>babel-eslint是较常用的eslint解析器，为了避免团队成员使用不同的编辑器导致的eslint检测区别，可以使用eslint-loader<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install eslint-loader --save-dev</div></pre></td></tr></table></figure></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>:&#123;</div><div class="line">    rules:[</div><div class="line">         &#123;</div><div class="line">            test:<span class="regexp">/\.js$/</span>,</div><div class="line">            use:[<span class="string">'babel-loader'</span>,eslint-loader]     <span class="comment">//loader执行顺序从后往左</span></div><div class="line">         &#125;</div><div class="line">    ]</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>加完之后可以在webpack.config.js的devServer加入<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">overlay: <span class="literal">true</span></div></pre></td></tr></table></figure></p><p>这样npm run dev的时候一旦出现eslint的问题，就会在浏览器上弹窗出打包遇到的问题</p><h3 id="webpack性能优化"><a href="#webpack性能优化" class="headerlink" title="webpack性能优化"></a>webpack性能优化</h3><p>提升打包速度</p><h4 id="跟上技术的迭代-升级webpack，npm-yarn-node"><a href="#跟上技术的迭代-升级webpack，npm-yarn-node" class="headerlink" title="跟上技术的迭代   升级webpack，npm|yarn|node"></a>跟上技术的迭代   升级webpack，npm|yarn|node</h4><h4 id="尽可能少的模块使用loader"><a href="#尽可能少的模块使用loader" class="headerlink" title="尽可能少的模块使用loader"></a>尽可能少的模块使用loader</h4><p>将this指向window的配置<br>test:/.js$/,<br>exclude:/node_module/,<br>use:[“import-loader?this=&gt;window”]</p><h4 id="Plugin尽可能精简并确保可靠"><a href="#Plugin尽可能精简并确保可靠" class="headerlink" title="Plugin尽可能精简并确保可靠"></a>Plugin尽可能精简并确保可靠</h4><h4 id="插件DellPlugin提高打包速率"><a href="#插件DellPlugin提高打包速率" class="headerlink" title="插件DellPlugin提高打包速率"></a>插件DellPlugin提高打包速率</h4><p>每次打包的时候比如react，react-dom.lodash的代码都是不会变的，所以只在第一次打包的时候去分析，理想的打包状态<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  entry: &#123;</div><div class="line">    vendors: [<span class="string">'react'</span>, <span class="string">'react-dom'</span>, <span class="string">'lodash'</span>]</div><div class="line">  &#125;,</div><div class="line">  output: &#123;</div><div class="line">    filename: <span class="string">'[name].dell.js'</span>,</div><div class="line">    path: path.resolve(__dirname, <span class="string">'../dell'</span>)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>单独生成的dell下面的vendors.dell.js这么来用<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install add-asset-html-webpack-plugin --save</div></pre></td></tr></table></figure></p><p>这个插件是往html里面再去增加静态资源<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> AddAssetWebpackPlugin(&#123;</div><div class="line">  filepath: path.resolve(__dirname, <span class="string">'../dell/vendors.dell.js'</span>),</div><div class="line">&#125;),</div></pre></td></tr></table></figure></p><p>分析打包文件，然后生成打包的映射<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">entry: &#123;</div><div class="line">    vendors: [<span class="string">'lodash'</span>],</div><div class="line">    react: [<span class="string">'react'</span>, <span class="string">'react-dom'</span>],</div><div class="line">  &#125;,</div></pre></td></tr></table></figure></p><p>DllPlugin生成映射<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> webpack.DllPlugin(&#123;</div><div class="line">  name: <span class="string">'[name]'</span>,</div><div class="line">  path: path.resolve(__dirname, <span class="string">'../dell/[name].manifast.json'</span>),</div><div class="line">&#125;),</div><div class="line"><span class="string">``</span><span class="string">`   </span></div><div class="line"><span class="string">然后配置AddAssetWebpackPlugin，将它加入到html中</span></div><div class="line"><span class="string">`</span><span class="string">``</span>javascript</div><div class="line"><span class="keyword">new</span> AddAssetWebpackPlugin(&#123;</div><div class="line">  filepath: path.resolve(__dirname, <span class="string">'../dell/vendors.dell.js'</span>),</div><div class="line">&#125;),</div><div class="line"><span class="keyword">new</span> AddAssetWebpackPlugin(&#123;</div><div class="line">  filepath: path.resolve(__dirname, <span class="string">'../dell/react.dell.js'</span>),</div><div class="line">&#125;),</div><div class="line"><span class="keyword">new</span> webpack.DllReferencePlugin(&#123;</div><div class="line">  manifest: path.resolve(__dirname, <span class="string">'../dell/vendors.manifast.json'</span>),</div><div class="line">&#125;),</div><div class="line"><span class="keyword">new</span> webpack.DllReferencePlugin(&#123;</div><div class="line">  manifest: path.resolve(__dirname, <span class="string">'../dell/react.manifast.json'</span>),</div><div class="line">&#125;),</div></pre></td></tr></table></figure></p><p>这么配置之后，它会去dell/vendors.manifast.json中查找第三方模块的映射关系，如果能找到就不去打包，直接从vendors.dell.js引入（从全局变量里面拿),当需要分解的文件太多的时候，为了避免每个都要复制，可以用fs来动态加载<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> files = fs.readdirSync(path.resolve(__dirname, <span class="string">'../dell'</span>));</div><div class="line"><span class="keyword">const</span> plugins = [</div><div class="line">  <span class="keyword">new</span> HTMLWebpackPlugin(&#123;</div><div class="line">    template: <span class="string">'./src/index.html'</span>,</div><div class="line">  &#125;),</div><div class="line">];</div><div class="line">files.forEach(<span class="function">(<span class="params">file</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">if</span> (<span class="regexp">/.*\.dell.js/</span>.test(file)) &#123;</div><div class="line">    plugins.push(<span class="keyword">new</span> AddAssetWebpackPlugin(&#123;</div><div class="line">      filepath: path.resolve(__dirname, <span class="string">'../dell'</span>, file),</div><div class="line">    &#125;));</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span> (<span class="regexp">/.*\.manifast.json/</span>.test(file)) &#123;</div><div class="line">    plugins.push(<span class="keyword">new</span> webpack.DllReferencePlugin(&#123;</div><div class="line">      manifest: path.resolve(__dirname, <span class="string">'../dell'</span>, file),</div><div class="line">    &#125;));</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p><p>DellPlugin的打包逻辑就是项目中引入比如jquery,lodash等不会改变的静态资源的时候，就直接根据entry设置的文件名打包到dell目录下然后生成映射，后面每次打包就可以直接去dell目录下加载相关资源，不需要重新打包</p><h4 id="控制包大小"><a href="#控制包大小" class="headerlink" title="控制包大小"></a>控制包大小</h4><h4 id="thread-loader-parallel-webpack-happypack多进程打包（利用node里面的多进程，使用多个cpu）"><a href="#thread-loader-parallel-webpack-happypack多进程打包（利用node里面的多进程，使用多个cpu）" class="headerlink" title="thread-loader,parallel-webpack,happypack多进程打包（利用node里面的多进程，使用多个cpu）"></a>thread-loader,parallel-webpack,happypack多进程打包（利用node里面的多进程，使用多个cpu）</h4><h4 id="合理使用sourceMap"><a href="#合理使用sourceMap" class="headerlink" title="合理使用sourceMap"></a>合理使用sourceMap</h4><h4 id="综合stats分析打包结果"><a href="#综合stats分析打包结果" class="headerlink" title="综合stats分析打包结果"></a>综合stats分析打包结果</h4><h4 id="开发环境内存编译"><a href="#开发环境内存编译" class="headerlink" title="开发环境内存编译"></a>开发环境内存编译</h4><h3 id="打包多页面，"><a href="#打包多页面，" class="headerlink" title="打包多页面，"></a>打包多页面，</h3><p>一般都是单页面，也就是只有一个html的页面，要打包多个页面的时候，在entry里头写两个入口<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">entry:&#123;</div><div class="line">   main:<span class="string">'./src/index.js'</span>,</div><div class="line">   list:<span class="string">'./src/list.js'</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>然后可以去github上查找html-webpack-plugin的配置项,或者往上翻<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> HTMLWebpackPlugin(&#123;</div><div class="line">template: <span class="string">'./src/index.html'</span>,</div><div class="line">filename: <span class="string">'index.html'</span>,</div><div class="line">chunks: [<span class="string">'runtime'</span>, <span class="string">'vendors'</span>, <span class="string">'main'</span>],</div><div class="line">&#125;),</div><div class="line"><span class="keyword">new</span> HTMLWebpackPlugin(&#123;</div><div class="line">template: <span class="string">'./src/index.html'</span>,</div><div class="line">filename: <span class="string">'list.html'</span>,</div><div class="line">chunks: [<span class="string">'runtime'</span>, <span class="string">'vendors'</span>, <span class="string">'list'</span>],</div><div class="line">&#125;),</div><div class="line">...</div></pre></td></tr></table></figure></p><p>如果觉得每次这样复制不太友好，可以用封装一个函数来解决<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> makePlagins = <span class="function">(<span class="params">configs</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">const</span> plugins = [</div><div class="line">    <span class="comment">// new CleanWebpackPlugin(['dist'], &#123;</span></div><div class="line">    <span class="comment">//   root: path.resolve(__dirname, '../'),</span></div><div class="line">    <span class="comment">// &#125;),</span></div><div class="line">  ];</div><div class="line"></div><div class="line">  <span class="keyword">const</span> keys = <span class="built_in">Object</span>.keys(configs.entry);</div><div class="line">  keys.forEach(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</div><div class="line">    plugins.push(</div><div class="line">      <span class="keyword">new</span> HTMLWebpackPlugin(&#123;</div><div class="line">        template: <span class="string">'./src/index.html'</span>,</div><div class="line">        filename: <span class="string">`<span class="subst">$&#123;item&#125;</span>.html`</span>,</div><div class="line">        chunks: [<span class="string">'runtime'</span>, <span class="string">'vendors'</span>, item],</div><div class="line">      &#125;),</div><div class="line">    );</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  <span class="keyword">const</span> files = fs.readdirSync(path.resolve(__dirname, <span class="string">'../dell'</span>));</div><div class="line">  files.forEach(<span class="function">(<span class="params">file</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">if</span> (<span class="regexp">/.*\.dell.js/</span>.test(file)) &#123;</div><div class="line">      plugins.push(<span class="keyword">new</span> AddAssetWebpackPlugin(&#123;</div><div class="line">        filepath: path.resolve(__dirname, <span class="string">'../dell'</span>, file),</div><div class="line">      &#125;));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (<span class="regexp">/.*\.manifast.json/</span>.test(file)) &#123;</div><div class="line">      plugins.push(<span class="keyword">new</span> webpack.DllReferencePlugin(&#123;</div><div class="line">        manifest: path.resolve(__dirname, <span class="string">'../dell'</span>, file),</div><div class="line">      &#125;));</div><div class="line">    &#125;</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> plugins;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p><p>在这个操作之前先将<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports=&#123;</div><div class="line">    entry:&#123;</div><div class="line">        ....</div><div class="line">    &#125;,</div><div class="line">    output:&#123;</div><div class="line">        ...</div><div class="line">    &#125;,</div><div class="line">    plugins:&#123;</div><div class="line">        ...</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>改成<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> configs=&#123;</div><div class="line">    entry:&#123;</div><div class="line">        ....</div><div class="line">    &#125;,</div><div class="line">    output:&#123;</div><div class="line">        ...</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>configs.plugins = makePlagins(configs)<br>这样就可以实现动态改变打包的入口文件就可以生成新的一个页面</p><h3 id="如何编写一个loader"><a href="#如何编写一个loader" class="headerlink" title="如何编写一个loader"></a>如何编写一个loader</h3><p><a href="https://www.webpackjs.com/api/" target="_blank" rel="external">webpack API</a><br>写一个loader来做异常捕获<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> loaderUtils = <span class="built_in">require</span>(<span class="string">'loader-utils'</span>)</div><div class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">source</span>) </span>&#123;</div><div class="line">  <span class="comment">//异常捕获start</span></div><div class="line">  <span class="keyword">try</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"></div><div class="line">  &#125;).catch(e)&#123;&#125;</div><div class="line">  <span class="comment">//异常捕获end</span></div><div class="line"></div><div class="line">  <span class="keyword">const</span> options = loaderUtils.getOptions(<span class="keyword">this</span>)</div><div class="line">  <span class="keyword">const</span> callback = <span class="keyword">this</span>.async()</div><div class="line"></div><div class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">const</span> result = source.replace(<span class="string">'hardy'</span>, options.name)</div><div class="line">    callback(<span class="literal">null</span>, result)</div><div class="line">  &#125;, <span class="number">1000</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>也可以用来写国际化<br>比如业务代码index.js中<br>console.log(‘webpack4.x‘)<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">loader里头这么写</div><div class="line"><span class="keyword">const</span> loaderUtils = <span class="built_in">require</span>(<span class="string">'loader-utils'</span>)</div><div class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">source</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (node全局变量 === <span class="string">'中文'</span>) &#123;</div><div class="line">    source.replace(<span class="string">'&#123;&#123;title&#125;&#125;'</span>, <span class="string">'中文标题'</span>)</div><div class="line">  &#125; <span class="keyword">else</span> &#123; </div><div class="line">    source.replace(<span class="string">'&#123;&#123;title&#125;&#125;'</span>,<span class="string">'english title'</span>)</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">const</span> options = loaderUtils.getOptions(<span class="keyword">this</span>)</div><div class="line">  <span class="keyword">const</span> callback = <span class="keyword">this</span>.async()</div><div class="line"></div><div class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">const</span> result = source.replace(<span class="string">'hardy'</span>, options.name)</div><div class="line">    callback(<span class="literal">null</span>, result)</div><div class="line">  &#125;, <span class="number">1000</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><h3 id="编写一个plugin"><a href="#编写一个plugin" class="headerlink" title="编写一个plugin"></a>编写一个plugin</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="string">"scripts"</span>: &#123;</div><div class="line">   <span class="string">"debug"</span>: <span class="string">"node --inspect --inspect-brk node_modules/webpack/bin/webpack.js"</span>,   <span class="comment">//使用node的调试工具调试插件，--inspect开启调试工具，--inspect-brk在第一行打断点</span></div><div class="line">   <span class="string">"build"</span>: <span class="string">"webpack"</span></div><div class="line"> &#125;,</div></pre></td></tr></table></figure><p>最近拿了新offer，今天也是国庆，祖国70周年的生日！！！</p><p>分享一张觉得拍的不错的美图。<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/webpack/1.jpg" alt="红线" title="">                </div>                <div class="image-caption">红线</div>            </figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;webpack4.x =&amp;gt; vue.config.js但是 !== vue.config.js&lt;/p&gt;
&lt;p&gt;&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;//music.163.com/outchain/player?type=2&amp;id=1369794434&amp;auto=0&amp;height=66&quot;&gt;&lt;/iframe&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="webpack" scheme="http://yoursite.com/tags/webpack/"/>
    
  </entry>
  
  <entry>
    <title>Vue+echarts+vant demo</title>
    <link href="http://yoursite.com/2019/08/31/vue-echarts-vant-demo/"/>
    <id>http://yoursite.com/2019/08/31/vue-echarts-vant-demo/</id>
    <published>2019-08-31T09:21:30.000Z</published>
    <updated>2019-08-31T09:38:51.700Z</updated>
    
    <content type="html"><![CDATA[<p>简单弄了一个比较粗糙的东西</p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=528283&auto=0&height=66"></iframe><p>它长这样<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/vue_echarts_vant/gif.gif" alt="show" title="">                </div>                <div class="image-caption">show</div>            </figure><br>它在我的github上，喜欢可以点个star<br><a href="https://github.com/HHardyy/vue-ecahrts-vant" target="_blank" rel="external">https://github.com/HHardyy/vue-ecahrts-vant</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;简单弄了一个比较粗糙的东西&lt;/p&gt;
&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;//music.163.com/outch
      
    
    </summary>
    
    
      <category term="vue" scheme="http://yoursite.com/tags/vue/"/>
    
      <category term="echarts" scheme="http://yoursite.com/tags/echarts/"/>
    
      <category term="vant" scheme="http://yoursite.com/tags/vant/"/>
    
      <category term="组件" scheme="http://yoursite.com/tags/%E7%BB%84%E4%BB%B6/"/>
    
  </entry>
  
  <entry>
    <title>react-native</title>
    <link href="http://yoursite.com/2019/08/22/%E4%BB%8E%E6%97%A0%E5%88%B0%E6%9C%89%E8%B7%91%E4%B8%80%E4%B8%AAreact-native/"/>
    <id>http://yoursite.com/2019/08/22/从无到有跑一个react-native/</id>
    <published>2019-08-22T14:30:39.000Z</published>
    <updated>2020-01-13T15:29:13.895Z</updated>
    
    <content type="html"><![CDATA[<p>因为最近老大突然提到了原生app开发，所以我。。。</p><p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=28535311&auto=0&height=66"></iframe><br><a id="more"></a></p><p>所以我想到了react-native、flutter当然还有uni-app，当然这些写出来的app不能直接和原生比，而是只是接近原生的渲染机制，我和一个做了几年安卓原生的前辈交谈过，他认为这种机制更偏向于做一些数据渲染的应用，如果太多动画的话是跟不上原生安卓的体验的。</p><p>在做任何东西之前，先要搭建环境，即使是强无敌的jquery也要先下载jquery源码或者去BootSDN等引外链</p><h3 id="开发的平台"><a href="#开发的平台" class="headerlink" title="开发的平台"></a>开发的平台</h3><p>macOS || Windows || Linux =&gt; iOS || Android</p><h3 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h3><p>搭建之前温馨提示几点：<br>1、需要全程保持“科学上网”，否则能ERROR或者跳网址到你怀疑人生<br>2、因为环境需要，npm的镜像可以设置成淘宝的镜像，否则还是要依赖“科学上网工具”<br>3、不要使用 cnpm！cnpm 安装的模块路径比较奇怪，packager 不能正常识别！<br>4、Node的版本必须大于等于10<br>5、Python的版本必须为 2.x（不支持 3.x）<br>6、JDK的版本必须是1.8（我用的1.7，目前不支持 1.9 及更高版本）。</p><h4 id="必须安装的依赖"><a href="#必须安装的依赖" class="headerlink" title="必须安装的依赖"></a>必须安装的依赖</h4><p>有：Node、React Native命令行工具、Python2 以及JDK和Android Studio（虽然你可以使用任何编辑器来开发应用，但你仍然必须安装 Android Studio来获得编译 Android 应用所需的工具和环境。）</p><p>Node安装是每个前端的标配（略），安装完成后用node -v查看版本号</p><p>Yarn是Facebook提供的替代npm的工具，可以加速node模块的下载。React Native的命令行工具用于执行创建、初始化、更新项目、运行打包服务（packager）等任务。安装命令：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g yarn react-native-cli</div></pre></td></tr></table></figure></p><p>yarn的镜像也可以设置成淘宝镜像<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">yarn config set registry https:<span class="comment">//registry.npm.taobao.org --global</span></div><div class="line">yarn config set disturl https:<span class="comment">//npm.taobao.org/dist --global</span></div></pre></td></tr></table></figure></p><h4 id="Android开发环境"><a href="#Android开发环境" class="headerlink" title="Android开发环境"></a>Android开发环境</h4><blockquote><p>请注意！！！国内用户必须必须必须有稳定的翻墙工具，否则在下载、安装、配置过程中会不断遭遇链接超时或断开，无法进行开发工作。某些翻墙工具可能只提供浏览器的代理功能，或只针对特定网站代理等等，请自行研究配置或更换其他软件。总之如果报错中出现有网址，那么 99% 就是无法正常翻墙。</p></blockquote><p><a href="https://developer.android.com/studio/index.html" target="_blank" rel="external">安装Android Studio</a>,如果科学上网不了的话，即使有安装包安装过程也极大概率出问题，所以这一步先科学上网再继续<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">安装界面中选择<span class="string">"Custom"</span>选项，确保选中了以下几项：</div><div class="line">Android SDK</div><div class="line">Android SDK Platform</div><div class="line">Performance (Intel ® HAXM) </div><div class="line">Android Virtual Device</div></pre></td></tr></table></figure></p><p>然后点击”Next”来安装选中的组件。(如果选择框是灰的，你也可以先跳过，稍后再来安装这些组件。),看到欢迎界面就是安装完成了，然后继续下一步</p><h4 id="安装-Android-SDK"><a href="#安装-Android-SDK" class="headerlink" title="安装 Android SDK"></a>安装 Android SDK</h4><blockquote><p>Android Studio默认会安装最新版本的Android SDK。目前编译React Native应用需要的是Android 9(Pie)版本的SDK（注意 SDK 版本不等于终端系统版本，RN目前支持android4.1 以上设备）。你可以在Android Studio的 SDK Manager中选择安装各版本的SDK。</p></blockquote><p>在上面那一步安裝完成的Android Studio的欢迎界面中找到SDK Manager。点击”Configure”，然后就能看到”SDK Manager”。（SDK Manager还可以在Android Studio 的”Preferences”菜单中找到。具体路径是Appearance &amp; Behavior → System Settings → Android SDK。）</p><p>在SDK Manager中选择”SDK Platforms”选项卡，然后在右下角勾选”Show Package Details”。展开Android 9 (Pie)选项，确保勾选了下面这些组件（再次提醒你需要科学上网工具，否则看不到接下来的界面）：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Android SDK Platform <span class="number">28</span></div><div class="line">Intel x86 Atom_64 System Image（官方模拟器镜像文件，使用非官方模拟器不需要安装此组件）</div></pre></td></tr></table></figure></p><p>然后点击”SDK Tools”选项卡，同样勾中右下角的”Show Package Details”。展开”Android SDK Build-Tools”选项，确保选中了React Native 所必须的28.0.3版本。你可以同时安装多个其他版本。</p><p>最后点击”Apply”来下载和安装这些组件。</p><h4 id="配置系统环境变量"><a href="#配置系统环境变量" class="headerlink" title="配置系统环境变量"></a>配置系统环境变量</h4><blockquote><p>React Native 需要通过环境变量来了解你的 Android SDK 装在什么路径，从而正常进行编译。</p></blockquote><p>在系统的环境变量创建一个名为ANDROID_HOME的环境变量（用户变量也可以），指向你的Android SDK所在的目录，也就是C:\你的电脑用户名\AppData\Local\Android\Sdk，这是Android Sdk默认的安装目录（不信的话可以在Android Studio的”Preferences”菜单中查看SDK的路径，具体是Appearance &amp; Behavior → System Settings → Android SDK。弄好之后关闭当前的命令行工具重新打开，新配置的环境变量才生效</p><h4 id="platform-tools目录添加到环境变量Path中"><a href="#platform-tools目录添加到环境变量Path中" class="headerlink" title="platform-tools目录添加到环境变量Path中"></a>platform-tools目录添加到环境变量Path中</h4><p>这个目录默认的路径是c:\Users\你的用户名\AppData\Local\Android\Sdk\platform-tools</p><p>做好了上面这些，接下来就可以开始你想做的了，就是建个项目跑一跑，其实只要上面的那些环境建好了，接下来的步骤都比较顺畅<br>创建一个react-native的项目<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">react-native init AwesomeProject</div></pre></td></tr></table></figure></p><blockquote><p>可以使用–version参数（注意是两个杠）创建指定版本的项目。例如react-native init MyApp –version 0.44.3。注意版本号必须精确到两个小数点。Windows 用户请注意，请不要在某些权限敏感的目录例如 System32 目录中 init 项目！会有各种权限限制导致不能运行！</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/rn/11.png" alt="建好的目录结构是这样的" title="">                </div>                <div class="image-caption">建好的目录结构是这样的</div>            </figure><p>创建好项目之后就可以运行了，运行的顺序也很讲究<br>1、启动Android Studio打开项目文件下面的android下面的app，然后Create Virtual Device创建一台虚拟安卓设备，然后开机<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/rn/1.png" alt="Android Studio" title="">                </div>                <div class="image-caption">Android Studio</div>            </figure><br>2、打开了安卓虚拟设备之后启动项目<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd AwesomeProject</div><div class="line">react-<span class="keyword">native</span> run-android</div></pre></td></tr></table></figure></p><p>如果配置没有问题，你应该可以看到应用自动安装到设备上并开始运行。第一次运行时需要下载大量编译依赖，耗时比较久。此过程严重依赖稳定的翻墙工具，否则将频繁遭遇链接超时和断开，导致无法运行。</p><p>如果运行之后安卓设备打开的界面是爆红的错误，请执行一个npm install将缺失的一些依赖安装上，然后执行react-native start启动项目<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/rn/2.png" alt="start" title="">                </div>                <div class="image-caption">start</div>            </figure><br>然后在Android Studio上点击编译并执行的绿色三角按钮，将app跑起来<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/rn/2.jpg" alt="run" title="">                </div>                <div class="image-caption">run</div>            </figure></p><p>那项目跑起来之后如何去修改里面的程序，写成自己想要的呢，其实和react一样，它的入口组件也是App.js,简单举个例子，我们改掉里面的小部分内容，其他就保留原样展示<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/rn/code1.png" alt="code1" title="">                </div>                <div class="image-caption">code1</div>            </figure><br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/rn/code2.png" alt="code2" title="">                </div>                <div class="image-caption">code2</div>            </figure><br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/rn/code3.png" alt="code3" title="">                </div>                <div class="image-caption">code3</div>            </figure><br>代码改动之后，重新编译然后启动发现app界面的内容没有变化的话，你可能会运行react-native run-android，让它重新打包，接着再react-native start启动，然后发现，App界面还是没有更新。这时候可以执行一下这个命令再启动项目<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">react-native bundle --platform android --dev <span class="literal">false</span> --entry-file index.js --bundle-output android/app/src/main/assets/index.android.bundle --assets-dest android/app/src/main/res/</div></pre></td></tr></table></figure></p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/rn/reset.png" alt="也就是这样" title="">                </div>                <div class="image-caption">也就是这样</div>            </figure><p>如果有index.android.js，那么可以这样做：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">react-native bundle --platform android --dev <span class="literal">false</span> --entry-file index.android.js --bundle-output android/app/src/main/assets/index.android.bundle --assets-dest android/app/src/main/res/</div></pre></td></tr></table></figure></p><p>之后再运行react-native start，修改的内容就更新了<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/rn/end.png" alt="App" title="">                </div>                <div class="image-caption">App</div>            </figure><br>最后再解释一下这个项目的目录结构</p><table><thead><tr><th>名称</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td>android</td><td style="text-align:center">Android项目目录，包含了使用AndroidStudio开发项目的环境配置文件</td></tr><tr><td>ios</td><td style="text-align:center">iOS项目目录，包含了XCode的环境</td></tr><tr><td>node_modules</td><td style="text-align:center">基于node文件依赖系统产生的相关依赖和第三方lib</td></tr><tr><td>index.js</td><td style="text-align:center">ios或android的入口，已经使用index.js代替index.ios.js/index.android.js，android中配置application文件的getJSMainModuleName()配置入口</td></tr><tr><td>app.json</td><td style="text-align:center">app的json文件</td></tr><tr><td>package.json</td><td style="text-align:center">项目基本信息以及依赖信息</td></tr><tr><td>package-lock.json</td><td style="text-align:center">npm install生成的文件，记录当前npm package的信息</td></tr><tr><td>App.js</td><td style="text-align:center">相当于Android的MainActivity，可以根据自己的需要进行修改或者删除（同时要修改index.js的注册的组件入口js文件名）</td></tr><tr><td>.babelrc</td><td style="text-align:center">Babel配置文件，在.babelrc配置文件中，主要是对预设（presets）和插件（plugins）进行配置，因此不同的转译器作用不同的配置项</td></tr><tr><td>.buckconfig</td><td style="text-align:center">Buck的配置文件，buck是Facebook开源的高效构建系统</td></tr><tr><td>.flowconfig</td><td style="text-align:center">Flow的配置文件，flowconfig是是Flow的配置文件</td></tr><tr><td>.gitattributes</td><td style="text-align:center">git配置文件，指定非文本文件的对比合并方式</td></tr><tr><td>.gitignore</td><td style="text-align:center">git配置文件，用于忽略你不想提交到Git上的文件</td></tr><tr><td>.watchmanconfig</td><td style="text-align:center">watchman的配置文件，watchman用于监控文件变化，辅助实现工程修改信息</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;因为最近老大突然提到了原生app开发，所以我。。。&lt;/p&gt;
&lt;p&gt;&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;//music.163.com/outchain/player?type=2&amp;id=28535311&amp;auto=0&amp;height=66&quot;&gt;&lt;/iframe&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="react-native" scheme="http://yoursite.com/tags/react-native/"/>
    
      <category term="Node" scheme="http://yoursite.com/tags/Node/"/>
    
      <category term="Python2" scheme="http://yoursite.com/tags/Python2/"/>
    
      <category term="JDK" scheme="http://yoursite.com/tags/JDK/"/>
    
      <category term="Android Studio" scheme="http://yoursite.com/tags/Android-Studio/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript常见设计模式</title>
    <link href="http://yoursite.com/2019/08/04/JavaScript%E5%B8%B8%E8%A7%81%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    <id>http://yoursite.com/2019/08/04/JavaScript常见设计模式/</id>
    <published>2019-08-03T19:05:36.000Z</published>
    <updated>2020-01-13T15:19:02.243Z</updated>
    
    <content type="html"><![CDATA[<p>javascript常见设计模式</p><p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=562613275&auto=0&height=66"></iframe><br><a id="more"></a></p><h3 id="单例模式"><a href="#单例模式" class="headerlink" title="单例模式"></a>单例模式</h3><p>单例就是保证一个类只有一个实例，实现的方法一般是先判断实例存在与否，如果存在直接返回，如果不存在就创建了再返回，这就确保了一个类只有一个实例对象。在js中，单例作为一个命名<br>空间提供者，从全局命名空间里提供一个唯一的访问点来访问该对象。</p><blockquote><p>比如你买了个新房子，房子如果没有门，就创建一个门，如果有门就可以直接从门走出去，每个门归属于独立的房号，房间的住户可以通过门进行单例通信</p></blockquote><h4 id="模式作用："><a href="#模式作用：" class="headerlink" title="模式作用："></a>模式作用：</h4><p>1、模块间通信<br>2、系统中某个类的对象只能存在一个<br>3、保护自己的属性和方法</p><h4 id="注意事项："><a href="#注意事项：" class="headerlink" title="注意事项："></a>注意事项：</h4><p>1、注意this的使用<br>2、闭包容易造成内存泄露，不需要的时候干掉<br>3、注意new的成本（继承）<br>举个栗子，页面上6个按钮的分别点击事件，如果用世界上最强的技术$.的话就是这么写<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">'#a'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="comment">//业务逻辑</span></div><div class="line">&#125;)</div><div class="line">$(<span class="string">'#b'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="comment">//业务逻辑</span></div><div class="line">&#125;)</div><div class="line">$(<span class="string">'#c'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="comment">//业务逻辑</span></div><div class="line">&#125;)</div><div class="line">$(<span class="string">'#d'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="comment">//业务逻辑</span></div><div class="line">&#125;)</div><div class="line">$(<span class="string">'#e'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="comment">//业务逻辑</span></div><div class="line">&#125;)</div><div class="line">$(<span class="string">'#f'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="comment">//业务逻辑</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure></p><p>这么写的话，如果每个点击按钮的业务逻辑特别复杂，就乱掉了，而且如果$(‘#a’).click(function(){})里头声明了一个变量a=1,$(‘#b’).click(function(){})里面是不可能接收到的，因为a已经被$(‘#a’)给闭包了，所以如果用单例模式来开发这种代码，应该将它归属于不同的命名空间，比如：<br>a、b、c归属于tag1,d、e、f归属于tag2<br>采用单例的实现方式就是这样<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> tag1=&#123;</div><div class="line">init:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"></div><div class="line">    &#125;,</div><div class="line">    a:<span class="number">1</span>,</div><div class="line">    render:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">let</span> me=<span class="keyword">this</span></div><div class="line">        me.btna=$(<span class="string">'#a'</span>)</div><div class="line">    &#125;,</div><div class="line">    bind:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">let</span> me=<span class="keyword">this</span></div><div class="line">        me.bina.click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">            me.test()</div><div class="line">        &#125;)</div><div class="line">    &#125;,</div><div class="line">    test:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        a=<span class="number">5</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> tag2=&#123;</div><div class="line">init:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"></div><div class="line">    &#125;,</div><div class="line">    a:<span class="number">1</span>,</div><div class="line">    render:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">let</span> me=<span class="keyword">this</span></div><div class="line">        me.btna=$(<span class="string">'#d'</span>)</div><div class="line">    &#125;,</div><div class="line">    bind:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">let</span> me=<span class="keyword">this</span></div><div class="line">        me.bina.click(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">            me.test()</div><div class="line">        &#125;)</div><div class="line">    &#125;,</div><div class="line">    test:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        a=<span class="number">6</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>单例通讯的时候先绑定dom<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> tag1=&#123;</div><div class="line">init:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">this</span>.render()</div><div class="line">    <span class="keyword">this</span>.bind()</div><div class="line">    &#125;</div><div class="line">    ...</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> tag2=&#123;</div><div class="line">init:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">this</span>.render()</div><div class="line">    <span class="keyword">this</span>.bind()</div><div class="line">    &#125;,</div><div class="line">    test:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        tag1.a=<span class="number">6</span>      <span class="comment">//改变tag1里面的a</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><h3 id="构造函数模式"><a href="#构造函数模式" class="headerlink" title="构造函数模式"></a>构造函数模式</h3><p>构造函数用于创建特定类型的对象—不仅声明了使用的对象，构造函数还可以接受参数以便第一次创建对象的时候设置对象的成员值。可以自定义自己的构造函数，然后在里面声明自定义类型<br>对象的属性或方法。</p><p>在js中，构造函数通常是认为用来实现实例的，js没有类的概念，但是有特殊的构造函数。通过new关键字来调用自定义的构造函数，在构造函数内部，this关键字引用的是新创建的对象</p><h4 id="模式作用：-1"><a href="#模式作用：-1" class="headerlink" title="模式作用："></a>模式作用：</h4><p>1、用于创建特定类型的对象<br>2、第一次声明的时候给对象赋值<br>3、自己声明构造函数，赋予属性和方法</p><h4 id="注意事项：-1"><a href="#注意事项：-1" class="headerlink" title="注意事项："></a>注意事项：</h4><p>1、声明函数的时候处理业务逻辑<br>2、区分和单例的区别，配合单例实现初始化<br>3、构造函数大写字母开头<br>4、注意new的成本<br>代码实现其实就是构造函数<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">hardy</span>(<span class="params">age</span>)</span>&#123;</div><div class="line"><span class="keyword">if</span>(!(<span class="keyword">this</span> <span class="keyword">instanceof</span> hardy))&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> hardy()</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">this</span>.age=age?age:<span class="string">'90'</span></div><div class="line">    <span class="keyword">this</span>.create=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.age</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> har=hardy(<span class="number">18</span>)</div><div class="line"><span class="keyword">let</span> har1=hardy1(<span class="number">19</span>)</div><div class="line"><span class="built_in">console</span>.log(har)   <span class="comment">//18</span></div><div class="line"><span class="built_in">console</span>.log(har1)   <span class="comment">//19</span></div></pre></td></tr></table></figure></p><p>单例模式与构造函数结合<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> A=&#123;</div><div class="line"><span class="function"><span class="keyword">function</span>：<span class="title">hardy</span>(<span class="params">age</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(!(<span class="keyword">this</span> <span class="keyword">instanceof</span> hardy))&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">new</span> hardy()</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">this</span>.age=age?age:<span class="string">'90'</span></div><div class="line">        <span class="keyword">this</span>.create=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.age</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> B=&#123;</div><div class="line"><span class="function"><span class="keyword">function</span>：<span class="title">hardy</span>(<span class="params">age</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(!(<span class="keyword">this</span> <span class="keyword">instanceof</span> hardy))&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">new</span> hardy()</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">this</span>.age=age?age:<span class="string">'90'</span></div><div class="line">        <span class="keyword">this</span>.create=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.age</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> har=<span class="keyword">new</span> AA.hardy(<span class="number">18</span>)</div><div class="line"><span class="keyword">let</span> har1=<span class="keyword">new</span> BB.hardy1(<span class="number">19</span>)</div><div class="line"><span class="built_in">console</span>.log(har)   <span class="comment">//18</span></div><div class="line"><span class="built_in">console</span>.log(har1)   <span class="comment">//19</span></div></pre></td></tr></table></figure></p><h3 id="建造者模式"><a href="#建造者模式" class="headerlink" title="建造者模式"></a>建造者模式</h3><p>建造者模式可以将一个复杂对象的构建与其表示相分离，是的同样的构建过程可以创建不同的表示。也就是说如果我们用了建造者模式，那么用户就需要指定需要建造的类型就可以得到它们，建造者模式实际就是一个指挥者，一个建造者，一个使用指挥者调用具体建造者工作得出结果的客户。</p><p>建造者模式主要用于“分步骤构建一个复杂的对象”，在这其中“分步骤”是一个稳定的算法，而复杂对象的各个部分则经常变化</p><p>比如大家再熟悉不过的$.ajax，<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$.ajax(&#123;        <span class="comment">//这里的$.ajax就是建造者</span></div><div class="line">    url:<span class="string">'hardy.php'</span>,</div><div class="line">    succ:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</div><div class="line">    err:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p><p>假设：<br>1、产出的东西是房子<br>2、baogongtou调用工人进行开工，而且他要很清楚工人们的某一个大项<br>3、工人是盖房子的工人可以建造卧室、客厅、厨房<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">House</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="keyword">this</span>.room=<span class="string">""</span></div><div class="line"><span class="keyword">this</span>.living_room=<span class="string">""</span></div><div class="line"><span class="keyword">this</span>.kitchen=<span class="string">""</span></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Foreman</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="keyword">this</span>.gaifangzi=<span class="function"><span class="keyword">function</span>(<span class="params">worker</span>)</span>&#123;</div><div class="line">    worker.make_room()</div><div class="line">    worker.make_livingroom()</div><div class="line">    worker.make_kitchen()</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Worker</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="keyword">this</span>.make_room=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'卧室我建好了'</span>)</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">this</span>.make_livingroom=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">         <span class="built_in">console</span>.log(<span class="string">'客厅我建好了'</span>)</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">this</span>.make_kitchen=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'厨房我建好了'</span>)</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">this</span>.complate=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">var</span> _house=<span class="keyword">new</span> House()</div><div class="line">        _house.room=<span class="string">"ok"</span></div><div class="line">        _house.living_room=<span class="string">"ok"</span></div><div class="line">        _house.kitchen=<span class="string">"ok"</span></div><div class="line">        <span class="keyword">return</span> _house</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> worker=<span class="keyword">new</span> Worker()</div><div class="line"><span class="keyword">let</span> foreman=<span class="keyword">new</span> Foreman()</div><div class="line">foreman.gaifangzi(worker)</div><div class="line"><span class="keyword">let</span> myhouse=worker.complate()</div><div class="line"><span class="built_in">console</span>.log(<span class="built_in">JSON</span>.stringify(myhouse))</div></pre></td></tr></table></figure></p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/jsantd/make4.JPG" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><h3 id="工厂模式"><a href="#工厂模式" class="headerlink" title="工厂模式"></a>工厂模式</h3><p>工厂模式定义一个用于创建对象的接口，这个接口由子类决定实例化哪一个类。该模式使一个类的实例化延迟到了子类。而子类可以重写接口方法以便创建的时候指定自己的对象类型（抽象工厂）</p><p>这个模式十分有用，尤其是创建对象的流程赋值的时候，比如依赖于很多设置文件等。并且，你会经常在程序里看到工厂方法，用于让子类类定义需要创建的对象类型</p><h4 id="模式作用：-2"><a href="#模式作用：-2" class="headerlink" title="模式作用："></a>模式作用：</h4><p>1、对象的构建十分复杂<br>2、需要依赖具体的环境创建不同的实例<br>3、处理大量具有相同属性的小对象</p><h4 id="注意事项：-2"><a href="#注意事项：-2" class="headerlink" title="注意事项："></a>注意事项：</h4><p>不能滥用工厂，有时候仅仅是给代码增加复杂度<br>简单工厂<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> XMLHttpFactory=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line">XMLHttpFactory.createXMLHttp=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="keyword">let</span> XMLHttp=<span class="literal">null</span></div><div class="line"><span class="keyword">if</span> (<span class="built_in">window</span>.XMLHttpRequest) &#123;</div><div class="line">XMLHttp=<span class="keyword">new</span> XMLHttpRequest()</div><div class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">window</span>.ActiveXObject)&#123;</div><div class="line">XMLHttp=<span class="keyword">new</span> ActiveXObject(<span class="string">"Microsoft.XMLHTTP"</span>)</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> XMLHttp</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> AjaxHander=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="keyword">let</span> XMLHttp=XMLHttpFactory.createXMLHttp()</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>抽象工厂<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">XMLHttpFactory.prototype=&#123;</div><div class="line">createFactory:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'this is an abstract class'</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> XHRHander=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">XMLHttpFactory.call(<span class="keyword">this</span>)</div><div class="line">&#125;</div><div class="line">XHRHander.prototype=<span class="keyword">new</span> XMLHttpFactory()</div><div class="line">XHRHander.prototype.constructor=XHRHander</div><div class="line"></div><div class="line">XHRHander.prototype.createFactory=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="keyword">var</span> XMLHttp=<span class="literal">null</span></div><div class="line"><span class="keyword">if</span>(<span class="built_in">window</span>.XMLHttpRequest)&#123;</div><div class="line">    XMLHttp=<span class="keyword">new</span> XMLHttpRequest()</div><div class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">window</span>.ActiveXObject(<span class="string">"Microsoft.XMLHTTP)&#123;</span></div><div class="line"><span class="string">        XMLHttp=new ActiveXObject('Microsoft.XMLHTTP')</span></div><div class="line"><span class="string">    &#125;</span></div><div class="line"><span class="string">    return XMLHttp</span></div><div class="line"><span class="string">&#125;</span></div></pre></td></tr></table></figure></p><h3 id="外观模式"><a href="#外观模式" class="headerlink" title="外观模式"></a>外观模式</h3><p>外观模式（Facade）为子系统中的一组接口提供了一个一致的界面，此模块定义了一个高层接口，这个接口使得这一子系统更加容易使用。<br>外观模式不仅简化类中的接口，而且对接口与调用者也进行了解耦。外观模式经常被认为开发者必备，它可以将一些复杂操作封装起来，并创建一个简单的接口用于调用</p><h4 id="模式作用：-3"><a href="#模式作用：-3" class="headerlink" title="模式作用："></a>模式作用：</h4><p>1、在设计初期，应该要意识地将不同的两个层分离，比如经典的三层结构。<br>2、在开发阶段，子系统往往因为不断的重构演化而变得越来越复杂，增加外观可以提供一个简单的接口，减少他们之间的依赖。<br>3、在维护一个遗留的大型系统时，为系统开发一个外观Facade类，为设计粗糙和高度复杂的遗留代码提供比较清晰的接口，让新系统和Facade对象交互。</p><h4 id="注意事项：-3"><a href="#注意事项：-3" class="headerlink" title="注意事项："></a>注意事项：</h4><p>1、外观模式被开发者连续使用时会产生一定的性能问题，因为在每次调用时都要检测功能的可用性</p><blockquote><p>代码</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> stopEvent=<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;   <span class="comment">//阻止冒泡和默认事件</span></div><div class="line">e.stopPropagation()</div><div class="line">e.preventDefault()</div><div class="line">&#125;</div><div class="line">$(<span class="string">'.btn'</span>).click(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">stopEvent(e)</div><div class="line">&#125;)</div></pre></td></tr></table></figure><h3 id="代理模式"><a href="#代理模式" class="headerlink" title="代理模式"></a>代理模式</h3><p>代理，顾名思义就是帮助别人做事，GoF对代理模式的定义如下：<br>代理模式（Proxy），为其他对象提供一种代理以控制对这个对象的访问。<br>代理模式使得代理对象控制具体对象的引用。代理几乎可以是任何对象：文件，资源，内存中的对象，或者是一些难以复制的东西</p><h4 id="模式作用：-4"><a href="#模式作用：-4" class="headerlink" title="模式作用："></a>模式作用：</h4><p>1、远程代理（一个对象将不同空间的对象进行局部代理）<br>2、虚拟代理（根据需要创建开销很大的对象如渲染网页暂时用占位符代替真图）<br>3、安全代理（控制真实对象的访问权限）<br>4、智能指引（调用对象代理处理另外一些事情如垃圾回收机制）</p><h4 id="注意事项：-4"><a href="#注意事项：-4" class="headerlink" title="注意事项："></a>注意事项：</h4><p>不能滥用代理，有时候仅仅是给代码增加复杂度</p><blockquote><p>代码</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">maijia</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="keyword">this</span>.name=<span class="string">'小明'</span></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">zhongjie</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line">zhongjie.prototype.maifang=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="keyword">new</span> fangdong(<span class="keyword">new</span> maijia()).maifang(<span class="string">'300'</span>)</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fangdong</span>(<span class="params">maijia</span>)</span>&#123;</div><div class="line"><span class="keyword">this</span>.maijia_name=maijia.name</div><div class="line"><span class="keyword">this</span>.maifang=<span class="function"><span class="keyword">function</span>(<span class="params">money</span>)</span>&#123;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">`收到<span class="subst">$&#123;<span class="keyword">this</span>.maijia_name&#125;</span>  <span class="subst">$&#123;money&#125;</span>万元`</span>)</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">(<span class="keyword">new</span> zhongjie).maifang()</div></pre></td></tr></table></figure><h3 id="观察者模式"><a href="#观察者模式" class="headerlink" title="观察者模式"></a>观察者模式</h3><p>观察者模式又叫发布订阅者模式（Publish/Subscribe），它定义了一种一对多的关系，让多个观察者对象同时监听某一个主题对象，这个主题对象的状态发生变化的时候就会通知所有的观察者对象，使得它们能够自动更新自己</p><h4 id="模式作用：-5"><a href="#模式作用：-5" class="headerlink" title="模式作用："></a>模式作用：</h4><p>1、支持简单的广播通信，自动通知所有已经订阅过的对象。<br>2、页面载入后目标对象很容易与观察者存在一种动态关联，增加了灵活性<br>3、目标对象与观察者之间的抽象耦合关系能够扩展以及重用</p><h4 id="注意事项：-5"><a href="#注意事项：-5" class="headerlink" title="注意事项："></a>注意事项：</h4><p>监听要在触发之前</p><blockquote><p>代码</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//在ES5中主要是通过Object.defineProperty方法定义对象属性的设置和获取，并在进行设置时执行相关的处理函数</span></div><div class="line"><span class="comment">// 创建对象</span></div><div class="line"><span class="keyword">var</span> targetObj = &#123;</div><div class="line">    age: <span class="number">1</span></div><div class="line">&#125;</div><div class="line"><span class="comment">// 定义值改变时的处理函数</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">observer</span>(<span class="params">oldVal, newVal</span>) </span>&#123;</div><div class="line"><span class="comment">// 其他处理逻辑...</span></div><div class="line">    <span class="built_in">console</span>.info(<span class="string">'name属性的值从 '</span>+ oldVal +<span class="string">' 改变为 '</span> + newVal);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 定义name属性及其set和get方法</span></div><div class="line"><span class="built_in">Object</span>.defineProperty(targetObj, <span class="string">'name'</span>, &#123;</div><div class="line">    enumerable: <span class="literal">true</span>,</div><div class="line">    configurable: <span class="literal">true</span>,</div><div class="line">    get: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> name;</div><div class="line">    &#125;,</div><div class="line">    set: <span class="function"><span class="keyword">function</span>(<span class="params">val</span>) </span>&#123;</div><div class="line">        <span class="comment">//调用处理函数</span></div><div class="line">        observer(name, val)</div><div class="line">        name = val;</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">targetObj.name = <span class="string">'Martin'</span>;</div><div class="line">targetObj.name = <span class="string">'Lucas'</span>;</div><div class="line"><span class="built_in">console</span>.info(<span class="string">'targetObj:'</span>, targetObj)</div><div class="line"></div><div class="line">输出</div><div class="line">name属性的值从 Martin 改变为 Lucas</div><div class="line">targetObj: &#123;<span class="attr">age</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">'Lucas'</span>&#125;</div></pre></td></tr></table></figure><p>ES6<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TargetObj</span> </span>&#123;</div><div class="line">    <span class="keyword">constructor</span>(age, name) &#123;</div><div class="line">        <span class="keyword">this</span>.name = name;</div><div class="line">        <span class="keyword">this</span>.age = age;</div><div class="line">    &#125;</div><div class="line">    set name(val) &#123;</div><div class="line">        observer(name, val);</div><div class="line">        name = val;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> targetObj = <span class="keyword">new</span> TargetObj(<span class="number">1</span>, <span class="string">'Martin'</span>);</div><div class="line"></div><div class="line"><span class="comment">// 定义值改变时的处理函数</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">observer</span>(<span class="params">oldVal, newVal</span>) </span>&#123;</div><div class="line"><span class="comment">// 其他处理逻辑...</span></div><div class="line">    <span class="built_in">console</span>.info(<span class="string">'name属性的值从 '</span>+ oldVal +<span class="string">' 改变为 '</span> + newVal);</div><div class="line">&#125;</div><div class="line">targetObj.name = <span class="string">'Lucas'</span>;</div><div class="line"><span class="built_in">console</span>.info(targetObj)</div><div class="line"></div><div class="line">输出</div><div class="line">name属性的值从 Martin 改变为 Lucas</div><div class="line">targetObj: &#123;<span class="attr">age</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">'Lucas'</span>&#125;</div></pre></td></tr></table></figure></p><p>proxy Api<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TargetObj</span> </span>&#123;</div><div class="line">    <span class="keyword">constructor</span>(age, name) &#123;</div><div class="line">        <span class="keyword">this</span>.name = name;</div><div class="line">        <span class="keyword">this</span>.age = age;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> targetObj = <span class="keyword">new</span> TargetObj(<span class="number">1</span>, <span class="string">'Martin'</span>);</div><div class="line"></div><div class="line"><span class="keyword">let</span> observerProxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(targetObj, &#123;</div><div class="line">    set(target, property, value, reciever) &#123;</div><div class="line">        <span class="keyword">if</span> (property === <span class="string">'name'</span>) &#123;</div><div class="line">            observer(target[property], value);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="built_in">Reflect</span>.set(target, property, value, reciever);</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"><span class="comment">// 定义值改变时的处理函数</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">observer</span>(<span class="params">oldVal, newVal</span>) </span>&#123;</div><div class="line"><span class="comment">// 其他处理逻辑...</span></div><div class="line">    <span class="built_in">console</span>.info(<span class="string">`name属性的值从 <span class="subst">$&#123;oldVal&#125;</span> 改变为 <span class="subst">$&#123;newVal&#125;</span>`</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">observerProxy.name = <span class="string">'Lucas'</span>;</div><div class="line"><span class="built_in">console</span>.info(targetObj);</div></pre></td></tr></table></figure></p><h3 id="策略模式"><a href="#策略模式" class="headerlink" title="策略模式"></a>策略模式</h3><p>策略模式定义了算法家族，分别封装起来，让他们之间可以相互替换，此模式让算法的变化不会影响到使用算法的客户</p><h4 id="模式作用：-6"><a href="#模式作用：-6" class="headerlink" title="模式作用："></a>模式作用：</h4><p>1、所有的这些算法都是做相同的事情，只是实现不同<br>2、以相同的方式调用所有的方法，减少了各种算法类与使用算法类之间的耦合<br>3、单独定义算法类，也方便了单元测试</p><h4 id="注意事项：-6"><a href="#注意事项：-6" class="headerlink" title="注意事项："></a>注意事项：</h4><p>不仅可以封装算法，也可以用来封装几乎任何类型的规则，是要在分析过程中需要在不同时间应用不同的业务规则，就可以考虑是要策略模式来处理各种变化</p><blockquote><p>代码：</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//比如验证一个电话号码输入</span></div><div class="line"><span class="keyword">let</span> val = <span class="built_in">document</span>.querySelector(<span class="string">'#input'</span>);</div><div class="line"></div><div class="line"><span class="keyword">let</span> valLint=&#123;</div><div class="line">isEmpty:<span class="function"><span class="keyword">function</span>(<span class="params">num</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> boolean</div><div class="line">    &#125;,</div><div class="line">    isTel:<span class="function"><span class="keyword">function</span>(<span class="params">num</span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> boolean</div><div class="line">    &#125;</div><div class="line">&#125;<span class="comment">//这是一个策略对象，也可以将所用的所有策略分别写入valLint里面，然后封装成一个.js文件，在需要用到策略的时候进行require然后传值判断，直接得到需要的boolean</span></div><div class="line"></div><div class="line"><span class="comment">//使用策略</span></div><div class="line"><span class="keyword">let</span> isEmpty=valLint.isEmpty(val)</div><div class="line"><span class="keyword">let</span> isTel=valLint.isTel(val)</div><div class="line"></div><div class="line"><span class="keyword">if</span>(!isEmpty&amp;&amp;isTel)&#123;</div><div class="line">....</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="命令模式"><a href="#命令模式" class="headerlink" title="命令模式"></a>命令模式</h3><p>命令模式(Command)的定义是：用来对方法调用进行参数化处理和传送，经过这样处理过的方法调用可以在任何需要的时候执行。也就是说该模式旨在将函数的调用、请求和操作封装成一个单一的对象，然后对这个对象进行一系列的处理。它也可以用来消除调用操作的对象和实现操作的对象之间的耦合。这为各种具体的类的更换带来了极大的灵活性。</p><h4 id="模式作用：-7"><a href="#模式作用：-7" class="headerlink" title="模式作用："></a>模式作用：</h4><p>1、将函数的封装、请求、调用结合为一体<br>2、调用具体的函数解耦命令对象与接收对象<br>3、提高程序模块化的灵活性</p><h4 id="注意事项：-7"><a href="#注意事项：-7" class="headerlink" title="注意事项："></a>注意事项：</h4><p>不需要接口一致，直接调用函数即可，以免造成浪费</p><blockquote><p>代码：</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> lian=&#123;&#125;</div><div class="line"></div><div class="line">lian.bubing=<span class="function"><span class="keyword">function</span>(<span class="params">bu_num</span>)</span>&#123;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">`步兵<span class="subst">$&#123;bu_num&#125;</span>开始战斗`</span>)</div><div class="line">&#125;</div><div class="line">lian.paobing=fnuction(pao_num)&#123;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">`炮兵<span class="subst">$&#123;pao_num&#125;</span>开始战斗`</span>)</div><div class="line">&#125;</div><div class="line">lian.lianzhang=<span class="function"><span class="keyword">function</span>(<span class="params">mingling</span>)</span>&#123;</div><div class="line">lian[mingling.type](mingling.num)</div><div class="line">&#125;</div><div class="line"><span class="comment">//发布命令</span></div><div class="line">lian.lianzhang(&#123;</div><div class="line">type:<span class="string">'bubing'</span>,</div><div class="line">num:<span class="number">100</span></div><div class="line">&#125;)</div><div class="line">lian.lianzhang(&#123;</div><div class="line">type:<span class="string">'paobing'</span>,</div><div class="line">num:<span class="number">50</span></div><div class="line">&#125;)</div><div class="line"><span class="comment">//步兵100开始战斗，炮兵50开始战斗</span></div></pre></td></tr></table></figure><h3 id="迭代器模式"><a href="#迭代器模式" class="headerlink" title="迭代器模式"></a>迭代器模式</h3><p>迭代器模式提供一种方法顺序访问一个聚合对象中各个元素，而又不需要暴露该方法中的内部表示</p><h4 id="模式作用：-8"><a href="#模式作用：-8" class="headerlink" title="模式作用："></a>模式作用：</h4><p>1、为遍历不同的集合结构提供一个统一的接口，从而支持同样的算法在不同的集合结构上进行操作（比如jquery中的$.each()）<br>2、集合内部尝尝变化各异，不想暴露其内部结构，但是又想让客户代码透明地访问其中的元素，就可以用迭代器模式。</p><h4 id="注意事项：-8"><a href="#注意事项：-8" class="headerlink" title="注意事项："></a>注意事项：</h4><p>1、一般的迭代，至少需要有2个方法，hasNext()和Next()，这样做才做到遍历所有的对象。<br>2、遍历的同时更改迭代器所在的集合结构可能会导致问题（比如c#的foreach里不允许修改item）</p><blockquote><p>代码：</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/jsantd/iterator10.JPG" alt="code" title="">                </div>                <div class="image-caption">code</div>            </figure><h3 id="职责链模式"><a href="#职责链模式" class="headerlink" title="职责链模式"></a>职责链模式</h3><p>职责链模式是使多个对象都有机会处理请求，从而避免请求的发送者和接收者之间的耦合关系。将这个对象连城一条链，并沿着这条链传递该请求，直到有一个对象处理它为止。<br>（举个栗子：客户需要开发一个系统，于是联系大boss，大boss肯定不会自己写代码，于是大boss把任务指派给项目经理，项目经理自己有几率不写，于是指派给coder来写代码,在这个过程中，客户没有直接和coder说，而是通过大boss层层指派，形成一条链，并沿着这条链传递该任务，上面说的对象指的就是我们这些coder）</p><p>链中收到请求的对象要么亲自处理它，要么转发给下一个候选者。提交方并不明确有多少个对象会处理它，任一候选者都可以响应的请求，可以在运行时刻决定哪些候选者参与到链中。</p><blockquote><p>代码：</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/jsantd/chain_of_resibilities11.jpg" alt="“职责链实现”" title="">                </div>                <div class="image-caption">“职责链实现”</div>            </figure><h3 id="适配器模式"><a href="#适配器模式" class="headerlink" title="适配器模式"></a>适配器模式</h3><p>适配器模式（Adapter）是将一个类（对象）的接口（方法或属性）转换成客户希望的另外一个接口（方法或属性），适配器模式使得原本由<br>于接口不兼容而不能一起工作的那些类（对象）可以一起工作。</p><h4 id="模式作用：-9"><a href="#模式作用：-9" class="headerlink" title="模式作用："></a>模式作用：</h4><p>1、使用一个已经存在的对象，但其方法或接口不符合你的要求<br>2、创建一个可复用的对象，该对象可以与其他不相关或不可见的对象协同工作<br>3、使用已经存在的一个或多个对象，但是不能继承已匹配它的接口</p><h4 id="注意事项：-9"><a href="#注意事项：-9" class="headerlink" title="注意事项："></a>注意事项：</h4><p>与代理模式的区别，代理模式是不改变原接口适配时原接口不符合规范</p><blockquote><p>举个栗子：假如本来你做的一个项目里头有一个Object</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> a=&#123;</div><div class="line">test:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,</div><div class="line">go:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line">&#125;</div><div class="line">a.test()</div><div class="line"><span class="comment">//这是你原来写的东西，然后假如项目重构，别人嫌弃你的静态方法，于是写成</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">b</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="keyword">this</span>.test=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line">&#125;</div><div class="line">b.prototype.go=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line"><span class="comment">//别人重构之后你所有调a的地方都要写成let a=new b()，然后改着改着自己就乱了</span></div></pre></td></tr></table></figure><blockquote><p>代码：</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//在别人重构之后，我们可以这样</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Adapter</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="keyword">let</span> h=<span class="keyword">new</span> b()</div><div class="line"><span class="keyword">let</span> a=&#123;</div><div class="line">    test:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        h.test()</div><div class="line">        &#125;,</div><div class="line">        go:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">            h.go()</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> a</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> a=Adapter()</div><div class="line">a.test()</div><div class="line">a.go()</div></pre></td></tr></table></figure><p>这样就迁移回来了，假如在参加一个比较大的项目的时候有功能一样的a.js和b.js，一般来说要判断<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(...)&#123;</div><div class="line"><span class="built_in">require</span>(<span class="string">'a.js'</span>)</div><div class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(...)&#123;</div><div class="line"><span class="built_in">require</span>(<span class="string">'b.js'</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>其实没必要，因为可以封装一个c.js的适配器，然后暴露a,b相应的接口对外，在a,b接口判断相应的逻辑，然后处理a.js和b.js</p><h3 id="模板方法"><a href="#模板方法" class="headerlink" title="模板方法"></a>模板方法</h3><p>模板方法(TemplateMethod)定义了一个操作中的算法的骨架，而将一些步骤延迟到子类中。模板方法使得子类可以不改变一个算法的结构即可重定义该算法的某些特定步骤。</p><p>模板方法是一种代码复用的基本技术，在类库中尤为重要，因为他们提取了类库中的公共行为。模板方法导致一种反向的控制结构，这种结构就是传说中的”好莱坞法则”，即”别找我们，我们找你”，这指的是父类调用一个类的操作，而不是相反。具体体现是面向对象编程语言里面的抽象类（以及其中的抽象方法），以及继承该抽象类（和抽象方法）的子类</p><h4 id="模式作用：-10"><a href="#模式作用：-10" class="headerlink" title="模式作用："></a>模式作用：</h4><p>1、一次性实现一个算法的不变的部分，并将可变的行为留给子类来实现<br>2、各子类中公共的行为应该被提取出来并集中到一个公共父类中规避代码重复，不同之处分离为新的操作，最后，用一个钓鱼这些新操作的模板方法来替换这些不同的代码<br>3、控制子类扩展，模板方法只在特定点调用”hook”，这样就允许在这些点进行扩展</p><h4 id="注意事项：-10"><a href="#注意事项：-10" class="headerlink" title="注意事项："></a>注意事项：</h4><p>和策略模式不同，模板方法使用继承来改变算法的一部分，而策略模式使用委托来改变整个算法</p><blockquote><p>实现一个游戏流程：</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Process</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line">Process.prototype.start=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">confirm(<span class="string">'开始游戏'</span>)</div><div class="line">&#125;</div><div class="line">Process.prototype.loading=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'loading...'</span>)</div><div class="line">&#125;</div><div class="line">Process.prototype.out=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">confirm(<span class="string">'结束游戏'</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Angry_birds</span>(<span class="params"></span>)</span>&#123;&#125;</div><div class="line"></div><div class="line">Angry_birds.prototype=<span class="keyword">new</span> Process()</div><div class="line">Angry_birds.start()</div></pre></td></tr></table></figure><p>上述代码=&gt;建立一个游戏流程的模板，然后有一个愤怒的小鸟的游戏直接继承了该模板，有其他游戏也可以直接继承该游戏模板</p><h3 id="原型模式"><a href="#原型模式" class="headerlink" title="原型模式"></a>原型模式</h3><p>原型模式（prototype）是指用原型实例指向创建对象的种类，并且通过拷贝这些原型创建新的对象，这里的prototype不是js里面的prototype，而是一个原型的英文单词，只不过js里面的prototype刚好符合这种原型模式，真正在设计模式里面是有原型模式这样的概念的，所以不能把js里面的prototype和原型模式prototype语法混淆。</p><p>对于原型模式，可以利用JavaScript特有的原型继承特性去创建对象的方式，真正的原型继承是作为最新版的ECMAScript5标准提出的，使用Object.create方法来创建这样的对象，比如Object.create(prototype,optionalDescriptorObjects)</p><h4 id="模式作用：-11"><a href="#模式作用：-11" class="headerlink" title="模式作用："></a>模式作用：</h4><p>原型对象本身就是有效地利用了每个构造器创建的对象</p><h4 id="注意事项：-11"><a href="#注意事项：-11" class="headerlink" title="注意事项："></a>注意事项：</h4><p>1、注意的依然是浅拷贝和深拷贝的问题，免得出现引用问题<br>2、现有的文献里查看原型模式的定义，没有针对JavaScript的，你可能发现很多讲解的都是关于类的，但是现实情况是基于原型继承 的JavaScript完全避免了类（class）的概念</p><blockquote><p>代码：</p></blockquote><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> myobj=&#123;</div><div class="line">        str:<span class="string">'mystring'</span>,</div><div class="line">        num:<span class="number">1</span>,</div><div class="line">        myarr:[</div><div class="line">            <span class="number">30</span>,</div><div class="line">            &#123;<span class="attr">arrgo</span>:<span class="string">'i am arr'</span>&#125;</div><div class="line">        ],</div><div class="line">        myobj1:&#123;</div><div class="line">            innerobj:&#123;</div><div class="line">                test:<span class="number">25</span></div><div class="line">            &#125;,</div><div class="line">            innerstr:<span class="string">'myobjInnerstr'</span></div><div class="line">        &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> clone=<span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</div><div class="line">    <span class="keyword">let</span> obt=&#123;&#125;,k</div><div class="line">    <span class="keyword">for</span>(k <span class="keyword">in</span> obj)&#123;</div><div class="line">        obt[k]=obj[k]</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> obt</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> result=clone(myobj)</div><div class="line"><span class="built_in">console</span>.log(myobj)</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'----------------------------'</span>)</div><div class="line">result.myobj1.innerstr=<span class="string">""</span></div><div class="line"><span class="built_in">console</span>.log(result)</div><div class="line"><span class="built_in">console</span>.log(myobj)</div></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/jsantd/14-1.png" alt=".log" title="">                </div>                <div class="image-caption">.log</div>            </figure><p>克隆之后修改了myobj1里面的innerstr，然而原来的myobj里面的myobj1[innerstr]也改变了，这是因为受到了引用的影响，可以重写一下clone<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> clone=<span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</div><div class="line">    <span class="keyword">let</span> obt=&#123;&#125;,k,b</div><div class="line">    <span class="keyword">if</span>((b=(obj <span class="keyword">instanceof</span> <span class="built_in">Array</span>))||obj <span class="keyword">instanceof</span> <span class="built_in">Object</span>)&#123;</div><div class="line">        obt=b?[]:&#123;&#125;</div><div class="line">        <span class="keyword">for</span>(k <span class="keyword">in</span> obj)&#123;</div><div class="line">            <span class="keyword">if</span>((obj[k] <span class="keyword">instanceof</span> <span class="built_in">Array</span>)||(obj[k] <span class="keyword">instanceof</span> <span class="built_in">Object</span>))&#123;</div><div class="line">                obt[k]=clone(obj[k])</div><div class="line">            &#125;<span class="keyword">else</span>&#123;</div><div class="line">                obt[k]=obj[k]</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> obt</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/jsantd/14-2.png" alt=".log" title="">                </div>                <div class="image-caption">.log</div>            </figure><p>也可以用Object.create来实现，但是结构打印不出来,值可以拿到，这个是为什么我后续再研究一下，毕竟凌晨4点了。。。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> myobj=&#123;</div><div class="line">        str:<span class="string">'mystring'</span>,</div><div class="line">        num:<span class="number">1</span>,</div><div class="line">        myarr:[</div><div class="line">            <span class="number">30</span>,</div><div class="line">            &#123;<span class="attr">arrgo</span>:<span class="string">'i am arr'</span>&#125;</div><div class="line">        ],</div><div class="line">        obj:&#123;</div><div class="line">            innerobj:&#123;</div><div class="line">                test:<span class="number">25</span></div><div class="line">            &#125;,</div><div class="line">            innerstr:<span class="string">'myobjInnerstr'</span></div><div class="line">        &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> m=<span class="built_in">Object</span>.create(myobj)</div><div class="line"><span class="built_in">console</span>.log(myobj)</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'---------------'</span>)</div><div class="line">m.num=<span class="number">666</span></div><div class="line"><span class="built_in">console</span>.log(m.num)</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'---------------'</span>)</div><div class="line"><span class="built_in">console</span>.log(myobj)</div></pre></td></tr></table></figure></p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/jsantd/14-3.png" alt=".log" title="">                </div>                <div class="image-caption">.log</div>            </figure><p>！！！总之！！！！！！不要为了设计模式而设计模式！！！</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;javascript常见设计模式&lt;/p&gt;
&lt;p&gt;&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;//music.163.com/outchain/player?type=2&amp;id=562613275&amp;auto=0&amp;height=66&quot;&gt;&lt;/iframe&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="javascript" scheme="http://yoursite.com/tags/javascript/"/>
    
      <category term="设计模式" scheme="http://yoursite.com/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
      <category term="深拷贝" scheme="http://yoursite.com/tags/%E6%B7%B1%E6%8B%B7%E8%B4%9D/"/>
    
  </entry>
  
  <entry>
    <title>前端架构</title>
    <link href="http://yoursite.com/2019/07/24/%E6%B5%85%E8%B0%88%E5%89%8D%E7%AB%AF%E6%9E%B6%E6%9E%84/"/>
    <id>http://yoursite.com/2019/07/24/浅谈前端架构/</id>
    <published>2019-07-23T16:59:39.000Z</published>
    <updated>2019-07-24T15:44:14.507Z</updated>
    
    <content type="html"><![CDATA[<p>阿里前辈的经验</p><p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1297742771&auto=0&height=66"></iframe><br><a id="more"></a><br><a href="https://blog.csdn.net/qq20004604/article/details/70480932" target="_blank" rel="external">‘中小型项目前端架构浅谈’</a><br><a href="https://blog.csdn.net/qq20004604/article/details/90575092" target="_blank" rel="external">‘大型项目前端架构浅谈’</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;阿里前辈的经验&lt;/p&gt;
&lt;p&gt;&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;//music.163.com/outchain/player?type=2&amp;id=1297742771&amp;auto=0&amp;height=66&quot;&gt;&lt;/iframe&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="前端架构" scheme="http://yoursite.com/tags/%E5%89%8D%E7%AB%AF%E6%9E%B6%E6%9E%84/"/>
    
  </entry>
  
  <entry>
    <title>React16.6配置代理&amp;style私有</title>
    <link href="http://yoursite.com/2019/06/22/React16-6%E9%85%8D%E7%BD%AE%E4%BB%A3%E7%90%86/"/>
    <id>http://yoursite.com/2019/06/22/React16-6配置代理/</id>
    <published>2019-06-22T09:56:19.000Z</published>
    <updated>2020-01-13T15:21:46.766Z</updated>
    
    <content type="html"><![CDATA[<p>你或许想知道的新代理</p><p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=426341675&auto=0&height=66"></iframe><br><a id="more"></a></p><p>在脚手架中，一般配置代理会在package.json中写上<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="string">"proxy"</span>:<span class="string">"url"</span></div><div class="line"><span class="comment">//或者</span></div><div class="line"><span class="string">"name"</span>: <span class="string">"hardy"</span>,</div><div class="line"><span class="string">"version"</span>: <span class="string">"0.1.0"</span>,</div><div class="line"><span class="string">"private"</span>: <span class="literal">true</span>,</div><div class="line"><span class="string">"proxy"</span>:<span class="string">"url"</span>,</div></pre></td></tr></table></figure></p><p>这是配置单个代理的时候的情况，假如需要配置多个代理就写成<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="string">"name"</span>: <span class="string">"proxy"</span>,</div><div class="line">  <span class="string">"version"</span>: <span class="string">"0.1.0"</span>,</div><div class="line">  <span class="string">"private"</span>: <span class="literal">true</span>,</div><div class="line">  <span class="string">"proxy"</span>:&#123;</div><div class="line">    <span class="string">"/api"</span>: &#123;</div><div class="line">        <span class="string">"target"</span>: <span class="string">"url"</span>,</div><div class="line">        <span class="string">"ws"</span>: <span class="literal">true</span></div><div class="line">      &#125;,</div><div class="line">  <span class="string">"/apb"</span>: &#123;</div><div class="line">        <span class="string">"target"</span>: <span class="string">"url"</span>,</div><div class="line">        <span class="string">"ws"</span>: <span class="literal">true</span></div><div class="line">      &#125;</div><div class="line">  &#125;</div></pre></td></tr></table></figure></p><p>但是如果在react16.6中这样使用，项目运行的时候会报错，提示不允许Object<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">"proxy"</span> <span class="keyword">in</span> package.json must be a string</div></pre></td></tr></table></figure></p><p>而且在react16.6中，上面的配置已经解决不了代理问题了，这里我亲测了一个极简的demo，用node简单写一个在3001端口返回简单数据的接口，然后用16的脚手架构建了一个初级应用，<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/react166/nodemock.JPG" alt="nodemock" title="">                </div>                <div class="image-caption">nodemock</div>            </figure><br>然后用react脚手架创建一个应用，接着在App这个组件中写一个请求<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/react166/easyget.JPG" alt="easyget" title="">                </div>                <div class="image-caption">easyget</div>            </figure><br>请求之后，打开控制台发现network中确实已经发出了请求，并且有了返回值<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/react166/mocked.png" alt="mocked" title="">                </div>                <div class="image-caption">mocked</div>            </figure><br>但是打印出来是这样的<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/react166/cors.JPG" alt="cors" title="">                </div>                <div class="image-caption">cors</div>            </figure><br>在react16.6中，create-react-app使用了webpack4.0，如果proxy不是字符串的话，是不能够在package.json中直接配置，并且会报错，其实在脚手架的配置文件中是可以找到配置代理的地方的，比如翻一下这个脚手架的webpack配置文件就发现了这个<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/react166/1.JPG" alt="setupProxy.*" title="">                </div>                <div class="image-caption">setupProxy.*</div>            </figure><br>说明在src这个目录下面可以创建一个名为setupProxy的文件用来写代理，<a href="https://facebook.github.io/create-react-app/docs/getting-started" target="_blank" rel="external">这个在官网也有说明</a><br>解决方案就是使用http-proxy-middleware管理包来解决代理问题<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/react166/install.JPG" alt="install" title="">                </div>                <div class="image-caption">install</div>            </figure><br>根据脚手架中webpack配置文件中得到的信息，在src下面创建setupProxy.js文件，然后写入代理<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/react166/thiscode.JPG" alt="install" title="">                </div>                <div class="image-caption">install</div>            </figure><br>写完之后重启服务，代理成功<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/react166/success.JPG" alt="install" title="">                </div>                <div class="image-caption">install</div>            </figure><br><a href="https://facebook.github.io/create-react-app/docs/proxying-api-requests-in-development#docsNav" target="_blank" rel="external">更加详细戳这里</a>   </p><h3 id="scoped-amp-amp-styled-components"><a href="#scoped-amp-amp-styled-components" class="headerlink" title="scoped&amp;&amp;styled-components"></a>scoped&amp;&amp;styled-components</h3><p>在index.js引入index.css的时候假如index.css里面有个.hardy,那么在APP组件里面的div使用ClassName=’hardy’也会生效。</p><blockquote><p>在vue组件中，在style标签上添加scoped属性，以表示它的样式作用于当下的模块，很好的实现了样式私有化的目的，这是一个非常好的机制。但是在实际业务中我们往往会对公共组件样式做细微的<br>调整，如果添加了scoped属性，那么样式将会变得不易修改。</p></blockquote><p>在react中我们可以使用一个依赖叫styled-components<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install styled-components</div></pre></td></tr></table></figure></p><p>来实现css的私有<br>举例个小栗子（reset统一不同内核浏览器的标签）：<br>1、安装styled-components<br>2、把index.css改成style.js<br>然后在style.js中<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; injectGlobal &#125; <span class="keyword">from</span> <span class="string">'styled-components'</span></div><div class="line">injectGlobal <span class="string">`</span></div><div class="line"><span class="string">    body&#123;background:red&#125;</span></div><div class="line"><span class="string">`</span></div></pre></td></tr></table></figure></p><p>在早一点的版本中，这么写是没问题的，body应该会变红，但是<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/react166/styled-components.JPG" alt="error" title="">                </div>                <div class="image-caption">error</div>            </figure><br>原因是：styled-components 4.x版本将原来的injectGlobal方法用createGlobalStyle替换了。createGlobalStyle是这么用的<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//style.js</span></div><div class="line"><span class="keyword">import</span> &#123;createGlobalStyle&#125; <span class="keyword">from</span> <span class="string">'styled-components'</span>;</div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> GlobalStyle=createGlobalStyle <span class="string">`</span></div><div class="line"><span class="string">    body&#123;</span></div><div class="line"><span class="string">      background:red;</span></div><div class="line"><span class="string">    &#125;</span></div><div class="line"><span class="string">`</span></div></pre></td></tr></table></figure></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//index.js</span></div><div class="line"><span class="keyword">import</span> React,&#123;fragments&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</div><div class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>;</div><div class="line"><span class="keyword">import</span> &#123;GlobalStyle&#125; <span class="keyword">from</span> <span class="string">'./style.js'</span></div><div class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App'</span>;</div><div class="line"></div><div class="line">ReactDOM.render(</div><div class="line">  &lt;fragments&gt;</div><div class="line">  &lt;GlobalStyle/&gt;</div><div class="line">    &lt;App /&gt;</div><div class="line">  &lt;<span class="regexp">/fragments&gt;</span></div><div class="line"><span class="regexp">  , document.getElementById('root'));</span></div></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/react166/red.JPG" alt="succ" title="">                </div>                <div class="image-caption">succ</div>            </figure><p>重置的话写成这样就可以了<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;createGlobalStyle&#125; <span class="keyword">from</span> <span class="string">'styled-components'</span>;</div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> GlobalStyle=createGlobalStyle <span class="string">`</span></div><div class="line"><span class="string">    html, body, div, span, applet, object, iframe,</span></div><div class="line"><span class="string">    h1, h2, h3, h4, h5, h6, p, blockquote, pre,</span></div><div class="line"><span class="string">    a, abbr, acronym, address, big, cite, code,</span></div><div class="line"><span class="string">    del, dfn, em, img, ins, kbd, q, s, samp,</span></div><div class="line"><span class="string">    small, strike, strong, sub, sup, tt, var,</span></div><div class="line"><span class="string">    b, u, i, center,</span></div><div class="line"><span class="string">    dl, dt, dd, ol, ul, li,</span></div><div class="line"><span class="string">    fieldset, form, label, legend,</span></div><div class="line"><span class="string">    table, caption, tbody, tfoot, thead, tr, th, td,</span></div><div class="line"><span class="string">    article, aside, canvas, details, embed, </span></div><div class="line"><span class="string">    figure, figcaption, footer, header, hgroup, </span></div><div class="line"><span class="string">    menu, nav, output, ruby, section, summary,</span></div><div class="line"><span class="string">    time, mark, audio, video &#123;</span></div><div class="line"><span class="string">      margin: 0;</span></div><div class="line"><span class="string">      padding: 0;</span></div><div class="line"><span class="string">      border: 0;</span></div><div class="line"><span class="string">      font-size: 100%;</span></div><div class="line"><span class="string">      font: inherit;</span></div><div class="line"><span class="string">      vertical-align: baseline;</span></div><div class="line"><span class="string">    &#125;</span></div><div class="line"><span class="string">    /* HTML5 display-role reset for older browsers */</span></div><div class="line"><span class="string">    article, aside, details, figcaption, figure, </span></div><div class="line"><span class="string">    footer, header, hgroup, menu, nav, section &#123;</span></div><div class="line"><span class="string">      display: block;</span></div><div class="line"><span class="string">    &#125;</span></div><div class="line"><span class="string">    body &#123;</span></div><div class="line"><span class="string">      line-height: 1;</span></div><div class="line"><span class="string">    &#125;</span></div><div class="line"><span class="string">    ol, ul &#123;</span></div><div class="line"><span class="string">      list-style: none;</span></div><div class="line"><span class="string">    &#125;</span></div><div class="line"><span class="string">    blockquote, q &#123;</span></div><div class="line"><span class="string">      quotes: none;</span></div><div class="line"><span class="string">    &#125;</span></div><div class="line"><span class="string">    blockquote:before, blockquote:after,</span></div><div class="line"><span class="string">    q:before, q:after &#123;</span></div><div class="line"><span class="string">      content: '';</span></div><div class="line"><span class="string">      content: none;</span></div><div class="line"><span class="string">    &#125;</span></div><div class="line"><span class="string">    table &#123;</span></div><div class="line"><span class="string">      border-collapse: collapse;</span></div><div class="line"><span class="string">      border-spacing: 0;</span></div><div class="line"><span class="string">    &#125;</span></div><div class="line"><span class="string">`</span></div></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;你或许想知道的新代理&lt;/p&gt;
&lt;p&gt;&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;//music.163.com/outchain/player?type=2&amp;id=426341675&amp;auto=0&amp;height=66&quot;&gt;&lt;/iframe&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="React16.6" scheme="http://yoursite.com/tags/React16-6/"/>
    
      <category term="create-react-app" scheme="http://yoursite.com/tags/create-react-app/"/>
    
      <category term="proxy" scheme="http://yoursite.com/tags/proxy/"/>
    
      <category term="scoped" scheme="http://yoursite.com/tags/scoped/"/>
    
      <category term="css私有" scheme="http://yoursite.com/tags/css%E7%A7%81%E6%9C%89/"/>
    
  </entry>
  
  <entry>
    <title>根据经纬度计算两点间距</title>
    <link href="http://yoursite.com/2019/06/15/%E6%A0%B9%E6%8D%AE%E7%BB%8F%E7%BA%AC%E5%BA%A6%E8%AE%A1%E7%AE%97%E4%B8%A4%E7%82%B9%E9%97%B4%E8%B7%9D/"/>
    <id>http://yoursite.com/2019/06/15/根据经纬度计算两点间距/</id>
    <published>2019-06-15T07:37:32.000Z</published>
    <updated>2020-01-13T15:32:29.489Z</updated>
    
    <content type="html"><![CDATA[<p>打卡是很多人每天都要做两次的事情，钉钉很多人都用过，但是应该怎么判断你的位置可不可以打卡呢</p><p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=35476986&auto=0&height=66"></iframe><br><a id="more"></a></p><blockquote><p>我最近在做一个打卡的工具，简略它就是设置一个打卡的地点，允许打卡的范围等，然后提醒某个团体进行打卡，但是只能在设定的范围内打卡，不在范围或者不在打卡时间则打卡失败，因为源代码和软件是公司的东西，这里就写一个大家都玩的小例子来计算一下经纬度间的距离。</p></blockquote><h3 id="计算距离主要需要的数据就是"><a href="#计算距离主要需要的数据就是" class="headerlink" title="计算距离主要需要的数据就是"></a>计算距离主要需要的数据就是</h3><p>1、设置的活动地点的经纬度<br>2、打卡者当前位置的经纬度（这个经纬度有可能会改变，因为打卡者有可能在移动，或者是在没进入范围的时候发起的打卡，避免进入范围之后打卡失败）<br>得到上面1、2的数据之后，就可以根据计算出的距离≤设置的打卡范围（100米，200米，500米等），则打卡成功<br>3、地球半径<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/earch_juli/1.JPG" alt="" title="">                </div>                <div class="image-caption"></div>            </figure></p><h4 id="计算公式"><a href="#计算公式" class="headerlink" title="计算公式"></a>计算公式</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> PI = <span class="built_in">Math</span>.PI;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getDistance</span>(<span class="params">lat1,lng1,lat2,lng2</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> f = getRad((lat1 + lat2)/<span class="number">2</span>);</div><div class="line">    <span class="keyword">var</span> g = getRad((lat1 - lat2)/<span class="number">2</span>);</div><div class="line">    <span class="keyword">var</span> l = getRad((lng1 - lng2)/<span class="number">2</span>);</div><div class="line">    </div><div class="line">    <span class="keyword">var</span> sg = <span class="built_in">Math</span>.sin(g);</div><div class="line">    <span class="keyword">var</span> sl = <span class="built_in">Math</span>.sin(l);</div><div class="line">    <span class="keyword">var</span> sf = <span class="built_in">Math</span>.sin(f);</div><div class="line">    </div><div class="line">    <span class="keyword">var</span> s,c,w,r,d,h1,h2;</div><div class="line">    <span class="keyword">var</span> a = EARTH_RADIUS;</div><div class="line">    <span class="keyword">var</span> fl = <span class="number">1</span>/<span class="number">298.257</span>;</div><div class="line">    </div><div class="line">    sg = sg*sg;</div><div class="line">    sl = sl*sl;</div><div class="line">    sf = sf*sf;</div><div class="line">    </div><div class="line">    s = sg*(<span class="number">1</span>-sl) + (<span class="number">1</span>-sf)*sl;</div><div class="line">    c = (<span class="number">1</span>-sg)*(<span class="number">1</span>-sl) + sf*sl;</div><div class="line">    </div><div class="line">    w = <span class="built_in">Math</span>.atan(<span class="built_in">Math</span>.sqrt(s/c));</div><div class="line">    r = <span class="built_in">Math</span>.sqrt(s*c)/w;</div><div class="line">    d = <span class="number">2</span>*w*a;</div><div class="line">    h1 = (<span class="number">3</span>*r <span class="number">-1</span>)/<span class="number">2</span>/c;</div><div class="line">    h2 = (<span class="number">3</span>*r +<span class="number">1</span>)/<span class="number">2</span>/s;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> d*(<span class="number">1</span> + fl*(h1*sf*(<span class="number">1</span>-sg) - h2*(<span class="number">1</span>-sf)*sg));</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRad</span>(<span class="params">d</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> d*PI/<span class="number">180.0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>也可以是这样<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">getDistance:<span class="function"><span class="keyword">function</span>(<span class="params">lat1,lng1,lat2,lng2</span>)</span>&#123;</div><div class="line">      lat1 = lat1 || <span class="number">0</span>;</div><div class="line">      lng1 = lng1 || <span class="number">0</span>;</div><div class="line">      lat2 = lat2 || <span class="number">0</span>;</div><div class="line">      lng2 = lng2 || <span class="number">0</span>;    </div><div class="line">      <span class="keyword">var</span> rad1 = lat1 * <span class="built_in">Math</span>.PI / <span class="number">180.0</span>;    </div><div class="line">      <span class="keyword">var</span> rad2 = lat2 * <span class="built_in">Math</span>.PI / <span class="number">180.0</span>;    </div><div class="line">      <span class="keyword">var</span> a = rad1 - rad2;    </div><div class="line">      <span class="keyword">var</span> b = lng1 * <span class="built_in">Math</span>.PI / <span class="number">180.0</span> - lng2 * <span class="built_in">Math</span>.PI / <span class="number">180.0</span>;    </div><div class="line">      <span class="keyword">var</span> r = <span class="number">637139.3</span>;  <span class="comment">//地球半径</span></div><div class="line">      <span class="keyword">var</span> distance = r * <span class="number">2</span> * <span class="built_in">Math</span>.asin(<span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.pow(<span class="built_in">Math</span>.sin(a / <span class="number">2</span>), <span class="number">2</span>) + <span class="built_in">Math</span>.cos(rad1) * <span class="built_in">Math</span>.cos(rad2) * <span class="built_in">Math</span>.pow(<span class="built_in">Math</span>.sin(b / <span class="number">2</span>), <span class="number">2</span>)));  </div><div class="line">      <span class="keyword">return</span> distance;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>cosbeta通过搜索找到了一个js的计算脚本（其实是google map的计算脚本，应该算是比较准确了），做成了<a href="http://www.storyday.com/wp-content/uploads/2008/09/latlung_dis.html" target="_blank" rel="external">一个根据经纬度计算两点距离的工具</a>，前辈利用google map的经纬度到距离计算的js脚本还原出来的公式是这个样子的<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/earch_juli/2.JPG" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><br>公式中经纬度均用弧度表示，<a href="http://www.360doc.com/content/10/1228/10/284485_81937345.shtml" target="_blank" rel="external">可以参考这里</a></p><p>lat1 lng1 表示A点纬度和经度<br>lat2 lng2 表示B点纬度和经度</p><p>两点纬度之差: a=lat1 – lat2<br>两点经度之差: b=lng1 - lng2</p><p>637139.3为地球半径，单位为米<br>计算过程为<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//计算距离，参数分别为第一点的纬度，经度；第二点的纬度，经度</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getDistance</span>(<span class="params">lat1,lng1,lat2,lng2</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> radLat1 = Rad(lat1);</div><div class="line">    <span class="keyword">var</span> radLat2 = Rad(lat2);</div><div class="line">    <span class="keyword">var</span> a = radLat1 - radLat2;</div><div class="line">    <span class="keyword">var</span>  b = Rad(lng1) - Rad(lng2);</div><div class="line">    <span class="keyword">var</span> s = <span class="number">2</span> * <span class="built_in">Math</span>.asin(<span class="built_in">Math</span>.sqrt(<span class="built_in">Math</span>.pow(<span class="built_in">Math</span>.sin(a/<span class="number">2</span>),<span class="number">2</span>) + <span class="built_in">Math</span>.cos(radLat1)*<span class="built_in">Math</span>.cos(radLat2)*<span class="built_in">Math</span>.pow(<span class="built_in">Math</span>.sin(b/<span class="number">2</span>),<span class="number">2</span>)))*<span class="number">637139.3</span>;</div><div class="line">    s = <span class="built_in">Math</span>.round(s * <span class="number">10000</span>) / <span class="number">10000</span>; </div><div class="line">    <span class="keyword">return</span> s;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Rad</span>(<span class="params">d</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> d * <span class="built_in">Math</span>.PI / <span class="number">180.0</span>;<span class="comment">//经纬度转换成三角函数中度分表形式。</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>总之，计算的的精度取决于传入的经纬度的精度，同样的经纬度在百度、腾讯、高德等得到的位置有可能都不一样，不过偏差可以尽量缩小</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;打卡是很多人每天都要做两次的事情，钉钉很多人都用过，但是应该怎么判断你的位置可不可以打卡呢&lt;/p&gt;
&lt;p&gt;&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;//music.163.com/outchain/player?type=2&amp;id=35476986&amp;auto=0&amp;height=66&quot;&gt;&lt;/iframe&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="longitude" scheme="http://yoursite.com/tags/longitude/"/>
    
      <category term="latitude" scheme="http://yoursite.com/tags/latitude/"/>
    
      <category term="经纬度" scheme="http://yoursite.com/tags/%E7%BB%8F%E7%BA%AC%E5%BA%A6/"/>
    
  </entry>
  
  <entry>
    <title>读React源码</title>
    <link href="http://yoursite.com/2019/04/06/%E4%BA%86%E8%A7%A3React/"/>
    <id>http://yoursite.com/2019/04/06/了解React/</id>
    <published>2019-04-06T05:43:36.000Z</published>
    <updated>2020-01-13T16:30:58.963Z</updated>
    
    <content type="html"><![CDATA[<p>我年轻需要指点</p><p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=543210521&auto=0&height=66"></iframe><br><a id="more"></a></p><p>首先得有源码<br>通过 CDN 获得 React 和 ReactDOM 的 UMD 版本。<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">crossorigin</span> <span class="attr">src</span>=<span class="string">"https://unpkg.com/react@16/umd/react.development.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">crossorigin</span> <span class="attr">src</span>=<span class="string">"https://unpkg.com/react-dom@16/umd/react-dom.development.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p><p>上述版本仅用于开发环境，不适合用于生产环境。React 的压缩和优化之后的生产环境版本链接如下：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">crossorigin</span> <span class="attr">src</span>=<span class="string">"https://unpkg.com/react@16/umd/react.production.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">crossorigin</span> <span class="attr">src</span>=<span class="string">"https://unpkg.com/react-dom@16/umd/react-dom.production.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p><p>如果需要加载指定版本的 react 和 react-dom，可以把 16 替换成需要加载的版本号。react16完全重写了核心代码，但是对于使用者来说是毫无感知的，不像vue和ng一样大版本更新的时候需要<br>调整兼容，react16还引入了fiber概念，从根本上解决js单线程运行当数据流量大动画卡帧的问题。  </p><h3 id="1、JSX代码转变到javascript之createElement"><a href="#1、JSX代码转变到javascript之createElement" class="headerlink" title="1、JSX代码转变到javascript之createElement"></a>1、JSX代码转变到javascript之createElement</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">React.createElement(<span class="string">'div'</span>,&#123;</div><div class="line">    class:'aaa',</div><div class="line">    data-name:<span class="string">'hardy'</span></div><div class="line">&#125;,<span class="string">"test"</span>)</div><div class="line"></div><div class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"aaa"</span> data-name=<span class="string">"hardy"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></div><div class="line"></div><div class="line"></div><div class="line">React.createElement(<span class="string">'div'</span>,&#123;</div><div class="line">    data-name=<span class="string">'hardy'</span>,</div><div class="line">    React.createElement(<span class="string">'span'</span>,<span class="literal">null</span>,<span class="string">'1'</span>),</div><div class="line">    React.createElement(<span class="string">'span'</span>,<span class="literal">null</span>,<span class="string">'2'</span>)</div><div class="line">&#125;,<span class="string">'hardy'</span>)</div><div class="line"></div><div class="line">&lt;div data-name=<span class="string">'hardy'</span>&gt;</div><div class="line">    &lt;span&gt;<span class="number">1</span>&lt;<span class="regexp">/span&gt;</span></div><div class="line"><span class="regexp">    &lt;span&gt;2&lt;/</span>span&gt;</div><div class="line">    hardy</div><div class="line">&lt;<span class="regexp">/div&gt;</span></div></pre></td></tr></table></figure><p>如果是组件<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Hardy</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">a</span>&gt;</span>hardy<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></div><div class="line">&#125;</div><div class="line"></div><div class="line">&lt;Hardy id=<span class="string">'hardyid'</span>&gt;</div><div class="line">  &lt;span&gt;<span class="number">1</span>&lt;<span class="regexp">/span&gt;</span></div><div class="line"><span class="regexp">  &lt;span&gt;2&gt;&lt;/</span>span&gt;</div><div class="line">&lt;<span class="regexp">/Hardy&gt;</span></div></pre></td></tr></table></figure></p><p>那么createElement的第一项就不是字符串了，而是当成变量去传<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">"use strict"</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Hardy</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> React.createElement(<span class="string">"a"</span>, <span class="literal">null</span>, <span class="string">"hardy"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">React.createElement(Hardy, &#123;</div><div class="line">  id: <span class="string">"hardyid"</span></div><div class="line">&#125;, React.createElement(<span class="string">"span"</span>, <span class="literal">null</span>, <span class="string">"1"</span>), React.createElement(<span class="string">"span"</span>, <span class="literal">null</span>, <span class="string">"2&gt;"</span>));</div></pre></td></tr></table></figure></p><p>如果自定义的这个组件叫hardy的话，它会被认为是原生dom里面的标签。在执行的时候就会报错，所以在声明自定义组件的时候，首字母一定要大写，这是一个规范.</p><h3 id="2、react-Element"><a href="#2、react-Element" class="headerlink" title="2、react-Element"></a>2、react-Element</h3><p>在react中createElement这个方法是这么实现的，它传入3个参数<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">createElement</span>(<span class="params">type, config, children</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> propName = <span class="keyword">void</span> <span class="number">0</span>;</div><div class="line"></div><div class="line">  <span class="comment">// Reserved names are extracted</span></div><div class="line">  <span class="keyword">var</span> props = &#123;&#125;;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> key = <span class="literal">null</span>;</div><div class="line">  <span class="keyword">var</span> ref = <span class="literal">null</span>;</div><div class="line">  <span class="keyword">var</span> self = <span class="literal">null</span>;</div><div class="line">  <span class="keyword">var</span> source = <span class="literal">null</span>;</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (config != <span class="literal">null</span>) &#123;</div><div class="line">    <span class="keyword">if</span> (hasValidRef(config)) &#123;</div><div class="line">      ref = config.ref;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (hasValidKey(config)) &#123;</div><div class="line">      key = <span class="string">''</span> + config.key;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    self = config.__self === <span class="literal">undefined</span> ? <span class="literal">null</span> : config.__self;</div><div class="line">    source = config.__source === <span class="literal">undefined</span> ? <span class="literal">null</span> : config.__source;</div><div class="line">    <span class="comment">// Remaining properties are added to a new props object</span></div><div class="line">    <span class="keyword">for</span> (propName <span class="keyword">in</span> config) &#123;</div><div class="line">      <span class="keyword">if</span> (hasOwnProperty$<span class="number">1.</span>call(config, propName) &amp;&amp; !RESERVED_PROPS.hasOwnProperty(propName)) &#123;</div><div class="line">        props[propName] = config[propName];</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// Children can be more than one argument, and those are transferred onto</span></div><div class="line">  <span class="comment">// the newly allocated props object.</span></div><div class="line">  <span class="keyword">var</span> childrenLength = <span class="built_in">arguments</span>.length - <span class="number">2</span>;</div><div class="line">  <span class="keyword">if</span> (childrenLength === <span class="number">1</span>) &#123;</div><div class="line">    props.children = children;</div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (childrenLength &gt; <span class="number">1</span>) &#123;</div><div class="line">    <span class="keyword">var</span> childArray = <span class="built_in">Array</span>(childrenLength);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; childrenLength; i++) &#123;</div><div class="line">      childArray[i] = <span class="built_in">arguments</span>[i + <span class="number">2</span>];</div><div class="line">    &#125;</div><div class="line">    &#123;</div><div class="line">      <span class="keyword">if</span> (<span class="built_in">Object</span>.freeze) &#123;</div><div class="line">        <span class="built_in">Object</span>.freeze(childArray);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    props.children = childArray;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// Resolve default props</span></div><div class="line">  <span class="keyword">if</span> (type &amp;&amp; type.defaultProps) &#123;</div><div class="line">    <span class="keyword">var</span> defaultProps = type.defaultProps;</div><div class="line">    <span class="keyword">for</span> (propName <span class="keyword">in</span> defaultProps) &#123;</div><div class="line">      <span class="keyword">if</span> (props[propName] === <span class="literal">undefined</span>) &#123;</div><div class="line">        props[propName] = defaultProps[propName];</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  &#123;</div><div class="line">    <span class="keyword">if</span> (key || ref) &#123;</div><div class="line">      <span class="keyword">var</span> displayName = <span class="keyword">typeof</span> type === <span class="string">'function'</span> ? type.displayName || type.name || <span class="string">'Unknown'</span> : type;</div><div class="line">      <span class="keyword">if</span> (key) &#123;</div><div class="line">        defineKeyPropWarningGetter(props, displayName);</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">if</span> (ref) &#123;</div><div class="line">        defineRefPropWarningGetter(props, displayName);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> ReactElement(type, key, ref, self, source, ReactCurrentOwner.current, props);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>3个参数中的type，就是节点类型，如果是原生节点是字符串，如果是自定义组件就是class component 或者function component，或者react的组件Fragment、StricMode、Suspense,config是写在标签上的所有attr，它们都会变成keyvalue的形式存到config对象里面，我们需要从config里面筛选出props的内容或者href这种特殊的attr,children是标签中放的内容，可以是子标签或者文字,过程就是判断有没有合理的ref，有没有合理的key<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"> <span class="keyword">if</span> (hasValidRef(config)) &#123;</div><div class="line">    ref = config.ref;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (hasValidKey(config)) &#123;</div><div class="line">    key = <span class="string">''</span> + config.key;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>然后就是对props进行处理，将不是内嵌的props另存到一个新的对象<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (propName <span class="keyword">in</span> config) &#123;</div><div class="line">    <span class="keyword">if</span> (hasOwnProperty$<span class="number">1.</span>call(config, propName) &amp;&amp; !RESERVED_PROPS.hasOwnProperty(propName)) &#123;</div><div class="line">        props[propName] = config[propName];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>内嵌的也就是RESERVED_PROPS中做了这样的声明<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> RESERVED_PROPS=&#123;</div><div class="line">   key:<span class="literal">true</span>,</div><div class="line">   ref:<span class="literal">true</span>,</div><div class="line">   __self:<span class="literal">true</span>,</div><div class="line">   __soure:<span class="literal">true</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>这里面的属性都不会出现在比如react项目中组件通信的时候的this.props中，然后是处理children<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> childrenLength = <span class="built_in">arguments</span>.length - <span class="number">2</span>;</div><div class="line">  <span class="keyword">if</span> (childrenLength === <span class="number">1</span>) &#123;</div><div class="line">    props.children = children;</div><div class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (childrenLength &gt; <span class="number">1</span>) &#123;</div><div class="line">    <span class="keyword">var</span> childArray = <span class="built_in">Array</span>(childrenLength);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; childrenLength; i++) &#123;</div><div class="line">      childArray[i] = <span class="built_in">arguments</span>[i + <span class="number">2</span>];</div><div class="line">    &#125;</div><div class="line">    &#123;</div><div class="line">      <span class="keyword">if</span> (<span class="built_in">Object</span>.freeze) &#123;</div><div class="line">        <span class="built_in">Object</span>.freeze(childArray);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    props.children = childArray;</div><div class="line">  &#125;</div></pre></td></tr></table></figure></p><p>children是可以有多个的，在一个节点上可能有很多兄弟节点，createElement(type, config, children),<br>默认是可以传入3个参数，但是实际上我们可以传入很多个，第三个参数之后的参数都认为是一个children,所以arguments.length-2就等于接下来的这些参数都是children，接着将这些children<br>存到新声明的数组childArray，最终它再放到props.children里面，通过this.props.children就可以拿到;接着是对默认props的处理，比如在写一个自己的组件的时候可以加上这么个值，这样<br>如果给别人用的时候，他没有传入这个值，就默认是设置的默认值。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">impoert React,&#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span></div><div class="line">Hardy.defaultProps=&#123; <span class="attr">name</span>:hardy &#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hardy</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (type &amp;&amp; type.defaultProps) &#123;   </div><div class="line">    <span class="keyword">var</span> defaultProps = type.defaultProps;</div><div class="line">    <span class="keyword">for</span> (propName <span class="keyword">in</span> defaultProps) &#123;</div><div class="line">      <span class="comment">//如果==就代表null和undefined都需要设置默认值，===就表示即使是null也不需要设置默认值</span></div><div class="line">      <span class="keyword">if</span> (props[propName] === <span class="literal">undefined</span>) &#123;    </div><div class="line">        props[propName] = defaultProps[propName];</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>到这里的时候，预处理的内容已经完成了，然后它return了一个ReactElement，并传入上面处理的那些内容，return ReactElement(type, key, ref, self, source,<br>ReactCurrentOwner.current, props);ReactElement在第1881行的时候做了这样的声明<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/konwReact/1ReactElement.JPG" alt="“like this”" title="">                </div>                <div class="image-caption">“like this”</div>            </figure><br>ReactElement最终return一个这样的Object<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> element = &#123;</div><div class="line">    <span class="comment">// This tag allows us to uniquely identify this as a React Element</span></div><div class="line">    $$<span class="keyword">typeof</span>: REACT_ELEMENT_TYPE,   </div><div class="line"></div><div class="line">    <span class="comment">// Built-in properties that belong on the element</span></div><div class="line">    type: type,</div><div class="line">    key: key,</div><div class="line">    ref: ref,</div><div class="line">    props: props,</div><div class="line"></div><div class="line">    <span class="comment">// Record the component responsible for creating this element.</span></div><div class="line">    _owner: owner</div><div class="line">  &#125;;</div><div class="line">$$<span class="keyword">typeof</span>是REACT_ELEMENT_TYPE，用来标识Element是什么类型的，type是传进来的type，key是处理过的key，ref就是ref，props就是props，_owner就是_owner</div></pre></td></tr></table></figure></p><h3 id="3、react-Component"><a href="#3、react-Component" class="headerlink" title="3、react-Component"></a>3、react-Component</h3><p>Component就是组件<br>一般<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React,&#123; Component &#125; <span class="keyword">from</span> <span class="string">'react</span></div><div class="line"><span class="string">class hardy extends Component&#123;&#125;</span></div></pre></td></tr></table></figure></p><p>或者<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">hardy</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;&#125;</div></pre></td></tr></table></figure></p><p>hardy都是去继承React的Component的base Class,其实React中有Component和PureComponent，两者唯一的区别就是PureComponent保证了组件在没有任何变化的情况下能够减少不必要的更新<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/konwReact/2react中的Component和PualComponent.JPG" alt="“PureComponent”" title="">                </div>                <div class="image-caption">“PureComponent”</div>            </figure><br>Component:<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/konwReact/3react中的Component.JPG" alt="Component" title="">                </div>                <div class="image-caption">Component</div>            </figure><br>Component被声明成了一个函数，接收3个参数props, context, updater，this.props和this.context是可以直接用的，emptyObject是我们获取的节点的实例然后挂载在this.refs上<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> emptyObject = &#123;&#125;;</div><div class="line">&#123;</div><div class="line">  <span class="built_in">Object</span>.freeze(emptyObject);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>接下来第421行代码，Component的原型上挂载了一个setState，这是使用频率最多的api，它是用来更新组件状态的，partialState是要更新的新的state，可以是对象，也可以是个方法，callba<br>ck是更新完之后执行的方法，this.setState主要的部分是this.updater.enqueueSetState，也就是调用this.setState的时候初始化调用Component的时候传入的updater对象上面的enqueueS<br>etState方法，enqueueSetState在reactDom里面实现<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Component.prototype.setState = <span class="function"><span class="keyword">function</span> (<span class="params">partialState, callback</span>) </span>&#123;</div><div class="line">  !(<span class="keyword">typeof</span> partialState === <span class="string">'object'</span> || <span class="keyword">typeof</span> partialState === <span class="string">'function'</span> || partialState == <span class="literal">null</span>) ? invariant(<span class="literal">false</span>, <span class="string">'setState(...): takes an object of state variables to update or a function which returns an object of state variables.'</span>) : <span class="keyword">void</span> <span class="number">0</span>;</div><div class="line">  <span class="keyword">this</span>.updater.enqueueSetState(<span class="keyword">this</span>, partialState, callback, <span class="string">'setState'</span>);</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p><p>Component上面还有个方法叫forceUpdate，作用就是强制react的state更新<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Component.prototype.forceUpdate = <span class="function"><span class="keyword">function</span> (<span class="params">callback</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.updater.enqueueForceUpdate(<span class="keyword">this</span>, callback, <span class="string">'forceUpdate'</span>);</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p><p>Component的内容就是这些了，确实内容还是蛮少</p><h3 id="4、PureComponent"><a href="#4、PureComponent" class="headerlink" title="4、PureComponent:"></a>4、PureComponent:</h3><p>PureComponent继承自Component，区别就是加了isReactComponent=true,通过这个来标识继承自Component的是PureComponent<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/konwReact/4pureComponent.JPG" alt="pureComponent" title="">                </div>                <div class="image-caption">pureComponent</div>            </figure></p><h3 id="5、react-ref的三种方式"><a href="#5、react-ref的三种方式" class="headerlink" title="5、react-ref的三种方式"></a>5、react-ref的三种方式</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">constructor</span>()&#123;</div><div class="line">    <span class="keyword">super</span>()</div><div class="line">    <span class="keyword">this</span>.objRef=React.createRef()</div><div class="line">&#125;</div><div class="line">componentDitMount()&#123;</div><div class="line">    <span class="keyword">this</span>.refs.stringRef.textContent=<span class="string">"hardy string"</span>;     <span class="comment">//1</span></div><div class="line">    <span class="keyword">this</span>.methodsRef.textContent=<span class="string">"hardy function"</span>;       <span class="comment">//2</span></div><div class="line">    <span class="keyword">this</span>.objRef.current.textContent=<span class="string">"hardy createRef"</span>   <span class="comment">//3</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><h4 id="1、string-ref"><a href="#1、string-ref" class="headerlink" title="1、string ref"></a>1、string ref</h4><p>想要获取节点的元素的props上添加一个ref属性，然后传入字符串，然后在完成这个节点的渲染之后在this.refs上面挂载这个属性的key，如果是节点就是节点，如果是组件就是组件，对应的就是<br>这个节点的实例的对象（将要被废弃的使用方式）</p><p></p><p ref="stringRef"></p><p></p><h4 id="2、function"><a href="#2、function" class="headerlink" title="2、function"></a>2、function</h4><p>ref传入一个方法，方法接收一个参数，参数就是当前的实例，如果是节点就是节点，如果是组件就是组件</p><p></p><p ref="{ele=">(this.methodsRef=ele)}&gt;</p><p></p><h4 id="3、createRef"><a href="#3、createRef" class="headerlink" title="3、createRef"></a>3、createRef</h4><p>这个是react提供的api,利用this.objRef=React.createRef()创建了一个null的current对象，然后传给某个节点，传完之后在组件渲染完成之后，将对应的节点挂载到current上</p><p></p><p ref="{this.objRef}"></p><br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/konwReact/5react下的createRef.JPG" alt="createRef" title="">                </div>                <div class="image-caption">createRef</div>            </figure><br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/konwReact/6createRefdo.JPG" alt="createRefdo" title="">                </div>                <div class="image-caption">createRefdo</div>            </figure><br>Object.seal()方法封闭一个对象，阻止添加新属性并将所有现有属性标记为不可配置。当前属性的值只要可写就可以改变。<p></p><h3 id="6、forwardRef"><a href="#6、forwardRef" class="headerlink" title="6、forwardRef"></a>6、forwardRef</h3><p>之前从上层组件传到子组件的方式只有props，forwardRef可以传入第二个参数<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> Childcom=React.forwardRef(<span class="function">(<span class="params">props,ref</span>)=&gt;</span>&#123;</div><div class="line">    &lt;input type=<span class="string">"text"</span> ref=&#123;ref&#125;&gt;</div><div class="line">&#125;)</div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> Com extends React.Component&#123;</div><div class="line">    <span class="keyword">constructor</span>()&#123;</div><div class="line">        <span class="keyword">super</span>()</div><div class="line">        <span class="keyword">this</span>.creaRef=React.createRef()</div><div class="line">    &#125;</div><div class="line">    componentDidMount()&#123;</div><div class="line">        <span class="keyword">this</span>.ref.current.value=<span class="string">"hardy forwardRef"</span></div><div class="line">    &#125;</div><div class="line">    render()&#123;</div><div class="line">        <span class="keyword">return</span> (</div><div class="line">            &lt;Childcom ref=&#123;<span class="keyword">this</span>.ref&#125;&gt;<span class="xml"><span class="tag">&lt;/<span class="name">Childcom</span>&gt;</span></span></div><div class="line">        )</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>在react中forwardRef的实现<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">forwardRef</span>(<span class="params">render</span>) </span>&#123;</div><div class="line">  &#123;</div><div class="line">    <span class="keyword">if</span> (render != <span class="literal">null</span> &amp;&amp; render.$$<span class="keyword">typeof</span> === REACT_MEMO_TYPE) &#123;</div><div class="line">      warningWithoutStack$<span class="number">1</span>(<span class="literal">false</span>, <span class="string">'forwardRef requires a render function but received a `memo` '</span> + <span class="string">'component. Instead of forwardRef(memo(...)), use '</span> + <span class="string">'memo(forwardRef(...)).'</span>);</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> render !== <span class="string">'function'</span>) &#123;</div><div class="line">      warningWithoutStack$<span class="number">1</span>(<span class="literal">false</span>, <span class="string">'forwardRef requires a render function but was given %s.'</span>, render === <span class="literal">null</span> ? <span class="string">'null'</span> : <span class="keyword">typeof</span> render);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      !(</div><div class="line">      <span class="comment">// Do not warn for 0 arguments because it could be due to usage of the 'arguments' object</span></div><div class="line">      render.length === <span class="number">0</span> || render.length === <span class="number">2</span>) ? warningWithoutStack$<span class="number">1</span>(<span class="literal">false</span>, <span class="string">'forwardRef render functions accept exactly two parameters: props and ref. %s'</span>, render.length === <span class="number">1</span> ? <span class="string">'Did you forget to use the ref parameter?'</span> : <span class="string">'Any additional parameter will be undefined.'</span>) : <span class="keyword">void</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (render != <span class="literal">null</span>) &#123;</div><div class="line">      !(render.defaultProps == <span class="literal">null</span> &amp;&amp; render.propTypes == <span class="literal">null</span>) ? warningWithoutStack$<span class="number">1</span>(<span class="literal">false</span>, <span class="string">'forwardRef render functions do not support propTypes or defaultProps. '</span> + <span class="string">'Did you accidentally pass a React component?'</span>) : <span class="keyword">void</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    $$<span class="keyword">typeof</span>: REACT_FORWARD_REF_TYPE,</div><div class="line">    render: render</div><div class="line">  &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><h3 id="7、context"><a href="#7、context" class="headerlink" title="7、context"></a>7、context</h3><p>react中组件组件通信用props,多层组件通信的时候中间隔着不同的组件，这时候用context，父组件设置了一个context，其所有的子组件都可以通过context访问到<br>context的实现方式有两种<br>1、childContextTypes（即将被废弃）<br>2、createContext（re16提供的）<br>关系<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> ()=&gt;&#123;</div><div class="line">    &lt;Parent&gt;</div><div class="line">        &lt;Child/&gt;</div><div class="line">        &lt;Child/&gt;</div><div class="line">    &lt;<span class="regexp">/Parent&gt;</span></div><div class="line"><span class="regexp">&#125;</span></div></pre></td></tr></table></figure></p><p>父组件<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</div><div class="line">    <span class="keyword">constructor</span>()&#123;</div><div class="line">       <span class="keyword">super</span>()</div><div class="line">       <span class="keyword">this</span>.state=&#123;</div><div class="line">           ChildContext:<span class="string">"hardy"</span></div><div class="line">       &#125;</div><div class="line">    &#125;</div><div class="line">    getChildContext()&#123;</div><div class="line">        <span class="keyword">return</span> &#123;<span class="attr">value</span>:<span class="keyword">this</span>.state.ChildContext&#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">Parent.childContextTypes=&#123;</div><div class="line">    value:PropTypes.string   <span class="comment">//和PropTypes一样，如果不声明是无法获取到的，</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>子组件<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Child.contextTypes=&#123;</div><div class="line">    value:PropTypes.string</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</div><div class="line">    render()&#123;</div><div class="line">        <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;this.context.value&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>上面那是老的context用法 ，接下来是新的api<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; Provider,Consumer &#125; =React.createContext(<span class="string">'default'</span>)</div></pre></td></tr></table></figure></p><p>Provider和Consumer分别是context的提供方和订阅方,在Parent直接<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;Provider value=&#123;<span class="keyword">this</span>.state.newContext&#125;&gt;<span class="xml"><span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span></div></pre></td></tr></table></figure></p><p>然后在Child这边需要用到的地方直接,Consumer,在父组件定义了context之后，子组件的哪个地方需要用到这个context就可以直接用这个组件就可以了<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;Consumer&gt;&#123;value=&gt;<span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>newContext:&#123;value&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>&#125;&lt;<span class="regexp">/Consumer&gt;</span></div></pre></td></tr></table></figure></p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/konwReact/7newcreateContext.JPG" alt="newcreateContext" title="">                </div>                <div class="image-caption">newcreateContext</div>            </figure><p>createContext接收两个参数，一个是defaultValue，另一个calculateChangedBits用来计算新老API变化的，<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/konwReact/8newcreateContext.JPG" alt="newcreateContext" title="">                </div>                <div class="image-caption">newcreateContext</div>            </figure><br>_currentValue: defaultValue,_currentValue2: defaultValue是用来更新最新的defaultValue值</p><h3 id="8、ConCurrentMode（re16之后）"><a href="#8、ConCurrentMode（re16之后）" class="headerlink" title="8、ConCurrentMode（re16之后）"></a>8、ConCurrentMode（re16之后）</h3><p>ConCurrentMode（本叫assignMode）16.6之后名字更新，作用是让react的渲染过程进行优先的排比，并且能让整体的渲染过程中断，它可以进行任务调度，把更多的cpu性能（javascript是单线<br>程语言，如果react的某个更新渲染占用了非常长的进程，会导致动画卡顿或者其他的一些响应变卡，因为这时候js正在运行react的更新，这时候react可以有选择的优先进行优先级更高的任务，比<br>如一个人在游泳，他一次要游到水底再上来，如果他中间岸上有人有更重要的事情找他，但是只能等他先游上来才能继续，但是这个就提供了每隔一段时间会看一下是否有更重要的事情然后先做。）<br>ConCurrentMode有个特性，在ConCurrentMode子树中渲染了ConCurrentMode之后，它下面所有节点的更新就是低优先级的更新<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/konwReact/9concurrentmodeJustSymbol.JPG" alt="concurrentmodeJustSymbol" title="">                </div>                <div class="image-caption">concurrentmodeJustSymbol</div>            </figure><br>react16.6已经可以使用一部分功能的新的react filter<br>Suspense：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SuspenseComp</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">const</span> data=requestData()</div><div class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;data&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></div><div class="line">&#125;</div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> ()=&gt;&#123;</div><div class="line">   &lt;Suspense fallback=<span class="string">"loading"</span>&gt;  </div><div class="line">       &lt;SuspenseComp/&gt;    <span class="comment">//SuspenseComp中的data还没有的时候显示loading</span></div><div class="line">   &lt;<span class="regexp">/Suspense&gt;</span></div><div class="line"><span class="regexp">&#125;</span></div></pre></td></tr></table></figure></p><p>这个api目前在正式的项目不建议用，可以先用lazy(lazy.js)<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> ()=&gt; <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>lazy comp<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">import</span> React,&#123; lazy &#125; <span class="keyword">from</span> <span class="string">'react'</span></div><div class="line"><span class="keyword">const</span> lazyComp=lazy(<span class="function"><span class="params">()</span>=&gt;</span>&#123;<span class="keyword">import</span>(./lazy.js)&#125;)</div></pre></td></tr></table></figure></p><p>这个就是用了webpack的异步加载的api,看源码之后发现Suspense也是个symbol<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/konwReact/10suspenseYeshichangliangJPG.JPG" alt="suspenseYeshichangliang" title="">                </div>                <div class="image-caption">suspenseYeshichangliang</div>            </figure><br>lazy函数接收一个方法，ctor<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/konwReact/11lazyNotaSymbol.JPG" alt="lazyNotaSymbol" title="">                </div>                <div class="image-caption">lazyNotaSymbol</div>            </figure><br>_status用来记录状态<br>_result用来记录promise对象返回之后的属性，最终resolve出来的会放在_result上面</p><h3 id="9、hooks"><a href="#9、hooks" class="headerlink" title="9、hooks"></a>9、hooks</h3><p>要安装hooks必须要react&amp;&amp;react-dom16.7以上，如果没有16.7.0，可以安装react16.7.0-alpha.2&amp;&amp;react-dom16.7.0-alpha.2，如果已经有了直接安装最新版<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> React,&#123; useState &#125; <span class="keyword">from</span> <span class="string">'react'</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> ()=&gt;&#123;</div><div class="line"><span class="keyword">const</span> [name,setname]=useState(<span class="string">'hardy'</span>)</div><div class="line"><span class="keyword">return</span> (</div><div class="line">&lt;&gt;</div><div class="line">   &lt;p&gt;my name is:&#123;name&#125;&lt;<span class="regexp">/p&gt;</span></div><div class="line"><span class="regexp"> &lt;input type="text" value=&#123;name&#125; onChange=&#123;e=&gt;setName(e.target.value)&#125;&gt;&lt;/i</span>nput&gt;</div><div class="line">&lt;<span class="regexp">/&gt;</span></div><div class="line"><span class="regexp">)</span></div><div class="line"><span class="regexp">&#125;</span></div></pre></td></tr></table></figure></p><p>这是一个函数组件，和class组件的区别就是没有this对象，没有this就没有this.state,也没有生命周期方法，这个demo用hooks来给组件存储state，给useState传入一个默认值，然后返回一个<br>数组，再解构。name是变量，setname是改变变量的方法.</p><h3 id="react中的diff算法"><a href="#react中的diff算法" class="headerlink" title="react中的diff算法"></a>react中的diff算法</h3><p>虚拟dom中的diff算法<br>1、state<br>2、jsx模板<br>3、数据+模板  生成虚拟dom（虚拟dom就是一个js对象，用它来描述真实dom）（损耗了性能）<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[<span class="string">'div'</span>,&#123;<span class="attr">id</span>:<span class="string">'abc'</span>&#125;,[<span class="string">'span'</span>,&#123;&#125;,<span class="string">'helloword'</span>]]</div></pre></td></tr></table></figure></p><p>4、用虚拟dom的结构生成真实的dom，来显示<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;div id=<span class="string">'abc'</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span>hello word<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></div></pre></td></tr></table></figure></p><p>5、state 发生变化<br>6、数据+模板  生成新的虚拟dom （提升性能）<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[<span class="string">'div'</span>,&#123;<span class="attr">id</span>:<span class="string">'abc'</span>&#125;,[<span class="string">'span'</span>,&#123;&#125;,<span class="string">'bye bye'</span>]]</div></pre></td></tr></table></figure></p><p>7、比较原始虚拟dom和新的虚拟dom的区别，找到区别是span中的内容（提升性能）<br>8、直接操作dom，改变span中的内容<br>优点：<br>性能提升<br>使得跨端应用得以实现（比如react native）</p><p>待续….</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;我年轻需要指点&lt;/p&gt;
&lt;p&gt;&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;//music.163.com/outchain/player?type=2&amp;id=543210521&amp;auto=0&amp;height=66&quot;&gt;&lt;/iframe&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="react" scheme="http://yoursite.com/tags/react/"/>
    
      <category term="jsx" scheme="http://yoursite.com/tags/jsx/"/>
    
      <category term="diff" scheme="http://yoursite.com/tags/diff/"/>
    
  </entry>
  
  <entry>
    <title>bind、call、apply</title>
    <link href="http://yoursite.com/2019/02/21/bind%E3%80%81call%E3%80%81apply/"/>
    <id>http://yoursite.com/2019/02/21/bind、call、apply/</id>
    <published>2019-02-20T16:00:00.000Z</published>
    <updated>2020-01-13T15:15:48.890Z</updated>
    
    <content type="html"><![CDATA[<p>改变this指向的三位选手，bind,call,apply。</p><p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=475475570&auto=0&height=66"></iframe><br><a id="more"></a></p><blockquote><p>bind,call,apply这三位选手都是原型Function下面的方法，函数原型对象是Function.prototype。比如使用了.push方法，它会去Array的prototype查找是否存在该方法，如果它会顺着原<br>型链<strong>_proto</strong>继续找，直到找到null，也就是原型链prototype<br>chain的最终链接。。。。。有点飞出地球表面。。。。,这三位选手中call、apply是立即调用函数，都是在特定的作用域中调用函数，等于设置函数体内this对象的值，以扩充函数赖以运行的作用域<br>，bind则是返回一个绑定this的函数。</p></blockquote><h3 id="三位选手一般会这么用，例如有两个对象a和b"><a href="#三位选手一般会这么用，例如有两个对象a和b" class="headerlink" title="三位选手一般会这么用，例如有两个对象a和b"></a>三位选手一般会这么用，例如有两个对象a和b</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> a=&#123;</div><div class="line">name:<span class="string">'a'</span>,</div><div class="line">getName:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> b=&#123;</div><div class="line">name:<span class="string">'b'</span>,</div><div class="line">getName:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> bFunc=a.getName.bind(b)    <span class="comment">//bind将a的this指向了b，所以a里面的getName打印的this.name就是  b</span></div><div class="line">bFunc()</div><div class="line">a.getName.call(b)              <span class="comment">//call将a的this指向b，所以getName打印出b</span></div><div class="line">b.getName.apply(a)             <span class="comment">//apply将b的this指向a，所以getName打印出a</span></div></pre></td></tr></table></figure><p>bind可以传入两次参数，可以let bFunc=a.getName.bind(b,arg1,arg2….)也可以bFunc(arg1,arg2…)；call方法接收两个参数，第一个参数和apply的一样，然后传入的参数必须是列举<br>出来，可以将一个函数的对象上下文从初始的上下文改变为第一个参数指定的新对象，如果没有提供，那么this指向Global；apply接收两个参数，第一个参数是函数运行的作用域，第二个参数<br>是数组（一整个数组），如果第二个参数不是一个有效数组或者arguments对象，会导致TypeError，如果两个参没有传入的话，那么this指向Global；apply和call和bind就是传参不一样,app<br>ly和call都是会在调用的时候同时执行调用的函数,但是bind则会返回一个绑定了this的函数.</p><h3 id="手动实现"><a href="#手动实现" class="headerlink" title="手动实现"></a>手动实现</h3><h4 id="bind"><a href="#bind" class="headerlink" title="bind"></a>bind</h4><p>需求：返回一个可以new并且与被调函数具有相同函数体的新函数，调用bind的时候传入参数长度不定<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Function</span>.prototype.hBind=<span class="function"><span class="keyword">function</span>(<span class="params">context</span>)</span>&#123;    <span class="comment">//在Function的原型上增加一个hBind方法</span></div><div class="line">   <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">this</span>!==<span class="string">'function'</span>) &#123;</div><div class="line">   <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'is not a Function'</span>)</div><div class="line">   <span class="keyword">return</span></div><div class="line">   &#125;</div><div class="line">   <span class="keyword">let</span> this_=<span class="keyword">this</span>,</div><div class="line">       aArgs=[].slice.call(<span class="built_in">arguments</span>,<span class="number">1</span>),    <span class="comment">//arguments是类数组，[]=new Array，利用Array.prototype的slice从arguments里面拿到第一次传入的参数</span></div><div class="line">       F=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;,                      <span class="comment">//为避免出现引用类型的原型对象出现相互影响创建一个用于中专的函数F</span></div><div class="line">       Fb=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;                       <span class="comment">//返回的函数，也就是例如let func=obj.bind(obj)的func</span></div><div class="line">       <span class="keyword">return</span> this_.apply(              </div><div class="line">       <span class="keyword">this</span> <span class="keyword">instanceof</span> F &amp;&amp; context?<span class="keyword">this</span>:context||<span class="built_in">window</span>, </div><div class="line">       aArgs.concat([].slice.call(<span class="built_in">arguments</span>))             </div><div class="line">       )</div><div class="line">       &#125;</div><div class="line">   F.prototype=<span class="keyword">this</span>.prototype     <span class="comment">//函数F的原型对象复制this的原型对象</span></div><div class="line">   Fb.prototype=<span class="keyword">new</span> F()           <span class="comment">//Fb的原型对象再复制F的原型对象，，实现中专</span></div><div class="line">   <span class="keyword">return</span> Fb</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><h4 id="call"><a href="#call" class="headerlink" title="call"></a>call</h4><p>需求：改变this指向和传参不定长度，可以将目标函数作为这个对象的属性，不能增加对象的属性。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Function</span>.prototype.hCall=<span class="function"><span class="keyword">function</span>(<span class="params">context,...args</span>)</span>&#123;</div><div class="line">   <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">this</span>!==<span class="string">'function'</span>) &#123;</div><div class="line">   <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'is not a Function'</span>)</div><div class="line">   <span class="keyword">return</span></div><div class="line">   &#125;</div><div class="line">   <span class="keyword">let</span> cont=context||<span class="built_in">window</span></div><div class="line">   <span class="keyword">let</span> arrs=args?args:[]</div><div class="line">   <span class="keyword">let</span> func=<span class="built_in">Symbol</span>()</div><div class="line">   cont[func]=<span class="keyword">this</span></div><div class="line">   cont[func](...arrs)</div><div class="line">   <span class="keyword">delete</span> cont[func]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><h4 id="apply"><a href="#apply" class="headerlink" title="apply"></a>apply</h4><p>与call一样，只是第二个参数是数组<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Function</span>.prototype.hApply=<span class="function"><span class="keyword">function</span>(<span class="params">context,args</span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span> (<span class="keyword">this</span>&amp;&amp;<span class="keyword">this</span>.constructor!==<span class="built_in">Function</span>) &#123;</div><div class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'is not a function'</span>)</div><div class="line">  &#125;</div><div class="line">  context=context||<span class="built_in">window</span></div><div class="line">  args=args?args:[]</div><div class="line">  <span class="keyword">let</span> func=<span class="built_in">Symbol</span>()</div><div class="line">  context[func]=<span class="keyword">this</span></div><div class="line">  <span class="keyword">if</span> (args&amp;&amp;args.constructor===<span class="built_in">Array</span>) &#123;</div><div class="line">  context[func](...args)</div><div class="line">  &#125;<span class="keyword">else</span> <span class="keyword">if</span> (!args) &#123;</div><div class="line">  <span class="keyword">delete</span> context[func]</div><div class="line">  &#125;<span class="keyword">else</span>&#123;</div><div class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'CreateListFromArrayLike called on non-object'</span>)</div><div class="line">  &#125;</div><div class="line">  elete context[func]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;改变this指向的三位选手，bind,call,apply。&lt;/p&gt;
&lt;p&gt;&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;//music.163.com/outchain/player?type=2&amp;id=475475570&amp;auto=0&amp;height=66&quot;&gt;&lt;/iframe&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="bind" scheme="http://yoursite.com/tags/bind/"/>
    
      <category term="apply" scheme="http://yoursite.com/tags/apply/"/>
    
      <category term="call" scheme="http://yoursite.com/tags/call/"/>
    
      <category term="原型" scheme="http://yoursite.com/tags/%E5%8E%9F%E5%9E%8B/"/>
    
  </entry>
  
  <entry>
    <title>react+echars做的图表轮子</title>
    <link href="http://yoursite.com/2019/01/20/React-echars%E5%81%9A%E7%9A%84%E5%9B%BE%E8%A1%A8%E7%BB%84%E4%BB%B6/"/>
    <id>http://yoursite.com/2019/01/20/React-echars做的图表组件/</id>
    <published>2019-01-20T15:34:27.000Z</published>
    <updated>2020-01-13T15:22:01.237Z</updated>
    
    <content type="html"><![CDATA[<p>突然用到了图表，突然想到echars，突然搞个轮子</p><p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=4874896&auto=0&height=66"></iframe><br><a id="more"></a></p><blockquote><p>我也不知道为啥要弄它出来</p></blockquote><p>使用方法：<br>1、安装echarts依赖<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install echarts --save</div></pre></td></tr></table></figure></p><p>2、在父组件准备需要的数据，类似这样<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> data = [</div><div class="line">  &#123;<span class="attr">value</span>: <span class="number">232</span>, <span class="attr">name</span>: <span class="string">"奥特之父"</span>&#125;,</div><div class="line">  &#123;<span class="attr">value</span>: <span class="number">200</span>, <span class="attr">name</span>: <span class="string">"奥特之母"</span>&#125;,</div><div class="line">  &#123;<span class="attr">value</span>: <span class="number">325</span>, <span class="attr">name</span>: <span class="string">"奥特之王"</span>&#125;,</div><div class="line">  &#123;<span class="attr">value</span>: <span class="number">413</span>, <span class="attr">name</span>: <span class="string">"佐菲"</span>&#125;,</div><div class="line">  &#123;<span class="attr">value</span>: <span class="number">135</span>, <span class="attr">name</span>: <span class="string">"初代"</span>&#125;,</div><div class="line">  &#123;<span class="attr">value</span>: <span class="number">326</span>, <span class="attr">name</span>: <span class="string">"赛文"</span>&#125;,</div><div class="line">  &#123;<span class="attr">value</span>: <span class="number">537</span>, <span class="attr">name</span>: <span class="string">"杰克"</span>&#125;,</div><div class="line">  &#123;<span class="attr">value</span>: <span class="number">138</span>, <span class="attr">name</span>: <span class="string">"艾斯"</span>&#125;,</div><div class="line">  &#123;<span class="attr">value</span>: <span class="number">213</span>, <span class="attr">name</span>: <span class="string">"泰罗"</span>&#125;,</div><div class="line">  &#123;<span class="attr">value</span>: <span class="number">329</span>, <span class="attr">name</span>: <span class="string">"雷欧"</span>&#125;</div><div class="line">]</div></pre></td></tr></table></figure></p><p>3、在父组件import这个组件之后在你想放它的地方写上它,然后给它传入数据，图表的标题<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;EcharsPie data=&#123;data&#125; title=<span class="string">"各种奥特曼的占比（瞎掰的）"</span>&gt;&lt;/EcharsPie&gt;</div></pre></td></tr></table></figure></p><p>echarspie.css的样式(无关紧要，你自己show time)<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">.h-echarspie-box&#123;</div><div class="line">width: <span class="number">100</span>%;</div><div class="line">height: <span class="number">100</span>%;</div><div class="line">margin: <span class="number">0</span> auto;</div><div class="line">&#125;</div><div class="line">.h-echarspie-box div&#123;</div><div class="line">width: <span class="number">100</span>%;</div><div class="line">height: <span class="number">100</span>%;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p><a href="https://github.com/HHardyy/React-echars-pie" target="_blank" rel="external">它在这里</a><br><a href="https://echarts.baidu.com/index.html" target="_blank" rel="external">想做更丰富的可以到这里研究</a><br>它长这样:<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/reactEchars/show.gif" alt="它长这样" title="">                </div>                <div class="image-caption">它长这样</div>            </figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;突然用到了图表，突然想到echars，突然搞个轮子&lt;/p&gt;
&lt;p&gt;&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;//music.163.com/outchain/player?type=2&amp;id=4874896&amp;auto=0&amp;height=66&quot;&gt;&lt;/iframe&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="react" scheme="http://yoursite.com/tags/react/"/>
    
      <category term="echars" scheme="http://yoursite.com/tags/echars/"/>
    
      <category term="图表" scheme="http://yoursite.com/tags/%E5%9B%BE%E8%A1%A8/"/>
    
  </entry>
  
  <entry>
    <title>数据结构与算法之美手记</title>
    <link href="http://yoursite.com/2018/12/20/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95%E4%B9%8B%E7%BE%8E%E6%89%8B%E8%AE%B0/"/>
    <id>http://yoursite.com/2018/12/20/数据结构与算法之美手记/</id>
    <published>2018-12-20T01:25:03.000Z</published>
    <updated>2020-01-13T15:37:33.065Z</updated>
    
    <content type="html"><![CDATA[<p>跟随Google大佬的脚步。。。（一如既往的跟不上）</p><p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=486412012&auto=0&height=66"></iframe><br><a id="more"></a></p><p>突然看到《数据结构与算法之美》，突然买，突然看，突然继续看，突然反复看。。。</p><h3 id="什么是数据结构？什么是算法？"><a href="#什么是数据结构？什么是算法？" class="headerlink" title="什么是数据结构？什么是算法？"></a>什么是数据结构？什么是算法？</h3><p>1、从广义上讲，数据结构就是指一组数据的存储结构。算法就是操作数据的一组方法。<br>举例：<br>图书馆储藏书籍你肯定见过吧？为了方便查找，图书管理员一般会将书籍分门别类进行“存储”。按照一定规律编号，就是书籍这种“数据”的存储结构。<br>那我们如何来查找一本书呢？有很多种办法，你当然可以一本一本地找，也可以先根据书籍类别的编号，是人文，还是科学、计算机，来定位书架，然后再依次查找。笼统地说，这些查找方法都<br>是算法。<br>2、从狭义上讲，是指某些著名的数据结构和算法，比如队列、栈、堆、二分查找、动态规划等。这些都是前人智慧的结晶，都是前人从很多实际操作场景中抽象出来的，经过非常多的求证和检验，<br>可以高效地帮助我们解决很多实际的开发问题。</p><h3 id="数据结构和算法有什么关系？"><a href="#数据结构和算法有什么关系？" class="headerlink" title="数据结构和算法有什么关系？"></a>数据结构和算法有什么关系？</h3><p>数据结构是为算法服务的，算法要作用在特定的数据结构之上。<br>举例：<br>数组具有随机访问的特点，常用的二分查找算法需要用数组来存储数据。但如果我们选择链表这种数据结构，二分查找算法就无法工作了，因为链表并不支持随机访问。<br>数据结构是静态的，它只是组织数据的一种方式。如果不在它的基础上操作、构建算法，孤立存在的数据结构就是没用的。</p><h3 id="我们怎么选用合适的数据结构和算法？有什么衡量标准吗？"><a href="#我们怎么选用合适的数据结构和算法？有什么衡量标准吗？" class="headerlink" title="我们怎么选用合适的数据结构和算法？有什么衡量标准吗？"></a>我们怎么选用合适的数据结构和算法？有什么衡量标准吗？</h3><p>衡量的标准(metric)—时间复杂度和空间复杂度，也就是数据结构与算法中最重要的概念——复杂度分析。数据结构和算法解决的是如何更省、更快地存储和处理数据的问题，因此，我们就需要<br>一个考量效率和资源消耗的方法，这就是复杂度分析方法，知道怎么去分析复杂度，才能得出正确的判断。</p><h3 id="几种常见时间复杂度实例分析"><a href="#几种常见时间复杂度实例分析" class="headerlink" title="几种常见时间复杂度实例分析"></a>几种常见时间复杂度实例分析</h3><p>虽然代码千差万别，但是常见的复杂度量级并不多。我稍微总结了一下，这些复杂度量级几乎涵盖了了你今后可以接触的所有代码的复杂度量级。<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/Algorithm/4.jpg" alt="复杂度量级，按数量级递增" title="">                </div>                <div class="image-caption">复杂度量级，按数量级递增</div>            </figure><br>可以粗略地分为两类，多项式量级和非多项式量级，其中，非多项式量级只有两个：O(2n) 和 O(n!)。<br>当数据规模n越来越大时，非多项式量级的算法的执行时间会急剧增加，求解决问题的执行时间会无限增长，所以非多项式时间复杂度的算法其实是非常低效的算法。</p><h4 id="多项式时间复杂度"><a href="#多项式时间复杂度" class="headerlink" title="多项式时间复杂度"></a>多项式时间复杂度</h4><p>1、O（1）<br>O（1）只是常量级时间复杂度的一种表示方法，并不是指只执行了一行代码，比如这段代码，即便有三行，它的时间复杂度也是O（1），而不是O（3）。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">int i = <span class="number">8</span>;</div><div class="line">int j = <span class="number">6</span>;</div><div class="line">int sum = i + j;</div></pre></td></tr></table></figure></p><p>总结：只要代码的执行时间不随着n的增大而增大，这样代码的时间复杂度我们都记作O（1）。或者说，一般情况下，只要算法中不存在循环语句，递归语句，即使有成千上万行的代码，其时间复杂度也是O（1）。</p><p>2、O（logn）、O（nlogn）<br>对数阶时间复杂度非常常见，同时也是最难分析的一种时间复杂度<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">i=<span class="number">1</span>;</div><div class="line"><span class="keyword">while</span> (i &lt;= n)  &#123;</div><div class="line">  i = i * <span class="number">2</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>根据复杂度分析方法，第三行代码是循环执行次数最多的，所以，只要能计算出这行代码被执行了多少次，就能知道整段代码的时间复杂度。<br>从代码中可以看出，变量 i 的值从 1 开始取，每循环一次就乘以 2。当大于 n 时，循环结束。还记得我们高中学过的等比数列吗？实际上，变量 i 的取值就是一个等比数列。<br>如果把它一个一个列出来，就应该是这个样子的：<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/Algorithm/5.jpg" alt="" title="">                </div>                <div class="image-caption"></div>            </figure><br>所以，只要知道 x 值是多少,就知道这行代码执行的次数了。通过 2x=n 求解 x。所以，这段代码的时间复杂度就是 O(log2n)。<br>现在，把代码稍微改下，再看看，这段代码的时间复杂度是多少？<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">i=<span class="number">1</span>;</div><div class="line"><span class="keyword">while</span> (i &lt;= n)  &#123;</div><div class="line">  i = i * <span class="number">3</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>根据刚刚的思路，很简单就能看出来,这段代码的时间复杂度为 O(log3n)。实际上，不管是以 2 为底、以 3 为底，还是以 10 为底。我们可以把所有对数阶的时间复杂度都记<br>为 O(logn)。为什么呢？<br>我们知道，对数之间是可以互相转换的，log3n 就等于 log32 <em> log2n，所以 O(log3n) = O(C </em>log2n)，其中 C=log32 是一个常量。基于我们前面的一个理论：在采用大<br>O标记复杂度的时候，可以忽略系数，即 O(Cf(n)) = O(f(n))。所以，O(log2n) 就等于 O(log3n)。因此，在对数阶时间复杂度的表示方法里，我们忽略对数的“底”，统一表示为 O(logn)。</p><h3 id="十个经典的排序算法"><a href="#十个经典的排序算法" class="headerlink" title="十个经典的排序算法"></a>十个经典的排序算法</h3><p>看java算法教程时候的截图笔记~~~~<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/Algorithm/1.JPG" alt="十大经典排序算法导图" title="">                </div>                <div class="image-caption">十大经典排序算法导图</div>            </figure><br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/Algorithm/2.JPG" alt="对比表中关键字字母解释" title="">                </div>                <div class="image-caption">对比表中关键字字母解释</div>            </figure><br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/Algorithm/3.JPG" alt="各种术语说明" title="">                </div>                <div class="image-caption">各种术语说明</div>            </figure>  </p><h3 id="1、冒泡排序"><a href="#1、冒泡排序" class="headerlink" title="1、冒泡排序"></a>1、冒泡排序</h3><p>两两比较相邻的数字，左边比右边大就做交换<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bubble</span>(<span class="params">arr,n</span>)</span>&#123;</div><div class="line"><span class="keyword">let</span> temp=<span class="literal">null</span>;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;n<span class="number">-1</span>;i++)&#123;</div><div class="line"><span class="keyword">if</span>(arr[i]&gt;arr[i+<span class="number">1</span>])&#123;</div><div class="line">temp=arr[i];</div><div class="line">arr[i]=arr[i+<span class="number">1</span>];</div><div class="line">arr[i+<span class="number">1</span>]=temp;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;<span class="comment">//走一遍冒泡</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">sortBble</span>(<span class="params">arr,n</span>)</span>&#123;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = n;i&gt;=<span class="number">1</span>;i--)&#123;</div><div class="line">bubble(arr,i)</div><div class="line">&#125;</div><div class="line">&#125;<span class="comment">//走一组冒泡</span></div><div class="line"><span class="keyword">let</span> arr=[<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">0</span>]</div><div class="line">sortBble(arr,arr.length)</div><div class="line"><span class="built_in">console</span>.log(arr)</div></pre></td></tr></table></figure></p><p>有一个骚操作是可以提高冒泡排序的性能，降低时间复杂度的，也是刚get的新技能，那就是亦或，也就是这个东西^,举个栗子,封装一个冒泡排序，普通操作<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">function sortFunc(arr)&#123;</div><div class="line">for(let i = 0; i &lt; arr.length; i++)&#123;</div><div class="line">   for(let j = 0; j &lt;= arr.length - i - 1; j++)&#123;</div><div class="line">       if(arr[j]&gt;arr[j+1])&#123;</div><div class="line">           //普通操作</div><div class="line">           //let wap = arr[j];</div><div class="line">           //arr[j] = arr[j+1];</div><div class="line">           //arr[j+1] = wap;</div><div class="line">    </div><div class="line">           //亦或操作</div><div class="line">           arr[j] = arr[j]^arr[j+1];</div><div class="line">           arr[j+1] = arr[j]^arr[j+1];</div><div class="line">           arr[j] = arr[j]^arr[j+1];</div><div class="line">       &#125;</div><div class="line">   &#125;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><h3 id="2、-选择排序"><a href="#2、-选择排序" class="headerlink" title="2、 选择排序"></a>2、 选择排序</h3><p>每次走一遍数组，找到最大的数字，然后和最后一个做交换<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getMaxIndex</span>(<span class="params">arr,n</span>)</span>&#123;</div><div class="line"><span class="keyword">let</span> max=arr[<span class="number">0</span>];</div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</div><div class="line"><span class="keyword">if</span> (arr[i]&gt;max) &#123;</div><div class="line">max=arr[i]</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> arr.indexOf(max)</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">selectionSort</span>(<span class="params">arr,n</span>)</span>&#123;</div><div class="line"><span class="keyword">let</span> maxIndex,temp;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> j=n;j&gt;<span class="number">0</span>;j--)&#123;</div><div class="line">maxIndex=getMaxIndex(arr,j)</div><div class="line">temp=arr[maxIndex];</div><div class="line">arr[maxIndex]=arr[j<span class="number">-1</span>];</div><div class="line">arr[j<span class="number">-1</span>]=temp;</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> arr</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> arr=[<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">0</span>]</div><div class="line"><span class="built_in">console</span>.log(selectionSort(arr,arr.length))</div></pre></td></tr></table></figure></p><h3 id="3、插入排序"><a href="#3、插入排序" class="headerlink" title="3、插入排序"></a>3、插入排序</h3><p>将一条记录插入到已排好的有序表中，从而得到一个新的、记录数量增1的有序表。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">insert</span>(<span class="params">arr,n</span>)</span>&#123;</div><div class="line"><span class="keyword">let</span> key=arr[n]</div><div class="line"><span class="keyword">let</span> i=n</div><div class="line"><span class="keyword">for</span>(i;arr[i<span class="number">-1</span>]&gt;key;i--)&#123;</div><div class="line"><span class="keyword">if</span>(i&lt;=<span class="number">0</span>)&#123;</div><div class="line"><span class="keyword">return</span></div><div class="line">&#125;</div><div class="line">arr[i]=arr[i<span class="number">-1</span>];</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> arr[i]=key;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">insertSort</span>(<span class="params">arr,n</span>)</span>&#123;</div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</div><div class="line">insert(arr,i)</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> arr</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> arr=[<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">0</span>]</div><div class="line"><span class="built_in">console</span>.log(insertSort(arr,arr.length))</div></pre></td></tr></table></figure></p><h3 id="4、希尔排序"><a href="#4、希尔排序" class="headerlink" title="4、希尔排序"></a>4、希尔排序</h3><p>插入排序的一种又称“缩小增量排序”（Diminishing Increment Sort），是直接插入排序算法的一种更高效的改进版本。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">shellSort</span>(<span class="params">arr</span>) </span>&#123;</div><div class="line">　　<span class="keyword">var</span> len = arr.length,</div><div class="line">　　temp,</div><div class="line">　　gap = <span class="number">1</span>;</div><div class="line">　　<span class="keyword">while</span>(gap &lt; len/<span class="number">5</span>) &#123; </div><div class="line">　　　　gap =gap*<span class="number">5</span>+<span class="number">1</span>;</div><div class="line">　　&#125;</div><div class="line">　　<span class="keyword">for</span> (gap; gap &gt; <span class="number">0</span>; gap = <span class="built_in">Math</span>.floor(gap/<span class="number">5</span>)) &#123;</div><div class="line">　　　　<span class="keyword">for</span> (<span class="keyword">var</span> i = gap; i &lt; len; i++) &#123;</div><div class="line">　　　　　　temp = arr[i];</div><div class="line">　　　　　　<span class="keyword">for</span> (<span class="keyword">var</span> j = i-gap; j &gt;= <span class="number">0</span> &amp;&amp; arr[j] &gt; temp; j-=gap) &#123;</div><div class="line">　　　　　　　　arr[j+gap] = arr[j];</div><div class="line">　　　　　　&#125;</div><div class="line">　　　　　　arr[j+gap] = temp;</div><div class="line">　　　　&#125;</div><div class="line">　　&#125;</div><div class="line">　　<span class="keyword">return</span> arr;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> arr=[<span class="number">3</span>,<span class="number">44</span>,<span class="number">38</span>,<span class="number">5</span>,<span class="number">47</span>,<span class="number">15</span>,<span class="number">36</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">2</span>,<span class="number">46</span>,<span class="number">4</span>,<span class="number">19</span>,<span class="number">50</span>,<span class="number">48</span>];</div><div class="line"><span class="built_in">console</span>.log(shellSort(arr));</div></pre></td></tr></table></figure></p><h3 id="5、归并排序"><a href="#5、归并排序" class="headerlink" title="5、归并排序"></a>5、归并排序</h3><p>将已有序的子序列合并，得到完全有序的序列；即先使每个子序列有序，再使子序列段间有序。若将两个有序表合并成一个有序表，称为二路归并。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">mergeSort</span>(<span class="params">arr</span>) </span>&#123; <span class="comment">//采用自上而下的递归方法</span></div><div class="line">　　<span class="keyword">var</span> len = arr.length;</div><div class="line">　　<span class="keyword">if</span>(len &lt; <span class="number">2</span>) &#123;</div><div class="line">　　　　<span class="keyword">return</span> arr;</div><div class="line">　　&#125;</div><div class="line">　　<span class="keyword">var</span> middle = <span class="built_in">Math</span>.floor(len / <span class="number">2</span>),</div><div class="line">　　left = arr.slice(<span class="number">0</span>, middle),</div><div class="line">　　right = arr.slice(middle);</div><div class="line">　　<span class="keyword">return</span> merge(mergeSort(left), mergeSort(right));</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">merge</span>(<span class="params">left, right</span>)</span>&#123;</div><div class="line">　　<span class="keyword">var</span> result = [];</div><div class="line">　　<span class="keyword">while</span> (left.length &amp;&amp; right.length) &#123;</div><div class="line">　　　　<span class="keyword">if</span> (left[<span class="number">0</span>] &lt;= right[<span class="number">0</span>]) &#123;</div><div class="line">　　　　　　result.push(left.shift());</div><div class="line">　　　　&#125; <span class="keyword">else</span> &#123;</div><div class="line">　　　　　　result.push(right.shift());</div><div class="line">　　　　&#125;</div><div class="line">　　&#125;</div><div class="line"> </div><div class="line">　　<span class="keyword">while</span> (left.length)&#123;</div><div class="line">　　　　result.push(left.shift());</div><div class="line">　　&#125;</div><div class="line">　　<span class="keyword">while</span> (right.length)&#123;</div><div class="line">　　　　result.push(right.shift());</div><div class="line">　　&#125;</div><div class="line">　　<span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> arr=[<span class="number">3</span>,<span class="number">44</span>,<span class="number">38</span>,<span class="number">5</span>,<span class="number">47</span>,<span class="number">15</span>,<span class="number">36</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">2</span>,<span class="number">46</span>,<span class="number">4</span>,<span class="number">19</span>,<span class="number">50</span>,<span class="number">48</span>];</div><div class="line"><span class="built_in">console</span>.log(mergeSort(arr));</div></pre></td></tr></table></figure></p><h3 id="6、快速排序"><a href="#6、快速排序" class="headerlink" title="6、快速排序"></a>6、快速排序</h3><p>通过一趟排序将要排序的数据分割成独立的两部分,其中一部分的所有数据都比另外一部分的所有数据都要小,然后再按此方法对这两部分数据分别进行快速排序,整个排序过程可以递归进行,<br>以此达到整个数据变成有序序列<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">quickSort</span>(<span class="params">array, left, right</span>) </span>&#123;</div><div class="line">　　<span class="keyword">if</span> (left &lt; right) &#123;</div><div class="line">　　　　<span class="keyword">var</span> x = array[right], i = left - <span class="number">1</span>, temp;</div><div class="line">　　　　<span class="keyword">for</span> (<span class="keyword">var</span> j = left; j &lt;= right; j++) &#123;</div><div class="line">　　　　　　<span class="keyword">if</span> (array[j] &lt;= x) &#123;</div><div class="line">　　　　　　　　i++;</div><div class="line">　　　　　　　　temp = array[i];</div><div class="line">　　　　　　　　array[i] = array[j];</div><div class="line">　　　　　　　　array[j] = temp;</div><div class="line">　　　　　　&#125;</div><div class="line">　　　　&#125;</div><div class="line">　　　　<span class="built_in">console</span>.log(array) ;</div><div class="line">　　　　<span class="built_in">console</span>.log(left,i) ;</div><div class="line">　　　　quickSort(array, left, i - <span class="number">1</span>);</div><div class="line">　　　　<span class="built_in">console</span>.log(array)</div><div class="line">　　　　<span class="built_in">console</span>.log(i,right)</div><div class="line">　　　　quickSort(array, i + <span class="number">1</span>, right);</div><div class="line">　　&#125;</div><div class="line">　　<span class="built_in">console</span>.log(array)</div><div class="line">　　<span class="keyword">return</span> array;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> arr=[<span class="number">3</span>,<span class="number">44</span>,<span class="number">38</span>,<span class="number">5</span>,<span class="number">47</span>,<span class="number">15</span>,<span class="number">36</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">2</span>,<span class="number">46</span>,<span class="number">4</span>,<span class="number">19</span>,<span class="number">50</span>,<span class="number">48</span>];</div><div class="line"><span class="built_in">console</span>.log(quickSort(arr,<span class="number">0</span>,arr.length<span class="number">-1</span>));</div></pre></td></tr></table></figure></p><h3 id="7、堆排序"><a href="#7、堆排序" class="headerlink" title="7、堆排序"></a>7、堆排序</h3><p>Heapsort是指利用堆这种数据结构所设计的一种排序算法。堆是一个近似完全二叉树的结构，并同时满足堆积的性质：即子结点的键值或索引总是小于（或者大于）它的父节点<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">heapSort</span>(<span class="params">array</span>) </span>&#123;</div><div class="line">　　<span class="keyword">var</span> heapSize = array.length, temp;</div><div class="line">　　<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="built_in">Math</span>.floor(heapSize / <span class="number">2</span>) - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;　　</div><div class="line">　　　　heapify(array, i, heapSize);</div><div class="line">　　&#125;</div><div class="line">　　<span class="comment">//堆排序</span></div><div class="line">　　<span class="keyword">for</span> (<span class="keyword">var</span> j = heapSize - <span class="number">1</span>; j &gt;= <span class="number">1</span>; j--) &#123;</div><div class="line">　　　　temp = array[<span class="number">0</span>];</div><div class="line">　　　　array[<span class="number">0</span>] = array[j];</div><div class="line">　　　　array[j] = temp;</div><div class="line">　　　　<span class="built_in">console</span>.log(array)</div><div class="line">　　　　heapify(array, <span class="number">0</span>, --heapSize);</div><div class="line">　　&#125;</div><div class="line">　　<span class="keyword">return</span> array;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">heapify</span>(<span class="params">arr, x, len</span>) </span>&#123;</div><div class="line">　　<span class="keyword">var</span> l = <span class="number">2</span> * x + <span class="number">1</span>, r = <span class="number">2</span> * x + <span class="number">2</span>, largest = x, temp;</div><div class="line">　　<span class="keyword">if</span> (l &lt; len &amp;&amp; arr[l] &gt; arr[largest]) &#123;</div><div class="line">　　　　largest = l;</div><div class="line">　　&#125;</div><div class="line">　　<span class="keyword">if</span> (r &lt; len &amp;&amp; arr[r] &gt; arr[largest]) &#123;</div><div class="line">　　　　largest = r;</div><div class="line">　　&#125;</div><div class="line">　　<span class="keyword">if</span> (largest != x) &#123;</div><div class="line">　　　　temp = arr[x];</div><div class="line">　　　　arr[x] = arr[largest];</div><div class="line">　　　　arr[largest] = temp;</div><div class="line">　　　　<span class="built_in">console</span>.log(arr)</div><div class="line">　　　　heapify(arr, largest, len);</div><div class="line">　　&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> arr=[<span class="number">91</span>,<span class="number">60</span>,<span class="number">96</span>,<span class="number">13</span>,<span class="number">35</span>,<span class="number">65</span>,<span class="number">46</span>,<span class="number">65</span>,<span class="number">10</span>,<span class="number">30</span>,<span class="number">20</span>,<span class="number">31</span>,<span class="number">77</span>,<span class="number">81</span>,<span class="number">22</span>];</div><div class="line"><span class="built_in">console</span>.log(heapSort(arr));</div></pre></td></tr></table></figure></p><h3 id="8、计数排序"><a href="#8、计数排序" class="headerlink" title="8、计数排序"></a>8、计数排序</h3><p>对于给定的输入序列中的每一个元素x，确定该序列中值小于x的元素的个数（此处并非比较各元素的大小，而是通过对元素值的计数和计数值的累加来确定）。一旦有了这个信息，就可以将x直<br>接存放到最终的输出序列的正确位置上。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">countingSort</span>(<span class="params">array</span>) </span>&#123;</div><div class="line">　　<span class="keyword">var</span> len = array.length,</div><div class="line">　　B = [],</div><div class="line">　　C = [],</div><div class="line">　　min = max = array[<span class="number">0</span>];</div><div class="line">　　<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</div><div class="line">　　　　min = min &lt;= array[i] ? min : array[i];</div><div class="line">　　　　max = max &gt;= array[i] ? max : array[i];</div><div class="line">　　　　C[array[i]] = C[array[i]] ? C[array[i]] + <span class="number">1</span> : <span class="number">1</span>;</div><div class="line">　　　　<span class="built_in">console</span>.log(C)</div><div class="line">　　&#125;</div><div class="line">　　<span class="keyword">for</span> (<span class="keyword">var</span> j = min; j &lt; max; j++) &#123;</div><div class="line">　　　　C[j + <span class="number">1</span>] = (C[j + <span class="number">1</span>] || <span class="number">0</span>) + (C[j] || <span class="number">0</span>);</div><div class="line">　　　　<span class="built_in">console</span>.log(C)</div><div class="line">　　&#125;</div><div class="line">　　<span class="keyword">for</span> (<span class="keyword">var</span> k = len - <span class="number">1</span>; k &gt;= <span class="number">0</span>; k--) &#123;</div><div class="line">　　　　B[C[array[k]] - <span class="number">1</span>] = array[k];</div><div class="line">　　　　C[array[k]]--;</div><div class="line">　　　　<span class="built_in">console</span>.log(B)</div><div class="line">　　&#125;</div><div class="line">　　<span class="keyword">return</span> B;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> arr = [<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">2</span>];</div><div class="line"><span class="built_in">console</span>.log(countingSort(arr));</div></pre></td></tr></table></figure></p><h3 id="9、桶排序"><a href="#9、桶排序" class="headerlink" title="9、桶排序"></a>9、桶排序</h3><p>将数组分到有限数量的桶子里。每个桶子再个别排序（有可能再使用别的排序算法或是以递归方式继续使用桶排序进行排序）。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bucketSort</span>(<span class="params">array, num</span>) </span>&#123;</div><div class="line">　　<span class="keyword">if</span> (array.length &lt;= <span class="number">1</span>) &#123;</div><div class="line">　　　　<span class="keyword">return</span> array;</div><div class="line">　　&#125;</div><div class="line">　　<span class="keyword">var</span> len = array.length, buckets = [], result = [], min = max = array[<span class="number">0</span>], space, n = <span class="number">0</span>;</div><div class="line"></div><div class="line">　　<span class="keyword">var</span> index = <span class="built_in">Math</span>.floor(len / num) ;</div><div class="line">　　<span class="keyword">while</span>(index&lt;<span class="number">2</span>)&#123;</div><div class="line"></div><div class="line">　　　　num--;</div><div class="line">　　　　index = <span class="built_in">Math</span>.floor(len / num) ;</div><div class="line">　　&#125;</div><div class="line"></div><div class="line">　　<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; len; i++) &#123;</div><div class="line">　　　　min = min &lt;= array[i] ? min : array[i];</div><div class="line">　　　　max = max &gt;= array[i] ? max : array[i];</div><div class="line">　　&#125;</div><div class="line">　　space = (max - min + <span class="number">1</span>) / num;  <span class="comment">//步长</span></div><div class="line">　　<span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; len; j++) &#123;</div><div class="line">　　　　<span class="keyword">var</span> index = <span class="built_in">Math</span>.floor((array[j] - min) / space);</div><div class="line">　　　　<span class="keyword">if</span> (buckets[index]) &#123; <span class="comment">// 非空桶，插入排序</span></div><div class="line">　　　　　　<span class="keyword">var</span> k = buckets[index].length - <span class="number">1</span>;</div><div class="line">　　　　　　<span class="keyword">while</span> (k &gt;= <span class="number">0</span> &amp;&amp; buckets[index][k] &gt; array[j]) &#123;</div><div class="line">　　　　　　　　buckets[index][k + <span class="number">1</span>] = buckets[index][k];</div><div class="line">　　　　　　　　k--;</div><div class="line">　　　　　　&#125;</div><div class="line">　　　　　　buckets[index][k + <span class="number">1</span>] = array[j];</div><div class="line">　　　　&#125; <span class="keyword">else</span> &#123; <span class="comment">//空桶，初始化</span></div><div class="line">　　　　　　buckets[index] = [];</div><div class="line">　　　　　　buckets[index].push(array[j]);</div><div class="line">　　　　&#125;</div><div class="line">　　&#125;</div><div class="line">　　<span class="keyword">while</span> (n &lt; num) &#123;</div><div class="line">　　　　result = result.concat(buckets[n]);</div><div class="line">　　　　n++;</div><div class="line">　　&#125;</div><div class="line">　　<span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> arr=[<span class="number">3</span>,<span class="number">44</span>,<span class="number">38</span>,<span class="number">5</span>,<span class="number">47</span>,<span class="number">15</span>,<span class="number">36</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">2</span>,<span class="number">46</span>,<span class="number">4</span>,<span class="number">19</span>,<span class="number">50</span>,<span class="number">48</span>];</div><div class="line"><span class="built_in">console</span>.log(bucketSort(arr,<span class="number">4</span>));</div></pre></td></tr></table></figure></p><h3 id="10、基数排序"><a href="#10、基数排序" class="headerlink" title="10、基数排序"></a>10、基数排序</h3><p>透过键值的部份资讯，将要排序的元素分配至某些“桶”中，藉以达到排序的作用，基数排序法是属于稳定性的排序，其时间复杂度为O (nlog(r)m)<br>，其中r为所采取的基数，而m为堆数，在某些时候，基数排序法的效率高于其它的稳定性排序法。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">radixSort</span>(<span class="params">arr, maxDigit</span>) </span>&#123;</div><div class="line">　　<span class="keyword">var</span> mod = <span class="number">10</span>;</div><div class="line">　　<span class="keyword">var</span> dev = <span class="number">1</span>;</div><div class="line">　　<span class="keyword">var</span> counter = [];</div><div class="line">　　<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; maxDigit; i++, dev *= <span class="number">10</span>, mod *= <span class="number">10</span>) &#123;</div><div class="line">　　　　<span class="keyword">for</span>(<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; arr.length; j++) &#123;</div><div class="line">　　　　　　<span class="keyword">var</span> bucket = <span class="built_in">parseInt</span>((arr[j] % mod) / dev);</div><div class="line">　　　　　　<span class="keyword">if</span>(counter[bucket]== <span class="literal">null</span>) &#123;</div><div class="line">　　　　　　　　counter[bucket] = [];</div><div class="line">　　　　　　&#125;</div><div class="line">　　　　counter[bucket].push(arr[j]);</div><div class="line">　　　　&#125;</div><div class="line">　　　　<span class="keyword">var</span> pos = <span class="number">0</span>;</div><div class="line">　　　　<span class="keyword">for</span>(<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; counter.length; j++) &#123;</div><div class="line">　　　　　　<span class="keyword">var</span> value = <span class="literal">null</span>;</div><div class="line">　　　　　　<span class="keyword">if</span>(counter[j]!=<span class="literal">null</span>) &#123;</div><div class="line">　　　　　　　　<span class="keyword">while</span> ((value = counter[j].shift()) != <span class="literal">null</span>) &#123;</div><div class="line">　　　　　　　　　　arr[pos++] = value;</div><div class="line">　　　　　　　　&#125;</div><div class="line">　　　　　　&#125;</div><div class="line">　　　　&#125;</div><div class="line">　　&#125;</div><div class="line">　　<span class="keyword">return</span> arr;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> arr = [<span class="number">3</span>, <span class="number">44</span>, <span class="number">38</span>, <span class="number">5</span>, <span class="number">47</span>, <span class="number">15</span>, <span class="number">36</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">2</span>, <span class="number">46</span>, <span class="number">4</span>, <span class="number">19</span>, <span class="number">50</span>, <span class="number">48</span>];</div><div class="line"><span class="built_in">console</span>.log(radixSort(arr,<span class="number">2</span>));</div></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;跟随Google大佬的脚步。。。（一如既往的跟不上）&lt;/p&gt;
&lt;p&gt;&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;//music.163.com/outchain/player?type=2&amp;id=486412012&amp;auto=0&amp;height=66&quot;&gt;&lt;/iframe&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="算法" scheme="http://yoursite.com/tags/%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>二叉树算法原理</title>
    <link href="http://yoursite.com/2018/12/05/%E4%BA%8C%E5%8F%89%E6%A0%91%E7%AE%97%E6%B3%95%E5%8E%9F%E7%90%86/"/>
    <id>http://yoursite.com/2018/12/05/二叉树算法原理/</id>
    <published>2018-12-04T16:08:31.000Z</published>
    <updated>2020-01-13T15:30:37.137Z</updated>
    
    <content type="html"><![CDATA[<p>二叉树原理手记。</p><p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=865014922&auto=0&height=66"></iframe><br><a id="more"></a></p><blockquote><p>二叉树是一个连通的无环图，并且每一个顶点的度不大于3。有根二叉树还要满足根结点的度不大于2。有了根结点之后，每个顶点定义了唯一的父结点，和最多2个子结<br>点。然而，没有足够的信息来区分左结点和右结点。如果不考虑连通性，允许图中有多个连通分量，这样的结构叫做森林。二叉树是由n（n&gt;=0）个结点组成的有序集合<br>集合或者为空，或者是由一个根节点加上两棵分别称为左子树和右子树的、互不相交的二叉树组成。</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/binarytree/1.JPG" alt="“二叉树”" title="">                </div>                <div class="image-caption">“二叉树”</div>            </figure>  <h3 id="设计二叉树逻辑"><a href="#设计二叉树逻辑" class="headerlink" title="设计二叉树逻辑"></a>设计二叉树逻辑</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">BinaryTree</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="comment">//定义节点</span></div><div class="line"><span class="keyword">var</span> Node=<span class="function"><span class="keyword">function</span>(<span class="params">key</span>)</span>&#123;</div><div class="line"><span class="keyword">this</span>.key=key;</div><div class="line"><span class="keyword">this</span>.left=<span class="literal">null</span>;</div><div class="line"><span class="keyword">this</span>.right=<span class="literal">null</span>;</div><div class="line">&#125;;</div><div class="line"><span class="comment">//定义一个根节点</span></div><div class="line"><span class="keyword">var</span> root=<span class="literal">null</span>;</div><div class="line"><span class="comment">//node老节点,newNode新节点（要插入一个新节点的时候，如果新节点比当前的老节点的值要小，那么就可以把新节点放到老节点的左边）</span></div><div class="line"><span class="keyword">var</span> insertNode=<span class="function"><span class="keyword">function</span>(<span class="params">node,newNode</span>)</span>&#123;  </div><div class="line"><span class="keyword">if</span> (node.key&gt;newNode.key) &#123;   <span class="comment">//如果新节点小于老节点或者</span></div><div class="line"><span class="keyword">if</span> (node.left===<span class="literal">null</span>) &#123;    <span class="comment">//如果新节点还没有左节点的话</span></div><div class="line">node.left=newNode;     <span class="comment">//可以把新节点当作老节点的左孩子</span></div><div class="line">&#125;<span class="keyword">else</span>&#123;   <span class="comment">//如果已经有左孩子了，就将这个新节点插入到左节点的左边部分</span></div><div class="line">insertNode(node.left,newNode);</div><div class="line">&#125;</div><div class="line">&#125;<span class="keyword">else</span>&#123;    <span class="comment">//如果新节点大于老节点、，就插入老节点右边部分</span></div><div class="line"><span class="keyword">if</span>(node.right===<span class="literal">null</span>)&#123;   <span class="comment">//看老节点右边部分是不是为空</span></div><div class="line">node.right=newNode;   <span class="comment">//如果老节点右边为空，就把这个新节点作为老节点的右孩子</span></div><div class="line">&#125;<span class="keyword">else</span>&#123;    <span class="comment">//如果右孩子不为空的话，继续往右边添加</span></div><div class="line">insertNode(node.right,newNode);                                         <span class="comment">//到此为止，整个树的插入逻辑就设计完成了</span></div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">this</span>.insert=<span class="function"><span class="keyword">function</span>(<span class="params">key</span>)</span>&#123;   <span class="comment">//专门用来插入节点</span></div><div class="line"><span class="keyword">var</span> newNode=<span class="keyword">new</span> Node(key)  <span class="comment">//根据传进来的节点数值，构造一个节点对象</span></div><div class="line"><span class="keyword">if</span> (root===<span class="literal">null</span>) &#123;       <span class="comment">//如果此时根节点是空</span></div><div class="line">root=newNode;        <span class="comment">//新插入的节点就是根节点</span></div><div class="line">&#125;<span class="keyword">else</span>&#123;                  <span class="comment">//否则根据排序二叉树的特性插入新的节点</span></div><div class="line">insertNode(root,newNode)    <span class="comment">//插入新节点的方法</span></div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="树逻辑设计完成之后，构造一系列节点，来调用这个二叉树的接口，进行节点插入的过程"><a href="#树逻辑设计完成之后，构造一系列节点，来调用这个二叉树的接口，进行节点插入的过程" class="headerlink" title="树逻辑设计完成之后，构造一系列节点，来调用这个二叉树的接口，进行节点插入的过程"></a>树逻辑设计完成之后，构造一系列节点，来调用这个二叉树的接口，进行节点插入的过程</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> ndoes=[<span class="number">8</span>,<span class="number">3</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">6</span>,<span class="number">14</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">13</span>];   <span class="comment">//构造一个数组定义插入节点的数值</span></div><div class="line"><span class="keyword">var</span> binaryTree=<span class="keyword">new</span> BinaryTree();    <span class="comment">//实例化一个BinaryTree</span></div><div class="line"><span class="comment">//然后依次把数组中的数值插入二叉树，插入完之后，完整的二叉树就构成了</span></div><div class="line">ndoes.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">key</span>)</span>&#123;</div><div class="line">    binaryTree.insert(key)</div><div class="line">&#125;)</div></pre></td></tr></table></figure><p>一开始二叉树是空的，所以第一次插入节点的时候节点8就成了根节点，也就是起始二叉树的根节点<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/binarytree/2.JPG" alt="“进入的第一个节点”" title="">                </div>                <div class="image-caption">“进入的第一个节点”</div>            </figure><br>用chrome调试可以看到二叉树生成的过程<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/binarytree/3.JPG" alt="“根节点8”" title="">                </div>                <div class="image-caption">“根节点8”</div>            </figure><br>第二个节点3进来的时候会和根节点比较，然后成为节点8的左孩子<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/binarytree/4.JPG" alt="“左孩子3”" title="">                </div>                <div class="image-caption">“左孩子3”</div>            </figure><br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/binarytree/5.JPG" alt="“左孩子3”" title="">                </div>                <div class="image-caption">“左孩子3”</div>            </figure><br>第三次进来的时候是节点10，节点10会和8比对，发现比8大并且节点8的右孩子节点为空，所以节点10就成了节点8的右孩子<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/binarytree/6.JPG" alt="“左孩子3”" title="">                </div>                <div class="image-caption">“左孩子3”</div>            </figure><br>第四次进来的是节点1，此时二叉树已经有了根节点8以及左孩子3，右孩子10，然后进来的1比8小，而且此时已经有了左孩子3,左孩子3此时是没有左右孩子节点的，所以进来的1成了3的左孩子<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/binarytree/7.JPG" alt="“左孩子1”" title="">                </div>                <div class="image-caption">“左孩子1”</div>            </figure><br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/binarytree/8.JPG" alt="“左孩子1进来的时候和8比对”" title="">                </div>                <div class="image-caption">“左孩子1进来的时候和8比对”</div>            </figure><br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/binarytree/9.JPG" alt="“左孩子1和8比对之后和3比对”" title="">                </div>                <div class="image-caption">“左孩子1和8比对之后和3比对”</div>            </figure><br>第五次加入的是节点6，由于节点6是小于节点8的并且大于此时节点8的左孩子节点3，所以就成了此时空着的节点3的右节点<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/binarytree/10.JPG" alt="“根节点8的左子树3的右孩子”" title="">                </div>                <div class="image-caption">“根节点8的左子树3的右孩子”</div>            </figure><br>它的过程是6进来的时候和8比对，然后8此时有了左孩子3，然后6和3比对，6&gt;3而且此时3没有右孩子，所以就成了3的右孩子<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/binarytree/11.JPG" alt="“6和8比对”" title="">                </div>                <div class="image-caption">“6和8比对”</div>            </figure><br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/binarytree/12.JPG" alt="“6和3比对”" title="">                </div>                <div class="image-caption">“6和3比对”</div>            </figure><br>第六次进来的是节点14，由于节点14大于节点8所以走右边，因为节点8的右孩子此时是10,14大于10而且节点10此时没有右孩子，所以就成了节点10的右孩子<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/binarytree/13.JPG" alt="“此时的二叉树”" title="">                </div>                <div class="image-caption">“此时的二叉树”</div>            </figure><br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/binarytree/14.JPG" alt="“14和8比对”" title="">                </div>                <div class="image-caption">“14和8比对”</div>            </figure><br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/binarytree/15.JPG" alt="“14和10比对”" title="">                </div>                <div class="image-caption">“14和10比对”</div>            </figure><br>以此类推，最后根据给的数组生成了一颗二叉树<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/binarytree/16.JPG" alt="“生成的排序二叉树”" title="">                </div>                <div class="image-caption">“生成的排序二叉树”</div>            </figure><br>有了一棵构建好的排序二叉树之后，可以用遍历获取二叉树中每个节点的信息，遍历分三种方法，中序遍历、前序遍历、后序遍历</p><h3 id="中序遍历"><a href="#中序遍历" class="headerlink" title="中序遍历"></a>中序遍历</h3><p>中序遍历（LDR）是二叉树遍历的一种，也叫做中根遍历、中序周游。在二叉树中，中序遍历首先遍历左子树，然后访问根结点，最后遍历右子树。<br>假如此时我处于某一个节点，处于这个节点的时候，我先看左孩子有没有，如果有的话，遍历整棵左子树，遍历完整棵左子树之后再返回来输出当前节点，输出完之后<br>再去遍历整棵右子树，遍历完之后，一个节点的左子树和右子树以及它本身就都被遍历完了，然后它沿着箭头向它的父节点遍历，依赖这个中序遍历的话实际上是以升<br>序的方式访问整个二叉树的节点</p><h4 id="给BinaryTree增加一个中序遍历的接口"><a href="#给BinaryTree增加一个中序遍历的接口" class="headerlink" title="给BinaryTree增加一个中序遍历的接口"></a>给BinaryTree增加一个中序遍历的接口</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> inOrderTraverseNode=<span class="function"><span class="keyword">function</span>(<span class="params">node,callback</span>)</span>&#123;    <span class="comment">//node=二叉树的节点对象,callback=普通回调函数</span></div><div class="line"><span class="keyword">if</span>(node!==<span class="literal">null</span>)&#123;   <span class="comment">//如果节点不为空的话</span></div><div class="line">    inOrderTraverseNode(node.left,callback)  <span class="comment">//访问它的左子树</span></div><div class="line">    callback(node.key)   <span class="comment">//访问完左子树之后访问当前节点，然后把当前节点的值传入回调函数中</span></div><div class="line">    inOrderTraverseNode(node.right,callback)  <span class="comment">//继续访问当前节点的右子树</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//callback=待会要输出某个节点的值得时候，把这个节点的值传入到这个回调函数中，让这个回调函数决定如何输出</span></div><div class="line"><span class="keyword">this</span>.inOrderTraverse=<span class="function"><span class="keyword">function</span>(<span class="params">callback</span>)</span>&#123;        </div><div class="line">inOrderTraverseNode(root,callback)   <span class="comment">//从根节点开始遍历</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> callback=<span class="function"><span class="keyword">function</span>(<span class="params">key</span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(key)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//调BinaryTree的中序接口</span></div><div class="line">binaryTree.inOrderTraverse(callback)</div></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/binarytree/a.gif" alt="“打断点调试”" title="">                </div>                <div class="image-caption">“打断点调试”</div>            </figure><h3 id="前序遍历"><a href="#前序遍历" class="headerlink" title="前序遍历"></a>前序遍历</h3><p>前序遍历（DLR），是二叉树遍历的一种，也叫做先根遍历、先序遍历、前序周游，可记做根左右。前序遍历首先访问根结点然后遍历左子树，最后遍历右子树。</p><h4 id="给BinaryTree增加一个前序遍历的接口"><a href="#给BinaryTree增加一个前序遍历的接口" class="headerlink" title="给BinaryTree增加一个前序遍历的接口"></a>给BinaryTree增加一个前序遍历的接口</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> preOrderTraverseNode=<span class="function"><span class="keyword">function</span>(<span class="params">node,callback</span>)</span>&#123;</div><div class="line"><span class="keyword">if</span>(node!==<span class="literal">null</span>)&#123;</div><div class="line">callback(node.key)</div><div class="line">preOrderTraverseNode(node.left,callback)   <span class="comment">//遍历该节点左子树</span></div><div class="line">preOrderTraverseNode(node.right,callback)  <span class="comment">//遍历该节点的右子树</span></div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">this</span>.preOrderTraverse=<span class="function"><span class="keyword">function</span>(<span class="params">callback</span>)</span>&#123;</div><div class="line">preOrderTraverseNode(root,callback)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//调BinaryTree的前序接口</span></div><div class="line">binaryTree.preOrderTraverse(callback)</div></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/binarytree/b.gif" alt="“打断点调试”" title="">                </div>                <div class="image-caption">“打断点调试”</div>            </figure><h3 id="后序遍历"><a href="#后序遍历" class="headerlink" title="后序遍历"></a>后序遍历</h3><p>后序遍历（LRD）是二叉树遍历的一种，也叫做后根遍历、后序周游，可记做左右根。后序遍历有递归算法和非递归算法两种。在二叉树中，先左后右再根，即首先遍历<br>左子树，然后遍历右子树，最后访问根结点。</p><h4 id="给BinaryTree增加一个后序遍历的接口"><a href="#给BinaryTree增加一个后序遍历的接口" class="headerlink" title="给BinaryTree增加一个后序遍历的接口"></a>给BinaryTree增加一个后序遍历的接口</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> postOrderTraverseNode=<span class="function"><span class="keyword">function</span>(<span class="params">node,callback</span>)</span>&#123;</div><div class="line"><span class="keyword">if</span> (node!==<span class="literal">null</span>) &#123;</div><div class="line">postOrderTraverseNode(node.left,callback) <span class="comment">//先遍历当前节点的左子树</span></div><div class="line">postOrderTraverseNode(node.right,callback) <span class="comment">//遍历完左子树之后遍历右子树</span></div><div class="line">callback(node.key)   <span class="comment">//遍历完之后输出节点的值</span></div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">this</span>.postOrderTraverse=<span class="function"><span class="keyword">function</span>(<span class="params">callback</span>)</span>&#123;</div><div class="line">postOrderTraverseNode(root,callback)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//调BinaryTree的前序接口</span></div><div class="line">binaryTree.postOrderTraverse(callback)</div></pre></td></tr></table></figure><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/binarytree/c.gif" alt="“打断点调试”" title="">                </div>                <div class="image-caption">“打断点调试”</div>            </figure><h3 id="二叉树节点查找"><a href="#二叉树节点查找" class="headerlink" title="二叉树节点查找"></a>二叉树节点查找</h3><p>主要是看某个给定数值的节点是否在二叉树中存在，设想开发作战游戏，飞机发出导弹的运行轨迹在不断改变，那它能否击中外星人了，这样就把外星人的坐标当成<br>一个二叉树，导弹前进的时候坐标也在变化，导弹每前进一次，坐标变化之后就在外星人坐标的二叉树中查找，如果导弹的坐标和外星人在二叉树中的坐标重合的话<br>，也就是说，在二叉树中找到了一个数值和导弹的数值是一样的，也就是击中了，要是找不到的话，就说明导弹击不中外星人</p><h4 id="二叉树的节点查找分三种"><a href="#二叉树的节点查找分三种" class="headerlink" title="二叉树的节点查找分三种"></a>二叉树的节点查找分三种</h4><p>1、查找二叉树最小节点，从当前节点出发查找节点左子树<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//查找二叉树最小节点接口</span></div><div class="line"><span class="keyword">var</span> minNode=<span class="function"><span class="keyword">function</span>(<span class="params">node</span>)</span>&#123;</div><div class="line"><span class="keyword">if</span>(node)&#123;</div><div class="line"><span class="keyword">while</span>(node&amp;&amp;node.left!==<span class="literal">null</span>)&#123;</div><div class="line">node=node.left</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> node.key</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> <span class="literal">null</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">this</span>.min=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="keyword">return</span> minNode(root)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">`二叉树的最小节点是<span class="subst">$&#123;binaryTree.min()&#125;</span>`</span>)</div></pre></td></tr></table></figure></p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/binarytree/d.gif" alt="“打断点调试”" title="">                </div>                <div class="image-caption">“打断点调试”</div>            </figure><p>2、查找二叉树最大节点，从当前节点出发查找节点右子树<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//查找二叉树最大节点接口</span></div><div class="line"><span class="keyword">var</span> maxNode=<span class="function"><span class="keyword">function</span>(<span class="params">node</span>)</span>&#123;</div><div class="line"><span class="keyword">if</span> (node) &#123;</div><div class="line"><span class="keyword">while</span>(node&amp;&amp;node.right!==<span class="literal">null</span>)&#123;</div><div class="line">node=node.right</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> node.key</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> <span class="literal">null</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">this</span>.max=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="keyword">return</span> maxNode(root)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">`二叉树的最小节点是<span class="subst">$&#123;binaryTree.max()&#125;</span>`</span>)</div></pre></td></tr></table></figure></p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/binarytree/e.gif" alt="“打断点调试”" title="">                </div>                <div class="image-caption">“打断点调试”</div>            </figure><p>3、给定某个节点数值，然后和根节点进行比对大小，大的话从右子树继续比对，小的话就是左子树，如果是一样的话，直接返回当前节点的值，如果没找到可以认为是查找失败<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//查找给定的节点</span></div><div class="line"><span class="keyword">var</span> searchNode=<span class="function"><span class="keyword">function</span>(<span class="params">node,key</span>)</span>&#123;</div><div class="line"><span class="keyword">if</span> (node===<span class="literal">null</span>) &#123;</div><div class="line"><span class="keyword">return</span> <span class="literal">false</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (node.key&gt;key) &#123;</div><div class="line"><span class="keyword">return</span> searchNode(node.left,key)</div><div class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span> (node.key&lt;key) &#123;</div><div class="line"><span class="keyword">return</span> searchNode(node.right,key)</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">return</span> <span class="literal">true</span></div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">this</span>.search=<span class="function"><span class="keyword">function</span>(<span class="params">key</span>)</span>&#123;</div><div class="line"><span class="keyword">return</span> searchNode(root,key)</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(binaryTree.search(<span class="number">6</span>)?<span class="string">`key is 6`</span>:<span class="string">`not found`</span>)   <span class="comment">//6是二叉树中有的节点</span></div><div class="line"><span class="built_in">console</span>.log(binaryTree.search(<span class="number">16</span>)?<span class="string">`key is 16`</span>:<span class="string">`not found`</span>)   <span class="comment">//16是二叉树中没有的节点</span></div></pre></td></tr></table></figure></p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/binarytree/f.gif" alt="“打断点调试”" title="">                </div>                <div class="image-caption">“打断点调试”</div>            </figure><h3 id="二叉树节点删除"><a href="#二叉树节点删除" class="headerlink" title="二叉树节点删除"></a>二叉树节点删除</h3><h4 id="删除只有一个子树的节点"><a href="#删除只有一个子树的节点" class="headerlink" title="删除只有一个子树的节点"></a>删除只有一个子树的节点</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//接口</span></div><div class="line"><span class="keyword">var</span> removeNode=<span class="function"><span class="keyword">function</span>(<span class="params">node,key</span>)</span>&#123;</div><div class="line"><span class="keyword">if</span> (node===<span class="literal">null</span>) &#123;</div><div class="line"><span class="keyword">return</span> <span class="literal">null</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (key&lt;node.key) &#123;</div><div class="line">node.left=removeNode(node.left,key)</div><div class="line"><span class="keyword">return</span> node</div><div class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span> (key&gt;node.key) &#123;</div><div class="line">node.right=removeNode(node.right,key)</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">if</span> (node.left===<span class="literal">null</span>&amp;&amp;node.right===<span class="literal">null</span>) &#123;</div><div class="line">node=<span class="literal">null</span></div><div class="line"><span class="keyword">return</span> node</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (node.left===<span class="literal">null</span>) &#123;</div><div class="line">node=node.right</div><div class="line"><span class="keyword">return</span> node</div><div class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span> (node.right===<span class="literal">null</span>) &#123;</div><div class="line">node=node.left</div><div class="line"><span class="keyword">return</span> node</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">this</span>.remove=<span class="function"><span class="keyword">function</span>(<span class="params">key</span>)</span>&#123;</div><div class="line">removeNode(root,key)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//调接口</span></div><div class="line">binaryTree.remove(<span class="number">10</span>)    <span class="comment">//删除节点10</span></div></pre></td></tr></table></figure><p>假如删除的节点含有左右子树的话，就要从被删除节点的右子树中找到最小的子节点，然后将要删除的节点的值换成找到的最小的子节点的值，这样二叉树里面就有<br>两个相同的节点，这时候就要把最小子节点去掉，做完这些步骤之后二叉树仍然是保持平衡性质的，这时候接口可以改成<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> findMinNode=<span class="function"><span class="keyword">function</span>(<span class="params">node</span>)</span>&#123;</div><div class="line"><span class="keyword">if</span> (node) &#123;</div><div class="line"><span class="keyword">while</span>(node&amp;&amp;node.left!==<span class="literal">null</span>)&#123;</div><div class="line">node=node.left</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> node</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> node</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> removeNode=<span class="function"><span class="keyword">function</span>(<span class="params">node,key</span>)</span>&#123;</div><div class="line"><span class="keyword">if</span> (node===<span class="literal">null</span>) &#123;</div><div class="line"><span class="keyword">return</span> <span class="literal">null</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (key&lt;node.key) &#123;</div><div class="line">node.left=removeNode(node.left,key)</div><div class="line"><span class="keyword">return</span> node</div><div class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span> (key&gt;node.key) &#123;</div><div class="line">node.right=removeNode(node.right,key)</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line"><span class="keyword">if</span> (node.left===<span class="literal">null</span>&amp;&amp;node.right===<span class="literal">null</span>) &#123;</div><div class="line">node=<span class="literal">null</span></div><div class="line"><span class="keyword">return</span> node</div><div class="line">&#125;</div><div class="line"><span class="keyword">if</span> (node.left===<span class="literal">null</span>) &#123;</div><div class="line">node=node.right</div><div class="line"><span class="keyword">return</span> node</div><div class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span> (node.right===<span class="literal">null</span>) &#123;</div><div class="line">node=node.left</div><div class="line"><span class="keyword">return</span> node</div><div class="line">&#125;</div><div class="line"><span class="comment">//执行到这里就说明这是有两个子树的节点</span></div><div class="line"><span class="keyword">var</span> aux=findMinNode(node.right)  <span class="comment">//找到这个节点，在节点右子树中找到最小的子节点</span></div><div class="line">node.key=aux.key    <span class="comment">//找到之后把这个节点的值更新成这个子节点的值</span></div><div class="line">node.right=removeNode(node.right,aux.key)   <span class="comment">//从右子树中把这个最小子节点删除</span></div><div class="line"><span class="keyword">return</span> node     <span class="comment">//删除之后得到平衡的二叉树</span></div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">this</span>.remove=<span class="function"><span class="keyword">function</span>(<span class="params">key</span>)</span>&#123;</div><div class="line">removeNode(root,key)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>应用场景：前序遍历用于复制二叉树，因为即使你想重新根据节点生成，如果节点多的话，算法的空间复杂度是很大的，前序遍历复制的效率要比重新生成的效率高出10倍左右<br>，中序遍历可用于排序，后序遍历可以用在系统文件检索。<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/binarytree/666.jpg" alt="最后放上我偶像" title="">                </div>                <div class="image-caption">最后放上我偶像</div>            </figure></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;二叉树原理手记。&lt;/p&gt;
&lt;p&gt;&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;//music.163.com/outchain/player?type=2&amp;id=865014922&amp;auto=0&amp;height=66&quot;&gt;&lt;/iframe&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="二叉树" scheme="http://yoursite.com/tags/%E4%BA%8C%E5%8F%89%E6%A0%91/"/>
    
      <category term="中序遍历" scheme="http://yoursite.com/tags/%E4%B8%AD%E5%BA%8F%E9%81%8D%E5%8E%86/"/>
    
      <category term="前序遍历" scheme="http://yoursite.com/tags/%E5%89%8D%E5%BA%8F%E9%81%8D%E5%8E%86/"/>
    
      <category term="后序遍历" scheme="http://yoursite.com/tags/%E5%90%8E%E5%BA%8F%E9%81%8D%E5%8E%86/"/>
    
      <category term="二叉树节点查找" scheme="http://yoursite.com/tags/%E4%BA%8C%E5%8F%89%E6%A0%91%E8%8A%82%E7%82%B9%E6%9F%A5%E6%89%BE/"/>
    
      <category term="二叉树节点删除" scheme="http://yoursite.com/tags/%E4%BA%8C%E5%8F%89%E6%A0%91%E8%8A%82%E7%82%B9%E5%88%A0%E9%99%A4/"/>
    
  </entry>
  
  <entry>
    <title>react造了一个PC城市选择的轮子</title>
    <link href="http://yoursite.com/2018/11/16/react%E9%80%A0%E4%BA%86%E4%B8%80%E4%B8%AAPC%E5%9F%8E%E5%B8%82%E9%80%89%E6%8B%A9%E7%9A%84%E8%BD%AE%E5%AD%90/"/>
    <id>http://yoursite.com/2018/11/16/react造了一个PC城市选择的轮子/</id>
    <published>2018-11-16T04:48:42.000Z</published>
    <updated>2018-12-04T18:04:31.917Z</updated>
    
    <content type="html"><![CDATA[<p>最近做一个react项目的时候，突然想做出来留着下次需要就二次开</p><p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=167679&auto=0&height=66"></iframe><br><a id="more"></a></p><p>在做城市选择的时候，找了网上的一些现成资料，但是都是移动端的，PC的太少，antd的我自己觉得不太好用，然后就想着自己写一个备用，下次需要就在它基础上二次开发就可以了<br><a href="https://github.com/HHardyy/react-cityselect" target="_blank" rel="external">它在这里</a><br>，这个不是我项目里面的，毕竟项目里面的代码不能暴露，这是我重新设计的极简版，没有太多余的依赖文件，可以扩展的空间也更多，demo是我用脚手架建的一个简单的使用这个组件的例子，里头我用的是redux和装饰器来做。</p><blockquote><p>用的时候初始化一下ul的默认样式（margin，padding）</p></blockquote><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/reactCselect/aaa.gif" alt="“跑起来”" title="">                </div>                <div class="image-caption">“跑起来”</div>            </figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;最近做一个react项目的时候，突然想做出来留着下次需要就二次开&lt;/p&gt;
&lt;p&gt;&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;//music.163.com/outchain/player?type=2&amp;id=167679&amp;auto=0&amp;height=66&quot;&gt;&lt;/iframe&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="react" scheme="http://yoursite.com/tags/react/"/>
    
      <category term="轮子" scheme="http://yoursite.com/tags/%E8%BD%AE%E5%AD%90/"/>
    
      <category term="城市选择" scheme="http://yoursite.com/tags/%E5%9F%8E%E5%B8%82%E9%80%89%E6%8B%A9/"/>
    
  </entry>
  
  <entry>
    <title>Ant Design of React(Upload)</title>
    <link href="http://yoursite.com/2018/11/06/Ant-Design-of-React-Upload/"/>
    <id>http://yoursite.com/2018/11/06/Ant-Design-of-React-Upload/</id>
    <published>2018-11-05T16:11:51.000Z</published>
    <updated>2020-01-13T15:14:46.514Z</updated>
    
    <content type="html"><![CDATA[<p>日常记录，Upload大家都懂，写接口接Upload大家也都会，但是别拦我，我说说我遇到的antd Design的Upload</p><p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=1320593213&auto=0&height=66"></iframe><br><a id="more"></a></p><p>假如我有个文件要上传到服务器并且返回文件保存的路径，那我可能会像下面这么写</p><blockquote><p>FormData对象用以将数据编译成键值对，以便用XMLHttpRequest来发送数据。其主要用于发送表单数据，但亦可用于发送带键数据(keyed data)<br>而独立于表单使用。如果表单enctype属性设为multipart/form-data ，则会使用表单的submit()方法来发送数据，从而，发送数据具有同样形式。</p></blockquote><p>前端代码,也就是你点击上传或者发送或者什么的之后执行的方法<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">handleUpload = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line"><span class="comment">//为文件创建formData，key是files</span></div><div class="line">    <span class="keyword">const</span> formData = <span class="keyword">new</span> FormData();</div><div class="line">    fileList.forEach(<span class="function">(<span class="params">file</span>) =&gt;</span> &#123;</div><div class="line">      formData.append(<span class="string">'files'</span>, file);</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.setState(&#123;</div><div class="line">      uploading: <span class="literal">true</span>,</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    reqwest(&#123;</div><div class="line">      url: <span class="string">'/upload'</span>,</div><div class="line">      method: <span class="string">'post'</span>,</div><div class="line">      processData: <span class="literal">false</span>,</div><div class="line">      data: formData,</div><div class="line">      success: <span class="function">(<span class="params">resp</span>) =&gt;</span> &#123;</div><div class="line">      <span class="built_in">console</span>.log(resp)</div><div class="line">        <span class="keyword">this</span>.setState(&#123;</div><div class="line">          fileList: [],</div><div class="line">          uploading: <span class="literal">false</span>,</div><div class="line">        &#125;);</div><div class="line">        message.success(<span class="string">'upload successfully.'</span>);</div><div class="line">      &#125;,</div><div class="line">      error: <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        <span class="keyword">this</span>.setState(&#123;</div><div class="line">          uploading: <span class="literal">false</span>,</div><div class="line">        &#125;);</div><div class="line">        message.error(<span class="string">'upload failed.'</span>);</div><div class="line">      &#125;,</div><div class="line">    &#125;);</div><div class="line">  &#125;</div></pre></td></tr></table></figure></p><p>接口,比较简陋，主要是看看直接接收会出来什么东西<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> upload = multer(&#123;<span class="attr">dest</span>:<span class="string">'./目录/我的路径'</span>&#125;); <span class="comment">//设置文件存储位置</span></div><div class="line">app.use(express.static(<span class="string">'./目录'</span>));           <span class="comment">//设置静态文件目录</span></div><div class="line">app.post(<span class="string">"/upload"</span>,upload.single(<span class="string">'files'</span>),(req, res) =&gt; &#123;</div><div class="line">    <span class="built_in">console</span>.log(req.file)</div><div class="line">    <span class="keyword">const</span> initFileName=req.file.originalname  <span class="comment">//原始文件名</span></div><div class="line">    <span class="built_in">console</span>.log(initFileName)</div><div class="line">    res.send(<span class="string">'./uploads/'</span> + initFileName)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p><p>然后我选择一个叫测试.doc的文档上传。接着打开浏览器调试看看给我返回了什么<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/AntDesignofReact/1.JPG" alt="response" title="">                </div>                <div class="image-caption">response</div>            </figure><br>返回的文件地址，文件名是一串uuid的编码，开始我以为是组件默认的加密之后，但是服务器打印出来的文件信息显示encoding是“7bit”，所以并不是它默认加密或者什么<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/AntDesignofReact/2.JPG" alt="服务器打印" title="">                </div>                <div class="image-caption">服务器打印</div>            </figure><br>（虽然是uuid编码，但是两个图文件名为啥不一样。。。这个怪我这个爪，是因为服务器的时候我又拖了个文件上传，其实同一个文件的话，它是一样的）<br>当然你想直接console.log(formData)查看数据是不可以的，formData不允许，只允许类似这样的操作<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> formData = <span class="keyword">new</span> FormData()</div><div class="line">formData.append(<span class="string">'user'</span>, <span class="string">'hhardyy'</span>)</div><div class="line">获取 formData.get(<span class="string">'user'</span>)  </div><div class="line">删除 formData.delete(<span class="string">'user'</span>)</div><div class="line">打印出来看的话就是 <span class="built_in">console</span>.log(formData.get(<span class="string">'user'</span>))</div></pre></td></tr></table></figure></p><p>假如怀疑是不是真的上传有文件的话，可以看看我们发的请求<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/AntDesignofReact/3.JPG" alt="服务器打印" title="">                </div>                <div class="image-caption">服务器打印</div>            </figure><br>实际上不仅是路径上的文件名变成了uuid编码，保存的文件名字也是一样<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/AntDesignofReact/4.JPG" alt="formData的信息" title="">                </div>                <div class="image-caption">formData的信息</div>            </figure><br>这时候如果想让保存的文件名字是上传时候的名字或者自定义名字的话可以这么操作，上面那个后台接收其实用的是Express4.x的中间件multer，它有个东西叫diskstorage，可以用来自定义存储位<br>置和自定义文件名<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> storage = multer.diskStorage(&#123;</div><div class="line">  destination: <span class="function"><span class="keyword">function</span> (<span class="params">req, file, cb</span>) </span>&#123;</div><div class="line">    cb(<span class="literal">null</span>, <span class="string">'文件存储目录'</span>)</div><div class="line">  &#125;,</div><div class="line">  filename: <span class="function"><span class="keyword">function</span> (<span class="params">req, file, cb</span>) </span>&#123;</div><div class="line">    cb(<span class="literal">null</span>, <span class="string">'文件名'</span>)</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"> </div><div class="line"><span class="keyword">var</span> upload = multer(&#123; <span class="attr">storage</span>: storage &#125;)</div></pre></td></tr></table></figure></p><p>安装 multer<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install multer --save</div></pre></td></tr></table></figure></p><p>destination和filename函数的参数req在这里.body都是空对象{}，未装载formdata的文本域数据。file虽然装载了文件对象，但是信息不全。<br>接口可以改成这么写<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> storage = multer.diskStorage(&#123;</div><div class="line">    destination: <span class="function"><span class="keyword">function</span> (<span class="params">req, file, cb</span>) </span>&#123;</div><div class="line">        cb(<span class="literal">null</span>, <span class="string">'./我的路径'</span>);</div><div class="line">    &#125;,<span class="comment">//指定存储路径</span></div><div class="line">    filename: <span class="function"><span class="keyword">function</span> (<span class="params">req, file, cb</span>) </span>&#123;</div><div class="line">    <span class="comment">//originalname=原始文件名，原始文件名是测试.doc，我把它后缀干掉，下面改成文件名+上传时间+文件后缀</span></div><div class="line">        <span class="keyword">let</span> fileName=file.originalname.substring(<span class="number">0</span>,file.originalname.indexOf(<span class="string">'.'</span>,<span class="number">0</span>))    </div><div class="line">        cb(<span class="literal">null</span>, fileName + <span class="string">'-'</span> + <span class="built_in">Date</span>.now() + <span class="string">'.doc'</span>);<span class="comment">//指定文件名和扩展名</span></div><div class="line">    &#125;</div><div class="line">&#125;);<span class="comment">//指定存储方法,upload.single=单个文件，upload.Array=多个文件</span></div><div class="line">app.use(express.static(<span class="string">'./我的路径'</span>));       <span class="comment">//设置静态文件目录</span></div><div class="line"><span class="keyword">let</span> upload = multer(&#123; <span class="attr">storage</span>: storage &#125;);  <span class="comment">//存储方法，5是限制大小，files是前端的files，一定要是一样的</span></div><div class="line">app.use(upload.single(<span class="string">'files'</span>, <span class="number">5</span>));</div><div class="line">app.post(<span class="string">'/upload'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</div><div class="line">    res.send(<span class="string">'./路径'</span> + req.file.filename);  <span class="comment">//文件的下载地址</span></div><div class="line">    <span class="built_in">console</span>.log(req.file)</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p><p>这样就正常了。继续深入了解可以去了解一下multer，这只是个简单的demo<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/AntDesignofReact/5.JPG" alt="保存的文件" title="">                </div>                <div class="image-caption">保存的文件</div>            </figure></p><p>还有一个问题就是返回的文件路径我想让别人点击一下就可以访问，那我这时候会用一个a来包裹，然后返回给前端直接可以点链接访问到文件的连接，但是后台返回的是字符串，你到前端的时候显示也是字符串，就像<br>这样<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;a href=<span class="string">"http://$&#123;this.state.fileAddress&#125;"</span>&gt;请点击查看我的简历&lt;<span class="regexp">/a&gt;</span></div></pre></td></tr></table></figure></p><p>其实在做react项目时，有时候需要将后台传过来的html元素的字符串形式变成真正的dom渲染到页面，如果直接插入的话页面显示的就是这段字符串，它不会自己进行转义，这时候可以在你要渲染的元素那写上<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;span dangerouslySetInnerHTML=&#123;&#123;<span class="attr">__html</span>: xxx&#125;&#125;&gt;&lt;/span&gt;               <span class="comment">// xxx是你的那段字符串，只是html元素会被转义成dom</span></div></pre></td></tr></table></figure></p><p>语法是这样<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> str=<span class="string">"&lt;a href="</span>https:<span class="comment">//hhardyy.com/"&gt;hhardyy&lt;/a&gt;"</span></div><div class="line">&lt;span dangerouslySetInnerHTML=&#123;&#123;<span class="attr">__html</span>: str&#125;&#125;&gt;&lt;span/&gt;</div></pre></td></tr></table></figure></p><p>今晚正好做了简历点对点发送接收功能，顺便写一写demo。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;日常记录，Upload大家都懂，写接口接Upload大家也都会，但是别拦我，我说说我遇到的antd Design的Upload&lt;/p&gt;
&lt;p&gt;&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;//music.163.com/outchain/player?type=2&amp;id=1320593213&amp;auto=0&amp;height=66&quot;&gt;&lt;/iframe&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="react" scheme="http://yoursite.com/tags/react/"/>
    
      <category term="字符串html元素渲染" scheme="http://yoursite.com/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2html%E5%85%83%E7%B4%A0%E6%B8%B2%E6%9F%93/"/>
    
      <category term="multer" scheme="http://yoursite.com/tags/multer/"/>
    
      <category term="Upload" scheme="http://yoursite.com/tags/Upload/"/>
    
  </entry>
  
  <entry>
    <title>浅谈高阶组件</title>
    <link href="http://yoursite.com/2018/10/05/%E6%B5%85%E8%B0%88%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6/"/>
    <id>http://yoursite.com/2018/10/05/浅谈高阶组件/</id>
    <published>2018-10-04T18:19:24.000Z</published>
    <updated>2020-01-13T15:35:28.327Z</updated>
    
    <content type="html"><![CDATA[<p>我们都知道高阶函数，本文讲的高阶组件最大的特点就是代码复用，逻辑抽象…</p><p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=534165062&auto=0&height=66"></iframe><br><a id="more"></a></p><blockquote><p>最近学会了吉他，再加上是深夜了，所以就配个吉他版夜的钢琴曲</p></blockquote><p>切入正题，就简单粗暴的举例说明吧</p><p>简单解释高阶组件，首先示例一个函数<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">hello</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"hhardyy i love you"</span>);</div><div class="line">&#125;</div><div class="line">hello()</div></pre></td></tr></table></figure></p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/heightTopZu/1.JPG" alt="“”" title="">                </div>                <div class="image-caption">“”</div>            </figure>  <p>然后高阶组件这么写<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">hello</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"hhardyy i love you"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">newHello</span>(<span class="params">fnc</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"befor hello"</span>)</div><div class="line">        fnc()</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"after hello"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">hello = newHello(hello)</div><div class="line">hello()</div></pre></td></tr></table></figure></p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/heightTopZu/2.JPG" alt="“”" title="">                </div>                <div class="image-caption">“”</div>            </figure>  <p>这种模式就叫装饰器模式，这两hello()使用的时候虽然是一样的，但是内部已经发生了翻天覆地的变化，这是理解高阶组件的第一步，接下来我写个组件<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hello</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</div><div class="line">    render()&#123;</div><div class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>hhardyy test react &amp; 疯狂test react<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>然后在我的项目中的组件（一个写好的组件就可以）的return中用上，然后打印<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/heightTopZu/3.JPG" alt="“”" title="">                </div>                <div class="image-caption">“”</div>            </figure><br>高阶组件其实就是一个组件传入另一个组件，而大家也意识到，组件其实就是个函数，我用<a href="https://babeljs.io/repl" target="_blank" rel="external">babel</a>来解析一下这个组件<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/heightTopZu/4.png" alt="“babel解析hello组件”" title="">                </div>                <div class="image-caption">“babel解析hello组件”</div>            </figure><br>从这里可以看出来，所有的组件本质上都是一个函数，再举个栗子，我写个专门装饰上面hello组件的函数<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">newHello</span>(<span class="params">Component</span>)</span>&#123;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">newHel</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</div><div class="line">        render()&#123;</div><div class="line">            <span class="keyword">return</span> (</div><div class="line">                &lt;div&gt;</div><div class="line">                    &lt;p&gt;高阶组件元素&lt;<span class="regexp">/p&gt;</span></div><div class="line"><span class="regexp">                    &lt;Component &#123;...this.props&#125;&gt;&lt;/</span>Component&gt;</div><div class="line">                &lt;<span class="regexp">/div&gt;</span></div><div class="line"><span class="regexp">            )</span></div><div class="line"><span class="regexp">        &#125;</span></div><div class="line"><span class="regexp">    &#125;</span></div><div class="line"><span class="regexp">    return newHel</span></div><div class="line"><span class="regexp">&#125;</span></div><div class="line"><span class="regexp">Hello = newHello(Hello)</span></div></pre></td></tr></table></figure></p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/heightTopZu/5.png" alt="“专门装饰上面hello组件的函数”" title="">                </div>                <div class="image-caption">“专门装饰上面hello组件的函数”</div>            </figure>  <p>我们常用的@connect装饰器其实就是这么个原理，这里我假装newHello是从别的地方引进来的，很远很远的地方（怕太远了你们看不到就往上移了几行，假装很远），然后在hello组件上写上@newHello，也就是这个样子<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">@newHello</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hello</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;</div><div class="line">    render()&#123;</div><div class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>hhardyy test react组件 模拟@ &amp; 疯狂test react<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/heightTopZu/6.png" alt="“模拟装饰器写法”" title="">                </div>                <div class="image-caption">“模拟装饰器写法”</div>            </figure>  <figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/heightTopZu/7.png" alt="“效果”" title="">                </div>                <div class="image-caption">“效果”</div>            </figure>  <p>来模拟@connect装饰器，这就是最简单的一个高阶组件，也就是给一个组件，然后返回另外一个组件，另外的组件把原来的组件包裹一层，这样就可以在原来的组件之上添加或者修改一些功能</p><h3 id="高阶组件主要分两种"><a href="#高阶组件主要分两种" class="headerlink" title="高阶组件主要分两种"></a>高阶组件主要分两种</h3><h4 id="属性代理"><a href="#属性代理" class="headerlink" title="属性代理"></a>属性代理</h4><p>上面这个组件叫属性代理，我们可以在<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;Component &#123;...this.props&#125;&gt;<span class="xml"><span class="tag">&lt;/<span class="name">Component</span>&gt;</span></span></div></pre></td></tr></table></figure></p><p>上给name,data等等</p><h4 id="反向继承"><a href="#反向继承" class="headerlink" title="反向继承"></a>反向继承</h4><p>就是不继承React.Component,而是直接继承原来的组件，这样就可以改写原来component的生命周期，比如这样子<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">newHello</span>(<span class="params">Component</span>)</span>&#123;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">newHel</span> <span class="keyword">extends</span> <span class="title">Component</span></span>&#123;  <span class="comment">//这里的Component不是继承自React的Component，而是传进来的Component</span></div><div class="line">        componentDidMount() &#123;</div><div class="line">            <span class="built_in">console</span>.log(<span class="string">"高阶组件新增生命周期完成"</span>)</div><div class="line">        &#125;</div><div class="line">        render()&#123;</div><div class="line">            <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Component</span>&gt;</span><span class="tag">&lt;/<span class="name">Component</span>&gt;</span></span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> newHel</div><div class="line">&#125;</div></pre></td></tr></table></figure></p><p>这样之后和之前的关系就成了继承的关系，而不是代理的关系，这种方式可以修改它的生命周期，可以修改渲染逻辑以及整个渲染的流程，使用高阶组件的作用主要是代码复用以及逻辑抽象等<br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/heightTopZu/8.png" alt="“两者简单的代码比较”" title="">                </div>                <div class="image-caption">“两者简单的代码比较”</div>            </figure><br><figure class="image-bubble">                <div class="img-lightbox">                    <div class="overlay"></div>                    <img src="/images/heightTopZu/9.png" alt="“属性继承和反向代理的区别效果”" title="">                </div>                <div class="image-caption">“属性继承和反向代理的区别效果”</div>            </figure><br>有点困，仗着国庆小长假疯狂试探新知识，平均睡觉时间3点</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;我们都知道高阶函数，本文讲的高阶组件最大的特点就是代码复用，逻辑抽象…&lt;/p&gt;
&lt;p&gt;&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;//music.163.com/outchain/player?type=2&amp;id=534165062&amp;auto=0&amp;height=66&quot;&gt;&lt;/iframe&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="react" scheme="http://yoursite.com/tags/react/"/>
    
      <category term="高阶组件" scheme="http://yoursite.com/tags/%E9%AB%98%E9%98%B6%E7%BB%84%E4%BB%B6/"/>
    
      <category term="反向继承" scheme="http://yoursite.com/tags/%E5%8F%8D%E5%90%91%E7%BB%A7%E6%89%BF/"/>
    
      <category term="属性代理" scheme="http://yoursite.com/tags/%E5%B1%9E%E6%80%A7%E4%BB%A3%E7%90%86/"/>
    
  </entry>
  
</feed>
